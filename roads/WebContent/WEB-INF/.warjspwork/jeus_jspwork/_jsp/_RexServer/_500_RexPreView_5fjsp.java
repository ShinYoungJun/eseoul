package jeus_jspwork._jsp._RexServer;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import javax.servlet.jsp.tagext.*;
import java.io.*;
import java.util.*;


public class _500_RexPreView_5fjsp extends jeus.servlet.jsp.HttpJspBase {

  public final String[] __jeusGetIncludedJspFiles() {
    return null;
  }

  public void _jspService(HttpServletRequest request, HttpServletResponse  response)
      throws ServletException, IOException {

    JspFactory	_jspxFactory = null;
    PageContext	pageContext = null;
    HttpSession	session = null;
    ServletContext	application = null;
    ServletConfig	config = null;
    JspWriter	out = null;
    Object		page = this;
    String		_value = null;

    try {
      _jspxFactory = JspFactory.getDefaultFactory();
      pageContext = _jspxFactory.getPageContext(this, request, response, "", true, 8192, true);
      session = pageContext.getSession();
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      out = pageContext.getOut();

      response.setContentType("text/html;charset=MS949");

      out.write(_jspx_template0);
      out.write(_jspx_template1);
      out.write(_jspx_template2);
      out.write(_jspx_template3);
      out.write(_jspx_template4);
      out.write(_jspx_template5);
      out.write(_jspx_template6);
      out.write(_jspx_template7);
      out.write(_jspx_template8);
      out.write(_jspx_template9);
      out.write(_jspx_template10);
      out.write(_jspx_template11);
      out.write(_jspx_template12);
      out.write(_jspx_template13);
      // jsp code [from=(1753,4);to=(1758,2)]
       
      		String rex_crypto = (request.getParameter("rex_crypto") == null ? "false" : request.getParameter("rex_crypto"));
      		String rex_crypto_plugin = (request.getParameter("rex_crypto_plugin") == null ? "" : request.getParameter("rex_crypto_plugin"));
      
      		if (rex_crypto.equals("true") && !rex_crypto_plugin.equals("")) { 
      	

      out.write(_jspx_template14);
      // jsp code [from=(1759,53);to=(1759,70)]
      out.print(rex_crypto_plugin);

      out.write(_jspx_template15);
      // jsp code [from=(1760,4);to=(1760,8)]
        } 

      out.write(_jspx_template16);

    } catch (Throwable t) {
      if (!(t instanceof SkipPageException)) {
        if (out.getBufferSize() != 0) {
          try {
            out.clear();
          } catch (Exception _exc) { }
        }
        pageContext.handlePageException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(pageContext);
    }
  }
  private final static String _jspx_template0 = "\r\n<html>\r\n<head>\r\n\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=euc-kr\">\r\n\t<title>Rexpert Preview</title>\r\n<script language=\"javascript\" src=\"/jsp/RexServer/rexscript/rexpert.js\"></script>\r\n<script language=\"javascript\" src=\"/jsp/RexServer/rexscript/rexpert_properties.js\"></script>\r\n\t<script language=\"javaScript\">\r\n\r\n\tvar goWin;\r\n\r\n\tvar gsParamArr = \"\";\r\n\r\n\tvar goCrypto;\r\n\t\r\n\tvar oReport;\r\n\t\t\r\n\tfunction OnLoad() {\r\n\t\tif ( opener != undefined ) {\t// window.open 시\r\n\t\t\trex_goUserWindow = opener;\r\n\t\t\trex_goRptMainParam = opener.rex_goRptMainParam;\r\n\t\t\trex_goRptSubParams = opener.rex_goRptSubParams;\r\n\t\t\trex_goRptMultiParam = opener.rex_goRptMultiParam;\r\n\t\t\trex_goUserWindow.rex_gsPrintStatus = rex_gsPrintStatus;\r\n\t\t} else if ( parent.rex_goRptMainParam != undefined) {\t\t// iframe 시\r\n\t\t\trex_goUserWindow = parent;\r\n\t\t\trex_goRptMainParam = parent.rex_goRptMainParam;\r\n\t\t\trex_goRptSubParams = parent.rex_goRptSubParams;\r\n\t\t\trex_goRptMultiParam = parent.rex_goRptMultiParam;\r\n\t\t\trex_goUserWindow.rex_gsPrintStatus = rex_gsPrintStatus;\r\n\t\t} else if (window.dialogArguments != undefined) {  // window.showModalDialog 시\r\n\t\t\trex_goUserWindow = window.dialogArguments;\r\n\t\t\t\r\n\t\t\trex_goRptMainParam = window.dialogArguments.rex_goRptMainParam;\r\n\t\t\trex_goRptSubParams = window.dialogArguments.rex_goRptSubParams;\r\n\t\t\trex_goRptMultiParam = window.dialogArguments.rex_goRptMultiParam;\r\n\t\t\trex_goUserWindow.rex_gsPrintStatus = rex_gsPrintStatus;\r\n\t\t}\r\n\t\r\n\t\tfnPreView();\r\n\r\n\t\tvar iAutoRefresh = 0;\r\n\t\tvar oInterval;\r\n\t\t\r\n\t\tif (rex_goRptMainParam == undefined) return fnException();\r\n\r\n\t\tif (rex_goRptMainParam.get(\"rex_auto_refresh\") != null) {\t\t\t\r\n\t\t\tiAutoRefresh = parseInt(rex_goRptMainParam.get(\"rex_auto_refresh\"));\r\n\r\n\t\t\tif (iAutoRefresh > 0) {\r\n\t\t\t\toInterval = window.setInterval(\"fnPreView()\", iAutoRefresh * 1000);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\t\r\n\tvar giMainDataSetRowCount;\r\n\r\n\tfunction fnPreView() {\r\n//\t\tvar oReport;\r\n\t\tvar oSubReport;\r\n\t\tvar oConnection;\r\n\t\tvar oDataSet;\r\n\t\tvar oSQL;\r\n\t\t\r\n\t\tvar sVersion = \"\";\r\n\t\t\r\n\t\tthis.focus();\r\n\t\t//alert(this.ksdfd());\r\n\r\n\t\t//커넥정보 숨기기\r\n\t\t//RexCtl.EnableDebug = false;\r\n\r\n\t\t//뷰어50%축소\r\n\t\t//RexCtl.zoom(\"50\");\r\n\t\t//툴바숨기기\r\n\t\t//RexCtl.ToolBarVisible = false;\t\t\r\n\r\n\t\t//버전정보보기 숨기기\r\n\t\t//RexCtl.ShowToolBarButton(14, false);\r\n\r\n\t\t//뷰어에서 파란색 테두리 숨김\r\n\t\t//RexCtl.FocusRectVisible = false;\r\n\r\n\t\t//RexCtl.EnableHotKey(\"all=0\");\r\n\t\t//RexCtl.ResourceLang = \"en\";\r\n\r\n\t\ttry {\r\n\t\t\tRexCtl.ResourceLang = rex_gsLanguage;\r\n\t\t} catch(ex) {}\r\n\r\n\t\ttry {\r\n\t\t\tsVersion = RexCtl.GetVersion();\r\n\t\t} catch (ex) {\r\n\t\t\talert(\"ActiveX not Installed!!\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (rex_goRptMainParam == undefined) return fnException();\r\n\r\n\t\tif (rex_goRptMainParam != null) {\r\n\t\t\tif (rex_goRptMainParam.get(\"rex_init\") != null) {\r\n\t\t\t\tvar sSetting = rex_goRptMainParam.get(\"rex_init\");\r\n\t\t\t\trex_gfShowToolBarButton(RexCtl, sSetting);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// 초기화 콜백함수 실행\r\n\t\tif (rex_goRptMainParam.Init != null) {\r\n\t\t\ttry {\r\n\t\t\t\trex_goRptMainParam.Init(RexCtl);\r\n\t\t\t} catch(e) {\r\n\t\t\t\t//\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (rex_goRptMainParam.get(\"rex_init_end\") != null) {\r\n\t\t\trex_goRptMainParam.InitEnd(RexCtl, rex_goRptMainParam.get(\"rex_init_end\"));\r\n\t\t}\r\n\r\n\t\tif (rex_goRptMainParam.get(\"rex_print_printerpaperbin\") != null) {\r\n\t\t\tRexCtl.PrinterPaperBin = parseInt(rex_goRptMainParam.get(\"rex_print_printerpaperbin\"));\r\n        \t}\r\n\r\n\t\tif (rex_goRptMainParam == null || rex_goRptMainParam.get(\"rex_rptname\") == \"\") return fnException();\r\n\r\n\t\t//**************************************************************************\r\n\t\t//  crypto install\r\n\t\t//**************************************************************************\r\n\t\t// crypto check\r\n\t\tgoCrypto = rex_CheckCrypto();\r\n\r\n\t\tif(goCrypto.Crypto == true && goCrypto.Plugin == \"inisafeweb60.krx\") {\r\n\t\t\tRexCtl.InstallPlugIn(goCrypto.Plugin, goCrypto.Param);\r\n\t\t} else {\r\n\t\t\t//\r\n\t\t}\r\n\r\n\t\t//***********************************************************\r\n\t\t// 마크애니 모듈 로딩(2007-11-27)\r\n\t\t//***********************************************************\r\n\t\tif(rex_goRptMainParam.get(\"rex_markany\") != null &&\r\n\t\t   rex_goRptMainParam.get(\"rex_markany\") == \"true\")\r\n\t\t{";
  private final static String _jspx_template1 = "\r\n\t\t\tif(!fnInstallPlugIn())\r\n\t\t\t{\r\n\t\t\t\treturn fnException();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// progress 처리\r\n\t\tif (rex_goRptMainParam.get(\"rex_progress\") != null &&\r\n\t\t\trex_goRptMainParam.get(\"rex_progress\") == \"true\") {\r\n\t\t\tvar sPage = \"Progress.jsp\";\r\n\t\t\tvar sWinSize = \"center=yes,scrollbars=no,status=no,toolbar=no,resizable=0,location=no,menu=no,width=400,height=100,left=200,top=200\";\r\n\r\n\t\t\tif (rex_goRptMainParam.get(\"rex_progress_page\") != null &&\r\n\t\t\t\trex_goRptMainParam.get(\"rex_progress_page\") != \"\") {\r\n\r\n\t\t\t\tsPage = rex_goRptMainParam.get(\"rex_progress_page\");\r\n\t\t\t}\r\n\r\n\t\t\tif (rex_goRptMainParam.get(\"rex_progress_window\") != null &&\r\n\t\t\t\trex_goRptMainParam.get(\"rex_progress_window\") != \"\") {\r\n\r\n\t\t\t\tsWinSize = rex_goRptMainParam.get(\"rex_progress_window\");\r\n\t\t\t}\r\n\r\n\t\t\tgoWin = window.open(sPage, \"progress\", sWinSize);\r\n\t\t}\r\n\r\n\t\t///////////////// multi //////////////////////////////////////////\r\n\r\n\t\tif (rex_goRptMultiParam != null) {\r\n\t\t\t\t\t/*\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\toReport = RexCtl.OpenReport(rex_gsReportURL + \"dummy.rex\");\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t//\r\n\t\t\t\t\t}\r\n\t\t\t\t\t*/\r\n\r\n\t\t\t\t\tvar sRptName = \"\";\r\n\t\t\t\t\tvar oRptDummyParam;\r\n\r\n\t\t\t\t\tif (typeof(rex_goRptMultiParam.get(\"rex_rptname\")) == \"object\") {\r\n\t\t\t\t\t\toRptDummyParam = rex_goRptMultiParam.get(\"rex_rptname\");\r\n\r\n\t\t\t\t\t\tif (oRptDummyParam.get(\"rex_rptname\") == null || oRptDummyParam.get(\"rex_rptname\") == \"\"\r\n\t\t\t\t\t\t\t|| oRptDummyParam.get(\"rex_rptname\") == undefined) {\r\n\r\n\t\t\t\t\t\t\tif (oRptDummyParam.get(\"rex_rptxml\") != null) {\r\n\t\t\t\t\t\t\t\toReport = RexCtl.LoadReport( oRptDummyParam.get(\"rex_rptxml\"), \"xml\", \"\" );\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\toReport = RexCtl.OpenReport(rex_gsReportURL + \"dummy.rex\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tsRptName = oRptDummyParam.get(\"rex_rptname\");\r\n\t\r\n\t\t\t\t\t\t\tif (sRptName.substring( 0, 7 ) == \"http://\") { \r\n\t\t\t\t\t\t\t\toReport = RexCtl.OpenReport(oRptDummyParam.get(\"rex_rptname\"));\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\toReport = RexCtl.OpenReport(rex_gsReportURL + oRptDummyParam.get(\"rex_rptname\") + \".rex\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (rex_goRptMultiParam.get(\"rex_rptname\") == null || rex_goRptMultiParam.get(\"rex_rptname\") == \"\"\r\n\t\t\t\t\t\t\t|| rex_goRptMultiParam.get(\"rex_rptname\") == undefined) {\r\n\r\n\t\t\t\t\t\t\tif (rex_goRptMultiParam.get(\"rex_rptxml\") != null) {\r\n\t\t\t\t\t\t\t\toReport = RexCtl.LoadReport( rex_goRptMultiParam.get(\"rex_rptxml\"), \"xml\", \"\" );\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\toReport = RexCtl.OpenReport(rex_gsReportURL + \"dummy.rex\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tsRptName = rex_goRptMultiParam.get(\"rex_rptname\");\r\n\t\r\n\t\t\t\t\t\t\tif (sRptName.substring( 0, 7 ) == \"http://\") { \r\n\t\t\t\t\t\t\t\toReport = RexCtl.OpenReport(rex_goRptMultiParam.get(\"rex_rptname\"));\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\toReport = RexCtl.OpenReport(rex_gsReportURL + rex_goRptMultiParam.get(\"rex_rptname\") + \".rex\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar oRptMultiParam = rex_goRptMultiParam.keys();\r\n\t\t\t\t\tvar oRptParam;\r\n\r\n\t\t\t\t\tvar i = 0;\r\n\r\n\t\t\t\t\tfor(var key in oRptMultiParam) {\r\n\t\t\t\t\t\ti++;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (i > 1) {\r\n\t\t\t\t\t\t\toRptParam = oRptMultiParam[key];\r\n\t\t\t\t\r\n\t\t\t\t\t\t\tvar sLinkType = \"followmainreport=1;usemainreportdata=0;pagereset=0\";\r\n\t\r\n\t\t\t\t\t\t\tif (oRptParam.get(\"rex_addreportsection\") != null) {\r\n\t\t\t\t\t\t\t\tsLinkType = oRptParam.get(\"rex_addreportsection\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (oRptParam.get(\"rex_rptxml\") != null) {\r\n\t\t\t\t\t\t\t\t//.LoadReport( strRex, \"xml\", \"\" );\r\n\t\t\t\t\t\t\t\toReport.AddReportSection(\"\", key, oRptParam.get(\"rex_rptxml\") , \"xml\", sLinkType );\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\toReport.AddReportSection(\"\", key, rex_gsReportURL + oRptParam.get(\"rex_rptname\") + \".rex\" , \"\", sLinkType );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} // end for\r\n\r\n\t\t\t\t\tif(oReport == null) {\r\n\t\t\t\t\t\tfnAlert(\"can't open report file\");\r\n\t\t\t\t\t    return fnException();\r\n\t\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\t\toReport = RexCtl.rebuild();\r\n\r\n\t\t\t\t\tif (typeof(rex_goRptMultiParam.get(\"rex_rptname\")) == \"object\") {\r\n\t\t\t\t\t\tvar obj = oRptDummyParam.keys();\r\n\t\t\t\t\t\tfor(var key in obj) {\r\n\t\t\t\t\t\t\toReport.SetParameterFieldValue(key, obj[key]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\trex_goMainReport = oReport;\r\n\t\t\t\r\n\t\t\t\t\tfor(var i = 0 ; i < oReport.GetReportCountChild();";
  private final static String _jspx_template2 = " i++)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar oSubReport = oReport.OpenReportChild(i);\r\n\r\n\t\t\t\t\t\toRptParam = rex_goRptMultiParam.get(oSubReport.GetName());\r\n\t\t\t\r\n\t\t\t\t\t\tvar obj = oRptParam.keys();\r\n\t\t\t\t\t\tfor(var key in obj) {\r\n\t\t\t\t\t\t\toSubReport.SetParameterFieldValue(key, obj[key]);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\toConnection = fnCreateConnection(oRptParam.get(\"rex_datatype\"));\r\n\r\n\t\t\t\t\t\tfnGetData(oSubReport, oConnection, oRptParam.get(\"rex_datatype\"),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\toRptParam.get(\"rex_userservice\"),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\toRptParam.get(\"rex_data\"), oRptParam);\r\n\r\n\t\t\t\t\t\tfor (var j = 1; j <= oSubReport.GetReportCount(); j++) {\r\n\r\n\t\t\t\t\t\t\toSubSubReport = oSubReport.OpenReport(j - 1);\r\n\t\t\t\r\n\t\t\t\t\t\t\tif (oSubSubReport == null) {\r\n\t\t\t\t\t\t\t\tfnAlert(\"can't open sub report\");\r\n\t\t\t\t\t\t\t\treturn fnException();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\t\t\t\tvar obj = oRptParam.keys();\r\n\t\t\t\t\t\t\tfor(var key in obj) {\r\n\t\t\t\t\t\t\t\toSubSubReport.SetParameterFieldValue(key, obj[key]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\t\t\t\tfnGetData(oSubSubReport, oConnection,\toRptParam.get(\"rex_datatype\"),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toRptParam.get(\"rex_userservice\"),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toRptParam.get(\"rex_data\"), oRptParam);\r\n\t\t\t\r\n\t\t\t\t\t\t} // end for\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (oRptParam.get(\"rex_datatype\") != \"XMLSTR\" && \r\n\t\t\t\t\t\t    oRptParam.get(\"rex_datatype\") != \"CSVSTR\") {\r\n\t\t\t\t\t\t\t//try {\r\n\t\t\t\t\t\t\t\tif (goCrypto.Crypto == true && goCrypto.Encode == true && goCrypto.Plugin == \"\") {\r\n\t\t\t\t\t\t\t\t\toConnection.SendEncrypt(\"\");\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\toConnection.Send();\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif(rex_goRptMainParam.get(\"rex_send_end\") != null)\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\trex_goRptMainParam.SendEnd(oSubReport.GetName(), oConnection, rex_goRptMainParam.get(\"rex_send_end\"));\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (oRptParam.get(\"rex_datatype\") == \"XML_AJAX\" || oRptParam.get(\"rex_datatype\") == \"CSV_AJAX\" || \r\n\t\t\t\t\t\t\t\t\toRptParam.get(\"rex_datatype\") == \"XMLFILE_AJAX\" || oRptParam.get(\"rex_datatype\") == \"CSVFILE_AJAX\") {\r\n\t\t\t\t\t\t\t\t\tvar oConn = RexCtl.CreateConnection(\"connectionstring\");\r\n\t\t\t\r\n\t\t\t\t\t\t\t\t\toConn.AddValue( \"load\", oConnection.Response() );\r\n\t\r\n\t\t\t\t\t\t\t\t\toConnection = oConn;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t//} catch(e) {\r\n\t\t\t\t\t\t\t//\talert(e.message);\r\n\t\t\t\t\t\t\t\t//alert(oConnection.Response());\r\n\t\t\t\t\t\t\t//\treturn;\r\n\t\t\t\t\t\t\t//}\r\n\t\t\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\t\t\tvar sXpath = \"\";\r\n\t\t\t\t\t\tsXpath = oRptParam.get(\"rex_xpath\");\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (oRptParam.get(\"rex_datatype\") == \"XML\" ||\r\n\t\t\t\t\t\t\toRptParam.get(\"rex_datatype\") == \"XML_AJAX\" ||\r\n\t\t\t\t\t\t\toRptParam.get(\"rex_datatype\") == \"\" ||\r\n\t\t\t\t\t\t\toRptParam.get(\"rex_datatype\") == null) {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (sXpath == null || sXpath == undefined) sXpath = \"\";\r\n\t\t\t\t\t\t\tif (sXpath == \"\")  sXpath = \"root/main/rpt1/rexdataset/rexrow\";\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t} else if (oRptParam.get(\"rex_datatype\") == \"XMLSTR\") {\r\n\t\t\t\t\t\t\tif (sXpath == null || sXpath == undefined) sXpath = \"\";\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\toDataSet = fnCreateDataSet(oSubReport, oConnection, oRptParam.get(\"rex_datatype\"), oDataSet, sXpath, 0);\r\n\t\t\t\r\n\t\t\t\t\t\tgiMainDataSetRowCount = oDataSet.RowCount;\r\n\t\t\t\r\n\t\t\t\t\t\trex_goMainDataSet = oDataSet;\r\n\t\t\t\r\n\t\t\t\t\t\tif (oRptParam.CallBack != null) {\r\n\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\toRptParam.CallBack(oSubReport, oDataSet);\r\n\t\t\t\t\t\t\t} catch(e) {\r\n\t\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var j = 1; j <= oSubReport.GetReportCount(); j++) {\r\n\t\t\t\t\t\t\toSubSubReport = oSubReport.OpenReport(j - 1);\r\n\t\t\t\r\n\t\t\t\t\t\t\tsXpath = \"\";\r\n\t\t\t\t\t\t\tsXpath = oRptParam.get(\"rex_xpath\" + j);\r\n\t\t\t\r\n\t\t\t\t\t\t\tif (sXpath == null || sXpath == undefined) sXpath = \"\";\r\n\t\t\t\r\n\t\t\t\t\t\t\tif (oRptParam.get(\"rex_datatype\") == \"XML\" ||\r\n\t\t\t\t\t\t\t\toRptParam.get(\"rex_datatype\") == \"XMLSTR\" ||\r\n\t\t\t\t\t\t\t\toRptParam.get(\"rex_datatype\") == \"XML_AJAX\" ||\r\n\t\t\t\t\t\t\t\toRptParam.get(\"rex_datatype\") == \"\" ||\r\n\t\t\t\t\t\t\t\toRptParam.get(\"rex_datatype\") == null) {\r\n\t\t\t\t\t\t\t\tif (sXpath == \"\")  sXpath = \"root/main/rpt\" + (j + 1) + \"/rexdataset/rexrow\";\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\toDataSet = fnCreateDataSet(oSubSubReport, oConnection, oRptParam.get(\"rex_datatype\"), oDataSet, sXpath, j);\r\n\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t \r\n\t\t\t\r\n\t\t\t\t\tRexCtl.Run(); \r\n\t\t\t\t\treturn fnException();\t\r\n\t\t\r\n\t\t}\r\n\t\t\r\n\t\t///////////////// end multi ///////////////////////////////////\t\t\r\n\r\n\t\ttry { \r\n\t\t\t\r\n\t\t\tif (rex_goRptMainP";
  private final static String _jspx_template3 = "aram.get(\"rex_rptxml\") != null) {\r\n\t\t\t\toReport = RexCtl.LoadReport(rex_goRptMainParam.get(\"rex_rptxml\"), \"xml\", \"\");\t\t\t\t\r\n\t\t\t} else {\r\n\t\t\t\tvar sRptName = rex_goRptMainParam.get(\"rex_rptname\");\r\n\r\n\t\t\t\tif (sRptName.substring( 0, 7 ) == \"http://\") { \r\n\t\t\t\t\toReport = RexCtl.OpenReport(rex_goRptMainParam.get(\"rex_rptname\")); \r\n\t\t\t\t} else {\r\n\t\t\t\t\t//alert('rex_gsReportURL = '+rex_gsReportURL);\r\n\t\t\t\t\toReport = RexCtl.OpenReport(rex_gsReportURL + rex_goRptMainParam.get(\"rex_rptname\") + \".rex\");\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\t\r\n\t\t\r\n\t\t} catch (e) {\r\n\t\t\tfnAlert(e);\r\n\t\t\treturn fnException();\r\n\t\t}\r\n\r\n\t\tif(oReport == null) {\r\n\t\t    fnAlert(\"can't open report file\");\r\n\t\t    return fnException();\r\n\t\t}\r\n\r\n\r\n\t\t//alert(oReport.GetParameterFieldName(0));\r\n\r\n\t\t//var _oSQL = oReport.GetSQLControl();\r\n\t\t//alert(_oSQL.GetConnectionString());\r\n\r\n\t\t/*\r\n\t\toServerConnection = oReport.GetServerConnection();\r\n\t\t\r\n\t\talert(oServerConnection.GetParameterValue(\"service\"));\r\n\r\n\t\talert(rex_goRptMainParam.get(\"rex_userservice\"));\r\n\t\t*/\r\n\r\n\t\t/*\r\n\t\talert(oReport.GetDataBaseFieldCount());\r\n\t\tfor(i = 0; i < oReport.GetDataBaseFieldCount(); i++) {\r\n\t\t\talert(oReport.GetDataBaseFieldName(i));\r\n\t\t}\r\n\t\t*/\r\n\r\n\t\trex_goMainReport = oReport;\r\n\r\n\t\tvar obj = rex_goRptMainParam.keys();\r\n\t\tfor(var key in obj) {\r\n\t\t\toReport.SetParameterFieldValue(key, obj[key]);\r\n\t\t}\r\n\r\n\t\tif (rex_goRptMainParam.OpenReportEnd != null) {\r\n\t\t\ttry {\r\n\t\t\t\tif (rex_goRptMainParam.get(\"rex_openreport_end\") != null) {\r\n\t\t\t\t\trex_goRptMainParam.OpenReportEnd(rex_goMainReport, rex_goRptMainParam.get(\"rex_openreport_end\"));\r\n\t            }\r\n\t\t\t} catch(e) {\r\n\t\t\t\t//\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\toConnection = fnCreateConnection(rex_goRptMainParam.get(\"rex_datatype\"));\r\n\r\n\t\tfnGetData(oReport, oConnection, rex_goRptMainParam.get(\"rex_datatype\"),\r\n\t\t\t\t\t\t\t\t\t\trex_goRptMainParam.get(\"rex_userservice\"),\r\n\t\t\t\t\t\t\t\t\t\trex_goRptMainParam.get(\"rex_data\"), rex_goRptMainParam);\r\n\r\n\t\tif (fnGetSubReportData() == \"each\") {\r\n\t\t\tvar sXpath = \"\";\r\n\t\t\tsXpath = rex_goRptMainParam.get(\"rex_xpath\");\r\n\r\n\t\t\tif (sXpath == null || sXpath == undefined) sXpath = \"\";\r\n\r\n\t\t\tif (rex_goRptMainParam.get(\"rex_datatype\") == \"XML\" || \r\n\t\t\t\trex_goRptMainParam.get(\"rex_datatype\") == \"XMLSTR\" ||\r\n\t\t\t\trex_goRptMainParam.get(\"rex_datatype\") == \"XML_AJAX\" ||\r\n\t\t\t\trex_goRptMainParam.get(\"rex_datatype\") == \"\" ||\r\n\t\t\t\trex_goRptMainParam.get(\"rex_datatype\") == null) {\r\n\t\t\t\tif (sXpath == \"\")  sXpath = \"root/main/rpt1/rexdataset/rexrow\";\r\n\t\t\t}\r\n\r\n\t\t\toDataSet = fnCreateDataSet(oReport, oConnection, rex_goRptMainParam.get(\"rex_datatype\"), oDataSet, sXpath, 0);\r\n\r\n\t\t\tgiMainDataSetRowCount = oDataSet.RowCount;\r\n\r\n\t\t\trex_goMainDataSet = oDataSet;\r\n\r\n\t\t\tif (rex_goRptMainParam.CallBack != null) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\trex_goRptMainParam.CallBack(oReport, oDataSet);\r\n\t\t\t\t} catch(e) {\r\n\t\t\t\t\t//\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//if (rex_gsRptParamShare == \"share\") {\r\n\t\tif (fnRptParamShare() == \"share\") {\r\n\t\t\tif (fnGetSubReportData() == \"each\") {\r\n\t\t\t\tif (rex_goRptSubParams.length > 0) {\r\n\t\t\t\t\tvar sDataType = \"\";\r\n\t\t\t\t\tvar sUserService = \"\";\r\n\t\t\t\t\tvar sData = \"\";\r\n\r\n\t\t\t\t\tfor (i = 1; i <= rex_goRptSubParams.length; i++) {\r\n\t\t\t\t\t\toRptSubParam = rex_goRptSubParams.get(\"\" + i);\r\n\r\n\t\t\t\t\t\tif (oRptSubParam.get(\"rex_rptname\") != \"\") {\r\n\t\t\t\t\t\t\toSubReport = oReport.OpenReport(oRptSubParam.get(\"rex_rptname\"));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t//oSubReport = oReport.OpenReport(i - 1);\r\n\t\t\t\t\t\t\tfnAlert(\"can't find subreport name\");\r\n\t\t\t\t\t\t\treturn fnException();\r\n\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\tif (oSubReport == null) {\r\n\t\t\t\t\t\t\tfnAlert(\"can't open sub report\");\r\n\t\t\t\t\t\t\treturn fnException();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar obj = rex_goRptMainParam.keys();\r\n\t\t\t\t\t\tfor(var key in obj) {\r\n\t\t\t\t\t\t\toSubReport.SetParameterFieldValue(key, obj[key]);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (oRptSubParam.get(\"rex_datatype\") == null) {\r\n\t\t\t\t\t\t\tsDataType = rex_goRptMainParam.get(\"rex_datatype\");\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tsDataType = oRptSubParam.get(\"rex_datatype\");\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (oRptSubParam.get(\"rex_userservice\") == null) {\r\n\t\t\t\t\t\t\tsUserService = rex_goRptMainParam.get(\"rex_userservice\");\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tsUserService = oRptSubParam.get(\"rex_userservice\");\r\n\t\t\t\t";
  private final static String _jspx_template4 = "\t\t}\r\n\r\n\t\t\t\t\t\tif (oRptSubParam.get(\"rex_data\") == null) {\r\n\t\t\t\t\t\t\tsData = rex_goRptMainParam.get(\"rex_data\");\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tsData = oRptSubParam.get(\"rex_data\");\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\toConnection = fnCreateConnection(sDataType);\r\n\r\n\t\t\t\t\t\tfnGetData(oSubReport, oConnection,\tsDataType, sUserService, sData, rex_goRptMainParam);\r\n\r\n\t\t\t\t\t\tvar sXpath = \"\";\r\n\t\t\t\t\t\tsXpath = oRptSubParam.get(\"rex_xpath\");\r\n\r\n\t\t\t\t\t\tif (sXpath == null || sXpath == undefined) sXpath = \"\";\r\n\r\n\t\t\t\t\t\tif (sDataType == \"XML\" || \r\n\t\t\t\t\t\t\tsDataType == \"XMLSTR\" ||\r\n\t\t\t\t\t\t\tsDataType == \"XML_AJAX\" ||\r\n\t\t\t\t\t\t\tsDataType == \"\" || sDataType == null) {\r\n\t\t\t\t\t\t\tif (sXpath == \"\")  sXpath = \"root/main/rpt1/rexdataset/rexrow\";\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\toDataSet = fnCreateDataSet(oSubReport, oConnection, sDataType, oDataSet, sXpath, 0);\r\n\r\n\t\t\t\t\t\tif (oRptSubParam.CallBack != null) {\r\n\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\toRptSubParam.CallBack(oSubReport, oDataSet);\r\n\t\t\t\t\t\t\t} catch(e) {\r\n\t\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} // end for\r\n\t\t\t\t} // end if\r\n\t\t\t} else {\t\t// once\r\n\t\t\t\tfor (i = 1; i <= oReport.GetReportCount(); i++) {\r\n\t\t\t\t\toSubReport = oReport.OpenReport(i - 1);\r\n\r\n\t\t\t\t\tif (oSubReport == null) {\r\n\t\t\t\t\t\tfnAlert(\"can't open sub report\");\r\n\t\t\t\t\t\treturn fnException();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar obj = rex_goRptMainParam.keys();\r\n\t\t\t\t\tfor(var key in obj) {\r\n\t\t\t\t\t\toSubReport.SetParameterFieldValue(key, obj[key]);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (rex_goRptMainParam.get(\"rex_datatype\") != \"XMLSTR\" && \r\n\t\t\t\t\t\trex_goRptMainParam.get(\"rex_datatype\") != \"CSVSTR\") {\r\n\r\n\t\t\t\t\t\tfnGetData(oSubReport, oConnection,\trex_goRptMainParam.get(\"rex_datatype\"),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trex_goRptMainParam.get(\"rex_userservice\"),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trex_goRptMainParam.get(\"rex_data\"), rex_goRptMainParam);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} // end for\r\n\t\t\t} // end if\r\n\t\t} else { // each\r\n\t\t\tif (rex_goRptSubParams.length > 0) {\r\n\t\t\t\tvar sDataType = \"\";\r\n\t\t\t\tvar sUserService = \"\";\r\n\t\t\t\tvar sData = \"\";\r\n\r\n\t\t\t\tfor (i = 1; i <= rex_goRptSubParams.length; i++) {\r\n\t\t\t\t\toRptSubParam = rex_goRptSubParams.get(\"\" + i);\r\n\r\n\t\t\t\t\tif (oRptSubParam.get(\"rex_rptname\") != \"\") {\r\n\t\t\t\t\t\toSubReport = oReport.OpenReport(oRptSubParam.get(\"rex_rptname\"));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t//oSubReport = oReport.OpenReport(i - 1);\r\n\t\t\t\t\t\tfnAlert(\"can't find subreport name\");\r\n\t\t\t\t\t\treturn fnException();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (oSubReport == null) {\r\n\t\t\t\t\t\tfnAlert(\"can't open sub report\");\r\n\t\t\t\t\t\treturn fnException();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar obj = oRptSubParam.keys();\r\n\t\t\t\t\tfor(var key in obj) {\r\n\t\t\t\t\t\toSubReport.SetParameterFieldValue(key, obj[key]);\r\n\t\t\t\t\t\t//alert(oSubReport.GetParameterFieldName(0));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (oRptSubParam.get(\"rex_datatype\") == null) {\r\n\t\t\t\t\t\tsDataType = rex_goRptMainParam.get(\"rex_datatype\");\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsDataType = oRptSubParam.get(\"rex_datatype\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (oRptSubParam.get(\"rex_userservice\") == null) {\r\n\t\t\t\t\t\tsUserService = rex_goRptMainParam.get(\"rex_userservice\");\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsUserService = oRptSubParam.get(\"rex_userservice\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (oRptSubParam.get(\"rex_data\") == null) {\r\n\t\t\t\t\t\tsData = rex_goRptMainParam.get(\"rex_data\");\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsData = oRptSubParam.get(\"rex_data\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\toConnection = fnCreateConnection(sDataType);\r\n\r\n\t\t\t\t\tfnGetData(oSubReport, oConnection,\tsDataType, sUserService, sData, rex_goRptMainParam);\r\n\t\t\t\t\t//fnGetData(oSubReport, oConnection,\tsDataType, sUserService, sData, oRptSubParam);\r\n\r\n\t\t\t\t\tif (fnGetSubReportData() == \"each\") {\t\t\t\t\t\r\n\t\t\t\t\t\tvar sXpath = \"\";\r\n\t\t\t\t\t\tsXpath = oRptSubParam.get(\"rex_xpath\");\r\n\r\n\t\t\t\t\t\tif (sXpath == null || sXpath == undefined) sXpath = \"\";\r\n\r\n\t\t\t\t\t\tif (sDataType == \"XML\" || \r\n\t\t\t\t\t\t\tsDataType == \"XMLSTR\" ||\r\n\t\t\t\t\t\t\tsDataType == \"XML_AJAX\" ||\r\n\t\t\t\t\t\t\tsDataType == \"\" || sDataType == null) {\r\n\t\t\t\t\t\t\tif (sXpath == \"\")  sXpath = \"root/main/rpt1/rexdataset/rexrow\";\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\toDataSet = fnCreateDataSet(oSubReport, oConnection, sDataType, oDataSet, sXpath, 0);\r\n\r\n\t\t\t\t\t\tif (oRptSubParam.CallBack != null) {\r\n\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\toRptSubParam.CallBack(oSubReport, oDataSet);\r\n\t\t\t\t\t\t\t} catch(e) {\r\n\t\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} // end for\r\n\t\t\t}";
  private final static String _jspx_template5 = " // end if\r\n\t\t}  // end if - share\r\n\r\n\t\tif (fnGetSubReportData() == \"once\") {\r\n\t\t\tvar sDataType = \"\";\r\n\t\t\tsDataType = rex_goRptMainParam.get(\"rex_datatype\");\r\n\r\n\t\t\tif (rex_goRptMainParam.get(\"rex_datatype\") != \"XMLSTR\" && \r\n\t\t\t    rex_goRptMainParam.get(\"rex_datatype\") != \"CSVSTR\") {\r\n\t\t\t\t//try {\r\n\r\n\t\t\t\t\tif (goCrypto.Crypto == true && goCrypto.Encode == true && goCrypto.Plugin == \"\") {\r\n\t\t\t\t\t\toConnection.SendEncrypt(\"\");\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toConnection.Send();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(rex_goRptMainParam.get(\"rex_send_end\") != null)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trex_goRptMainParam.SendEnd(\"\", oConnection, rex_goRptMainParam.get(\"rex_send_end\"));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//alert(\"oConnection.Response():\" + fnBlockDec(oConnection.Response()));\r\n\r\n\t\t\t\t\tif (sDataType == \"XML_AJAX\" || sDataType == \"CSV_AJAX\" || \r\n\t\t\t\t\t\tsDataType == \"XMLFILE_AJAX\" || sDataType == \"CSVFILE_AJAX\") {\r\n\t\t\t\t\t\tvar oConn = RexCtl.CreateConnection(\"connectionstring\");\r\n\r\n\t\t\t\t\t\toConn.AddValue( \"load\", oConnection.Response() );\r\n\r\n\t\t\t\t\t\toConnection = oConn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t//} catch(e) {\r\n\t\t\t\t//\talert(e.message);\r\n\t\t\t\t\t//alert(oConnection.Response());\r\n\t\t\t\t//\treturn;\r\n\t\t\t\t//}\r\n\t\t\t}\r\n\r\n\t\t\tvar sXpath = \"\";\r\n\t\t\tsXpath = rex_goRptMainParam.get(\"rex_xpath\");\r\n\r\n\t\t\tif (sXpath == null || sXpath == undefined) sXpath = \"\";\r\n\r\n\t\t\tif (rex_goRptMainParam.get(\"rex_datatype\") == \"XML\" || \r\n\t\t\t\trex_goRptMainParam.get(\"rex_datatype\") == \"XMLSTR\" ||\r\n\t\t\t\trex_goRptMainParam.get(\"rex_datatype\") == \"XML_AJAX\" ||\r\n\t\t\t\trex_goRptMainParam.get(\"rex_datatype\") == \"\" ||\r\n\t\t\t\trex_goRptMainParam.get(\"rex_datatype\") == null) {\r\n\t\t\t\tif (sXpath == \"\")  sXpath = \"root/main/rpt1/rexdataset/rexrow\";\r\n\t\t\t}\r\n\r\n\t\t\toDataSet = fnCreateDataSet(oReport, oConnection, rex_goRptMainParam.get(\"rex_datatype\"), oDataSet, sXpath, 0);\r\n\r\n\t\t\tgiMainDataSetRowCount = oDataSet.RowCount;\r\n\r\n\t\t\trex_goMainDataSet = oDataSet;\r\n\r\n\t\t\tif (rex_goRptMainParam.CallBack != null) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\trex_goRptMainParam.CallBack(oReport, oDataSet);\r\n\t\t\t\t} catch(e) {\r\n\t\t\t\t\t//\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (i = 1; i <= oReport.GetReportCount(); i++) {\r\n\t\t\t\toSubReport = oReport.OpenReport(i - 1);\r\n\r\n\t\t\t\tsXpath = \"\";\r\n\t\t\t\tsXpath = rex_goRptMainParam.get(\"rex_xpath\" + i);\r\n\r\n\t\t\t\tif (sXpath == null || sXpath == undefined) sXpath = \"\";\r\n\r\n\t\t\t\tif (sDataType == \"XML\" ||\r\n\t\t\t\t\tsDataType == \"XMLSTR\" ||\r\n\t\t\t\t\tsDataType == \"XML_AJAX\" ||\r\n\t\t\t\t\tsDataType == \"\" || sDataType == null) {\r\n\t\t\t\t\tif (sXpath == \"\")  sXpath = \"root/main/rpt\" + (i + 1) + \"/rexdataset/rexrow\";\t\t\t\t\t\r\n\t\t\t\t}\r\n\r\n\t\t\t\toDataSet = fnCreateDataSet(oSubReport, oConnection, rex_goRptMainParam.get(\"rex_datatype\"), oDataSet, sXpath, i);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//***********************************************************\r\n\t\t// 보고서 생성 및 마크애니데이터 생성(2007-11-27)\r\n\t\t//***********************************************************\r\n\t\tif(rex_goRptMainParam.get(\"rex_markany\") != null &&\r\n\t\t   rex_goRptMainParam.get(\"rex_markany\") == \"true\")\r\n\t\t{\r\n\t\t\t\tRexCtl.RunAsBlocking();\r\n\t\t\t\t\r\n\t\t\t\t// 마크애니 데이터 생성\r\n\t\t\t\tfnGenerate2D();\t\t\t\t\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t\tif (rex_goRptMainParam.get(\"rex_save\") != null) {\r\n\t\t\t\t\tif (rex_goRptMainParam.get(\"rex_save\") == \"true\") {\r\n\t\t\t\t\t\tRexCtl.RunAsBlocking();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn fnException();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\r\n\t\t\t\tRexCtl.Run();\r\n\t\t}\t// end if\r\n\r\n\r\n \t\treturn fnException();\r\n \r\n\t} // end fnPreView\r\n\r\n\t// CreateConnection\r\n\tfunction fnCreateConnection(sDataType)\r\n\t{\r\n\t\tvar oConnection;\r\n\r\n\t\tif (sDataType == \"XMLFILE\")\r\n\t\t{\r\n\t\t\toConnection = RexCtl.CreateConnection(\"http.get\");\r\n\t\t}\r\n\t\telse if (sDataType == \"CSVFILE\")\r\n\t\t{\r\n\t\t\toConnection = RexCtl.CreateConnection(\"http.csv\");\r\n\t\t\t//oConnection = RexCtl.CreateConnection(\"http.get\");\r\n\t\t}\r\n\t\telse if (sDataType == \"XML\" || sDataType == \"\"  || sDataType == null )\r\n\t\t{\r\n\t\t\toConnection = RexCtl.CreateConnection(\"http.post\");\r\n\t\t}\r\n\t\telse if (sDataType == \"CSV\" )\r\n\t\t{\r\n\t\t\toConnection = RexCtl.CreateConnection(\"http.csv\");\r\n\t\t}\r\n\t\telse if (sDataType==\"XMLSTR\" || sDataType==\"CSVSTR\" )\r\n\t\t{\r\n\t\t\toConnection = RexCtl.CreateConnection(\"connectionstring\");\r\n\t\t} else if (sDataType==\"XML_AJAX\" || sDataType==\"CSV_AJAX\" )\r\n\t\t{\r\n\t\t\toConnection = rex_GetgoAjax();\r\n\t\t\toConne";
  private final static String _jspx_template6 = "ction.Method = \"POST\";\r\n\t\t\toConnection.isASync = false;\r\n\r\n\t\t\tvar sPath = rex_gsRptServiceURL;\r\n\r\n\t\t\t/*\r\n\t\t\tif (sData != undefined) {\r\n\t\t\t\tif (sData != \"\") {\r\n\t\t\t\t\tsPath = sData;\r\n\t\t\t\t} // end if\r\n\t\t\t} // end if\r\n\t\t\t*/\r\n\t\t\t\r\n\t\t\toConnection.Path = sPath;\r\n\r\n\t\t\toConnection.DataType = sDataType.substring( 0, 3 );\r\n\t\t\toConnection.Open();\r\n\r\n\t\t\tif (rex_goRptMainParam.get(\"rex_ajax_requestheader_contenttype\") != null) {\r\n\t\t\t\toConnection.SetRequestHeader(\"Content-Type\", rex_goRptMainParam.get(\"rex_ajax_requestheader_contenttype\"));\r\n\t\t\t} else {\r\n\t\t\t\toConnection.SetRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded;charset=EUC-KR\");\r\n\t\t\t\t//oConnection.SetRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded;charset=UTF-8\");\r\n\t\t\t}\r\n\t\t\t\r\n\t\t} else if (sDataType==\"XMLFILE_AJAX\" || sDataType==\"CSVFILE_AJAX\" )\r\n\t\t{\r\n\t\t\toConnection = rex_GetgoAjax();\r\n\t\t\toConnection.Method = \"GET\";\r\n\t\t\toConnection.isASync = false;\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\treturn oConnection;\r\n\t} // end fnCreateConnection\r\n\r\n\t// GetData\r\n\tfunction fnGetData(oReport, oConnection, sDataType, sUserService, sData, oRptParam)\r\n\t{\r\n\t\tvar oSQL;\r\n\t\tvar sSplitFields;\r\n\t\tvar sImageFields;\r\n\r\n\t\tif (sDataType == \"XML\" || sDataType == \"\" || sDataType == \"CSV\" || sDataType == null)\r\n\t\t{\r\n\t\t\t//oConnection.AddParameter(\"datatype\" + gsParamArr, sDataType);\r\n\r\n\t\t\tif (goCrypto.Crypto == true && goCrypto.Encode == true\r\n\t\t\t\t&& goCrypto.Plugin != \"inisafeweb60.krx\" && goCrypto.Plugin != \"\") {\r\n\t\t\t\toConnection.AddParameter(\"datatype\" + gsParamArr, gfEncrypt(sDataType));\r\n\t\t\t\t\r\n\t\t\t} else {\r\n\t\t\t\toConnection.AddParameter(\"datatype\" + gsParamArr, sDataType);\r\n\t\t\t}\r\n\r\n\t\t\toSQL = oReport.GetSQLControl();\r\n\t\t\t//oConnection.AddParameter(\"sql\" + gsParamArr, oSQL.GetSQL());\r\n\r\n\t\t\tif (goCrypto.Crypto == true && goCrypto.Encode == true\r\n\t\t\t\t&& goCrypto.Plugin != \"inisafeweb60.krx\" && goCrypto.Plugin != \"\") {\r\n\t\t\t\toConnection.AddParameter(\"sql\" + gsParamArr, gfEncrypt(oSQL.GetSQL()));\r\n\t\t\t} else {\r\n\t\t\t\toConnection.AddParameter(\"sql\" + gsParamArr, oSQL.GetSQL());\r\n\t\t\t}\r\n\r\n\t\t\tif (oRptParam.get(\"rex_split_fields\") != null) {\r\n\t\t\t\tsSplitFields = fnGetSplitFields(oReport.GetName(), oRptParam.get(\"rex_split_fields\"));\r\n\t\t\t\t//oConnection.AddParameter(\"split\" + gsParamArr, sSplitFields);\r\n\r\n\t\t\t\tif (goCrypto.Crypto == true && goCrypto.Encode == true\r\n\t\t\t\t\t&& goCrypto.Plugin != \"inisafeweb60.krx\" && goCrypto.Plugin != \"\") {\r\n\t\t\t\t\toConnection.AddParameter(\"split\" + gsParamArr, gfEncrypt(sSplitFields));\r\n\t\t\t\t} else {\r\n\t\t\t\t\toConnection.AddParameter(\"split\" + gsParamArr, sSplitFields);\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\t\t\t\toConnection.AddParameter(\"split\" + gsParamArr, \"\");\r\n\t\t\t}\r\n\r\n\t\t\t// 2008-10-09\r\n\t\t\tif (oRptParam.get(\"rex_image_fields\") != null) {\r\n\t\t\t\tsImageFields = fnGetImageFields(oReport.GetName(), oRptParam.get(\"rex_image_fields\"));\r\n\t\t\t\t//oConnection.AddParameter(\"image\" + gsParamArr, sSplitFields);\r\n\r\n\t\t\t\tif (goCrypto.Crypto == true && goCrypto.Encode == true\r\n\t\t\t\t\t&& goCrypto.Plugin != \"inisafeweb60.krx\" && goCrypto.Plugin != \"\") {\r\n\t\t\t\t\toConnection.AddParameter(\"image\" + gsParamArr, gfEncrypt(sImageFields));\r\n\t\t\t\t} else {\r\n\t\t\t\t\toConnection.AddParameter(\"image\" + gsParamArr, sImageFields);\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\t\t\t\toConnection.AddParameter(\"image\" + gsParamArr, \"\");\r\n\t\t\t}\r\n\r\n\t\t\t/*\r\n\t\t\tif (rex_goRptMainParam.get(\"rex_split_fields\") != null) {\r\n\t\t\t\tsSplitFields = fnGetSplitFields(oReport.GetName(), rex_goRptMainParam.get(\"rex_split_fields\"));\r\n\t\t\t\toConnection.AddParameter(\"split\", sSplitFields);\r\n\t\t\t} else {\r\n\t\t\t\toConnection.AddParameter(\"split\", \"\");\r\n\t\t\t}\r\n\t\t\t*/\r\n\r\n\t\t\tif (sUserService == null) {\r\n\t\t\t\t//oConnection.AddParameter(\"userservice\" + gsParamArr, rex_gsUserService);\r\n\r\n\t\t\t\tif (goCrypto.Crypto == true && goCrypto.Encode == true\r\n\t\t\t\t\t&& goCrypto.Plugin != \"inisafeweb60.krx\" && goCrypto.Plugin != \"\") {\r\n\t\t\t\t\toConnection.AddParameter(\"userservice\" + gsParamArr, gfEncrypt(rex_gsUserService));\r\n\t\t\t\t} else {\r\n\t\t\t\t\toConnection.AddParameter(\"userservice\" + gsParamArr, rex_gsUserService);\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\t\t\t\t//oConnection.AddParameter(\"userservice\" + gsParamArr, sUserService);\r\n\r\n\t\t\t\tif (goCrypto";
  private final static String _jspx_template7 = ".Crypto == true && goCrypto.Encode == true\r\n\t\t\t\t\t&& goCrypto.Plugin != \"inisafeweb60.krx\" && goCrypto.Plugin != \"\") {\r\n\t\t\t\t\toConnection.AddParameter(\"userservice\" + gsParamArr, gfEncrypt(sUserService));\r\n\t\t\t\t} else {\r\n\t\t\t\t\toConnection.AddParameter(\"userservice\" + gsParamArr, sUserService);\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t/*\r\n\t\t\tif (rex_goRptMainParam.get(\"rex_userservice\") == null) {\r\n\t\t\t\toConnection.AddParameter(\"userservice\", rex_gsUserService);\r\n\t\t\t} else {\r\n\t\t\t\toConnection.AddParameter(\"userservice\", rex_goRptMainParam.get(\"rex_userservice\"));\r\n\t\t\t}\r\n\t\t\t*/\r\n\r\n\t\t\tif(oRptParam.get(\"rex_server_param\") != null) {\r\n\t\t\t\tvar oServerParam = oRptParam.get(\"rex_server_param\");\r\n\r\n\t\t\t\t//oConnection.AddParameter(\"rex_server_param\" + gsParamArr, \"true\");\r\n\r\n\t\t\t\tif (goCrypto.Crypto == true && goCrypto.Encode == true\r\n\t\t\t\t\t&& goCrypto.Plugin != \"inisafeweb60.krx\" && goCrypto.Plugin != \"\") {\r\n\t\t\t\t\toConnection.AddParameter(\"rex_server_param\" + gsParamArr, gfEncrypt(\"true\"));\r\n\t\t\t\t} else {\r\n\t\t\t\t\toConnection.AddParameter(\"rex_server_param\" + gsParamArr, \"true\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar oTmp = oServerParam.keys();\r\n\t\t\t\tfor(var key in oTmp) {\r\n\t\t\t\t\t//oConnection.AddParameter(key, oTmp[key]);\r\n\r\n\t\t\t\t\tif (goCrypto.Crypto == true && goCrypto.Encode == true\r\n\t\t\t\t\t\t&& goCrypto.Plugin != \"inisafeweb60.krx\" && goCrypto.Plugin != \"\") {\r\n\t\t\t\t\t\toConnection.AddParameter(key, gfEncrypt(oTmp[key]));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toConnection.AddParameter(key, oTmp[key]);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} // end for\t\t\r\n\t\t\t} // end if\r\n\r\n\t\t\t//oConnection.AddParameter(\"rex_param_sql\" + gsParamArr, fnGetParamSql(oReport.GetName(), oRptParam));\r\n\r\n\t\t\tif (goCrypto.Crypto == true && goCrypto.Encode == true\r\n\t\t\t\t&& goCrypto.Plugin != \"inisafeweb60.krx\" && goCrypto.Plugin != \"\") {\r\n\t\t\t\toConnection.AddParameter(\"rex_param_sql\" + gsParamArr, gfEncrypt(fnGetParamSql(oReport.GetName(), oRptParam)));\r\n\t\t\t} else {\r\n\t\t\t\toConnection.AddParameter(\"rex_param_sql\" + gsParamArr, fnGetParamSql(oReport.GetName(), oRptParam));\r\n\t\t\t}\r\n\r\n\t\t\tif (goCrypto.Crypto == true && goCrypto.Encode == true && goCrypto.Plugin != \"inisafeweb60.krx\") {\r\n\t\t\t\tif (goCrypto.Plugin == \"\") {\r\n\t\t\t\t\toConnection.AddParameter(\"pSessionKey\" + gsParamArr, \"internal\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\toConnection.AddParameter(\"pSessionKey\" + gsParamArr, gfGetSID());\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar sPath = rex_gsRptServiceURL;\r\n\r\n\t\t\tif (sData != undefined) {\r\n\t\t\t\tif (sData != \"\") {\r\n\t\t\t\t\tsPath = sData;\r\n\t\t\t\t} // end if\r\n\t\t\t} // end if\r\n\r\n\t\t\toConnection.Path = sPath;\r\n\r\n\t\t\t//oConnection.Path = \"http://\" + location.host + \"/web/rexpert/RexServer.jsp\";\r\n\t\t\tif (fnGetSubReportData() == \"each\") {\r\n\t\t\t\tif (goCrypto.Crypto == true && goCrypto.Encode == true && goCrypto.Plugin == \"\") {\t\t\t\t\t\r\n\t\t\t\t\toConnection.SendEncrypt(\"\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\toConnection.Send();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(oRptParam.get(\"rex_send_end\") != null)\r\n\t\t\t\t{\r\n\t\t\t\t\toRptParam.SendEnd(oReport.GetName(), oConnection, oRptParam.get(\"rex_send_end\"));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (sDataType==\"XMLFILE\")\r\n\t\t{\r\n\t\t\toConnection.Path = sData;\r\n\t\t\t//oConnection.Path = \"http://\" + location.host + sData;\r\n\t\t\r\n\t\t\t//oConnection.Path = \"http://\" + location.host + \"/web/xml/resolution/\" + sDataName + \".xml\";\r\n\r\n\t\t\tif (fnGetSubReportData() == \"each\") {\r\n\t\t\t\tif (goCrypto.Crypto == true && goCrypto.Encode == true && goCrypto.Plugin == \"\") {\r\n\t\t\t\t\toConnection.SendEncrypt(\"\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\toConnection.Send();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(oRptParam.get(\"rex_send_end\") != null)\r\n\t\t\t\t{\r\n\t\t\t\t\toRptParam.SendEnd(oReport.GetName(), oConnection, oRptParam.get(\"rex_send_end\"));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (sDataType==\"CSVFILE\")\r\n\t\t{\r\n\t\t\toConnection.Path = sData;\r\n\t\t\t//oConnection.Path = \"http://\" + location.host + sData;\r\n\t\t\t//oConnection.Path = \"http://\" + location.host + \"/web/\" + sDataName + \".txt\";\r\n\r\n\t\t\tif (fnGetSubReportData() == \"each\") {\r\n\t\t\t\tif (goCrypto.Crypto == true && goCrypto.Encode == true && goCrypto.Plugin == \"\") {\r\n\t\t\t\t\toConnection.SendEncrypt(\"\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\toConnection.Send();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(oRptParam.get(\"rex_send_end\") != null)\r\n\t\t\t\t{\r\n\t\t\t\t\toRptParam.SendEnd(oReport.GetName(), oConnection, oRptParam.get(\"rex_send_";
  private final static String _jspx_template8 = "end\"));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (sDataType==\"XMLSTR\" || sDataType==\"CSVSTR\")\r\n\t\t{\r\n\t\t\toConnection.AddValue(\"load\", sData);\r\n\t\t}\r\n\t\telse if (sDataType==\"XML_AJAX\" || sDataType==\"CSV_AJAX\")\r\n\t\t{\r\n\t\t\toConnection.AddParameter(\"datatype\" + gsParamArr, sDataType.substring( 0, 3 ));\r\n\r\n\t\t\toSQL = oReport.GetSQLControl();\r\n\r\n\t\t\toConnection.AddParameter(\"sql\", oSQL.GetSQL());\r\n\r\n\t\t\tif (oRptParam.get(\"rex_split_fields\") != null) {\r\n\t\t\t\tsSplitFields = fnGetSplitFields(oReport.GetName(), oRptParam.get(\"rex_split_fields\"));\r\n\t\t\t\toConnection.AddParameter(\"split\" + gsParamArr, sSplitFields);\r\n\t\t\t} else {\r\n\t\t\t\toConnection.AddParameter(\"split\" + gsParamArr, \"\");\r\n\t\t\t}\r\n\r\n\t\t\t// 2008-10-09\r\n\t\t\tif (oRptParam.get(\"rex_image_fields\") != null) {\r\n\t\t\t\tsImageFields = fnGetImageFields(oReport.GetName(), oRptParam.get(\"rex_image_fields\"));\r\n\t\t\t\toConnection.AddParameter(\"image\" + gsParamArr, sImageFields);\r\n\t\t\t} else {\r\n\t\t\t\toConnection.AddParameter(\"image\" + gsParamArr, \"\");\r\n\t\t\t}\r\n\r\n\t\t\tif (sUserService == null) {\r\n\t\t\t\toConnection.AddParameter(\"userservice\" + gsParamArr, rex_gsUserService);\r\n\t\t\t} else {\r\n\t\t\t\toConnection.AddParameter(\"userservice\" + gsParamArr, sUserService);\r\n\t\t\t}\r\n\r\n\t\t\t// ------------------------------------------\r\n\t\t\t//rex_gfAjaxExcute(sDataType, sMethod, sUrl, bASync, sRequestHeader)\r\n\r\n\t\t\t/*\r\n\t\t\tif (fnGetSubReportData() == \"each\") {\r\n\t\t\t\trex_gfAjaxExcute(sDType, \"POST\", sUrl, true, \"\") ;\r\n\t\t\t\toConnection.AddValue( \"load\", rex_gsAjax_ReturnData);\r\n\t\t\t}\r\n\t\t\t*/\r\n\r\n\t\t\tif (fnGetSubReportData() == \"each\") {\r\n\t\t\t\tif (goCrypto.Crypto == true && goCrypto.Encode == true && goCrypto.Plugin == \"\") {\r\n\t\t\t\t\toConnection.SendEncrypt(\"\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\toConnection.Send();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 테스트 필요\r\n\t\t\t\tvar oConn = RexCtl.CreateConnection(\"connectionstring\");\r\n\r\n\t\t\t\toConn.AddValue( \"load\", oConnection.Response() );\r\n\r\n\t\t\t\toConnection = oConn;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (sDataType==\"XMLFILE_AJAX\" || sDataType==\"CSVFILE_AJAX\")\r\n\t\t{\r\n\t\t\toConnection.Path = sData;\r\n\t\t\toConnection.DataType = sDataType.substring( 0, 3 );\r\n\t\t\toConnection.Open();\r\n\r\n\t\t\tif (oRptParam.get(\"rex_ajax_requestheader_contenttype\") != null) {\r\n\t\t\t\toConnection.SetRequestHeader(\"Content-Type\", oRptParam.get(\"rex_ajax_requestheader_contenttype\"));\r\n\t\t\t} else {\r\n\t\t\t\toConnection.SetRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded;charset=EUC-KR\");\r\n\t\t\t\t//oConnection.SetRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded;charset=UTF-8\");\r\n\t\t\t}\r\n\r\n\t\t\tif (fnGetSubReportData() == \"each\") {\r\n\t\t\t\tif (goCrypto.Crypto == true && goCrypto.Encode == true && goCrypto.Plugin == \"\") {\r\n\t\t\t\t\toConnection.SendEncrypt(\"\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\toConnection.Send();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 오류가능성..테스트 필요\r\n\t\t\t\tvar oConn = RexCtl.CreateConnection(\"connectionstring\");\r\n\r\n\t\t\t\toConn.AddValue( \"load\", oConnection.Response() );\r\n\r\n\t\t\t\toConnection = oConn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//return oConnection;\r\n\t} // end fnGetData\r\n\r\n\tfunction fnCreateDataSet(oReport, oConnection, sDataType, oDataSet, sXpath, idx)\r\n\t{\r\n\t\tif ((sDataType == \"XML\" || sDataType == \"\" || sDataType == null))\r\n\t\t{\r\n\t\t\tif (goCrypto.Crypto == true && goCrypto.Decode == true \r\n\t\t\t\t&& goCrypto.Plugin != \"inisafeweb60.krx\" && goCrypto.Plugin != \"\" && goCrypto.FlushCount > 0) {\r\n\t\t\t\tvar sStr = oConnection.Response();\r\n\t\t\t\tvar aStr = sStr.split(goCrypto.Separator);\r\n\t\t\t\tvar sValue = \"\";\r\n\t\t\t\t\r\n\t\t\t\tvar oConn = RexCtl.CreateConnection(\"connectionstring\");\r\n\t\t\t\t\r\n\t\t\t\tfor (var i = 0; i < aStr.length; i++) {\r\n\t\t\t\t\tsValue += gfDecrypt(aStr[i]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\toConn.AddValue( \"load\", sValue);\r\n\r\n\t\t\t\toDataSet = oReport.CreateDataSetXML(oConn, sXpath, 0);\r\n\t\t\t} else {\r\n\t\t\t\toDataSet = oReport.CreateDataSetXML(oConnection, sXpath, 0);\r\n\t\t\t\t//oDataSet = oReport.CreateDataSetXML(oConnection, \"root/main/rpt1/rexdataset/rexrow\", 0);\r\n\t\r\n\t\t\t\tif (goCrypto.Crypto == true && goCrypto.Decode == true \r\n\t\t\t\t\t&& goCrypto.Plugin != \"inisafeweb60.krx\" && goCrypto.Plugin != \"\") {\r\n\t\t\t\t\tfor(var i = 0 ; i < oDataSet.RowCount; i++) {\r\n\t\t\t\t\t\tfor(var j = 0 ; j < oDataSet.ColCount; j++) {\r\n\t\t\t\t\t\t\toDataSet.SetValue(i,j, gfDecrypt(oDataSet.GetValue(i,j)));\r\n\t\t\t\t\t\t}\r\n\t\t\t";
  private final static String _jspx_template9 = "\t\t}\r\n\t\t\t\t}\r\n\t\t\t} // end if\r\n\t\t}\r\n\t\telse if (sDataType == \"XMLFILE\" || sDataType == \"XMLSTR\" || \r\n\t\t\t\tsDataType == \"XML_AJAX\" || sDataType == \"XMLFILE_AJAX\")\r\n\t\t{\r\n\r\n\t\t\tif (goCrypto.Crypto == true && goCrypto.Decode == true \r\n\t\t\t\t&& goCrypto.Plugin != \"inisafeweb60.krx\" && goCrypto.Plugin != \"\" && goCrypto.FlushCount > 0) {\r\n\t\t\t\tvar sStr = oConnection.Response();\r\n\t\t\t\tvar aStr = sStr.split(goCrypto.Separator);\r\n\t\t\t\tvar sValue = \"\";\r\n\t\t\t\t\r\n\t\t\t\tvar oConn = RexCtl.CreateConnection(\"connectionstring\");\r\n\t\t\t\t\r\n\t\t\t\tfor (var i = 0; i < aStr.length; i++) {\r\n\t\t\t\t\tsValue += gfDecrypt(aStr[i]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\toConn.AddValue( \"load\", sValue);\r\n\r\n\t\t\t\toDataSet = oReport.CreateDataSetXML(oConn, sXpath, 0);\r\n\t\t\t} else {\r\n\t\t\t\toDataSet = oReport.CreateDataSetXML(oConnection, sXpath, 0);\r\n\t\r\n\t\t\t\tif (goCrypto.Crypto == true && goCrypto.Decode == true \r\n\t\t\t\t\t&& goCrypto.Plugin != \"inisafeweb60.krx\" && goCrypto.Plugin != \"\") {\r\n\t\t\t\t\tfor(var i = 0 ; i < oDataSet.RowCount; i++) {\r\n\t\t\t\t\t\tfor(var j = 0 ; j < oDataSet.ColCount; j++) {\r\n\t\t\t\t\t\t\toDataSet.SetValue(i,j, gfDecrypt(oDataSet.GetValue(i,j)));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} // end if\r\n\r\n\t\t\t//oDataSet = oReport.CreateDataSetXML(oConnection, \"\", 0);\r\n\r\n\t\t\t//oDataSet = oReport.CreateDataSetXML(oConnection, \"rexdataset/rexrow\", 0);\r\n\t\t}\r\n\t\telse if (sDataType == \"CSV\" || sDataType == \"CSVFILE\" || sDataType == \"CSVSTR\" || \r\n\t\t\t\tsDataType == \"CSV_AJAX\" || sDataType == \"CSVFILE_AJAX\")\r\n\t\t{\r\n\t\t\tif (goCrypto.Crypto == true && goCrypto.Decode == true \r\n\t\t\t\t&& goCrypto.Plugin != \"inisafeweb60.krx\" && goCrypto.Plugin != \"\" && goCrypto.FlushCount > 0) {\r\n\t\t\t\tvar sStr = oConnection.Response();\r\n\t\t\t\tvar aStr = sStr.split(goCrypto.Separator);\r\n\t\t\t\tvar sValue = \"\";\r\n\t\t\t\t\r\n\t\t\t\tvar oConn = RexCtl.CreateConnection(\"connectionstring\");\r\n\t\t\t\t\r\n\t\t\t\tfor (var i = 0; i < aStr.length; i++) {\r\n\t\t\t\t\tsValue += gfDecrypt(aStr[i]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\toConn.AddValue( \"load\", sValue);\r\n\r\n\t\t\t\toDataSet = oReport.CreateDataSetCSV(oConn, idx,\r\n\t\t\t\t\t\t\t\t\t\t\t\trex_gsCsvSeparatorDataset,\r\n\t\t\t\t\t\t\t\t\t\t\t\trex_gsCsvSeparatorRow,\r\n\t\t\t\t\t\t\t\t\t\t\t\trex_gsCsvSeparatorColumn, rex_csv_encoding);\r\n\t\t\t\t\r\n\t\t\t} else {\r\n\t\t\t\r\n\t\t\t\toDataSet = oReport.CreateDataSetCSV(oConnection, idx,\r\n\t\t\t\t\t\t\t\t\t\t\t\trex_gsCsvSeparatorDataset,\r\n\t\t\t\t\t\t\t\t\t\t\t\trex_gsCsvSeparatorRow,\r\n\t\t\t\t\t\t\t\t\t\t\t\trex_gsCsvSeparatorColumn, rex_csv_encoding);\r\n\t//var myDate = new Date( );\r\n\t//alert(oDataSet.RowCount + \":\" + myDate);\r\n\t\r\n\t\t\t\tif (goCrypto.Crypto == true && goCrypto.Decode == true \r\n\t\t\t\t\t&& goCrypto.Plugin != \"inisafeweb60.krx\" && goCrypto.Plugin != \"\") {\r\n\t\t\t\t\tfor(var i = 0 ; i < oDataSet.RowCount; i++) {\r\n\t\t\t\t\t\tfor(var j = 0 ; j < oDataSet.ColCount; j++) {\r\n\t//\t\t\t\t\t\tidCnt.value = i + \":\" +  j;\r\n\t\t\t\t\t\t\toDataSet.SetValue(i,j, gfDecrypt(oDataSet.GetValue(i,j)));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t//var myDate2 = new Date( );\r\n\t//alert(oDataSet.RowCount + \"건  : \" + (myDate2 - myDate) / 1000 + \"초\");\r\n\t\r\n\t\t\t\t//oDataSet = oReport.CreateDataSetCSV(oConnection, 0, \"@\", \"\", \"^\", \"\");\r\n\t\t\t} // end if\r\n\t\t}\r\n\r\n\t\treturn oDataSet;\r\n\t}\r\n\r\n\t//*****************************************************************\r\n\t//\r\n\t// * 마크애니 모듈 로딩 함수\r\n\t//\r\n\t//*****************************************************************\r\n\tfunction fnInstallPlugIn()\r\n\t{\r\n\t   try\r\n\t   {\r\n\t\t  \r\n\t\t\t//**************************************************************************\r\n\t\t\t// 사용가능 옵션\r\n\t\t\t// * dllname           : 마크애니 dll 명(MAePageSAFERRexpert.dll)\r\n\t\t\t// * datafilename      : 데이터 파일명(MaPrintInfoNhicRex.dat), MaPrintInfoMofe.dat\r\n\t\t\t// * enablecapture     : 화면캡처보안사용\r\n\t\t\t// * enablespool       : 스풀보안사용\r\n\t\t\t// * enableprinter     : 프린터보안사용\r\n\t\t\t// * enableprinterinfo : 프린터정보보안사용\r\n\t\t\t// * printeroption     : 프린터보안옵션 설정\r\n\t\t\t//    - 0:등록프린터, 공유프린터 지원안함\r\n\t\t\t//    - 1:등록프린터, 공유프린터 지원\r\n\t\t\t//    - 2:모든프린터, 공유프린터 지원 안함\r\n\t\t\t//    - 3:모든프린터, 공유프린터 지원\r\n\t\t\t// * imagesaferoption  : 화면보안옵션 설정\r\n\t\t\t//    - 0: 리모트툴 제어\r\n\t\t\t//    - 1:리모트툴 제어안함\r\n\t\t\t//**************************************************************************\r\n\t\t\t//RexCtl.InstallPlugIn(\"markany\", \"dllname=MAePageSAFERRexpert.dll;datafilename=MaPrintInfoNhicRex.dat;enablecapture=1;enablespool=1;enablep";
  private final static String _jspx_template10 = "rinter=1;enableprinterInfo=1;printeroption=3;imagesaferoption=0\");\r\n\t\t\t//RexCtl.InstallPlugIn(\"markany\", \"dllname=MAePageSAFERRexpert.dll;datafilename=MaPrintInfoNhicRex.dat;enablecapture=0;enablespool=0;enableprinter=0;enableprinterInfo=0;printeroption=3;imagesaferoption=0\");\r\n\r\n\t\t\tvar sMarkanyParam;\r\n\t\t\tif(rex_goRptMainParam.get(\"rex_markany_param\") != null)\r\n\t\t\t\tsMarkanyParam = rex_goRptMainParam.get(\"rex_markany_param\");\r\n\r\n\t\t\tRexCtl.InstallPlugIn(\"markany\", sMarkanyParam);\r\n\r\n\t   }\r\n\t   catch(e)\r\n\t   {\r\n\t     fnAlert(e.message);\r\n\t     \r\n\t     return false;\r\n\t   }\r\n\t   \r\n\t   return true;\r\n\t}\r\n\t\r\n\t\r\n\t//*****************************************************************\r\n\t//\r\n\t// * 마크애니 데이터 생성\r\n\t//\r\n\t//*****************************************************************\t\r\n\tfunction fnGenerate2D()\r\n\t{\t\r\n\t\tvar sCellWidth  = \"18\"; // 기본 바코드 넓이\r\n\t\tvar sCellHeight = \"2\";  // 기본 바코드 높이\r\n\t\t\r\n\t\tif(rex_goRptMainParam.get(\"rex_markany_cellwidth\") != null)\r\n\t\t\tsCellWidth = rex_goRptMainParam.get(\"rex_markany_cellwidth\");\r\n\t\t\t\r\n\t\tif(rex_goRptMainParam.get(\"rex_markany_cellheight\") != null)\r\n\t\t\tsCellHeight = rex_goRptMainParam.get(\"rex_markany_cellheight\");\r\n\t\t \r\n\t\tfor(var i = 0; i < RexCtl.GetPageCount(); i++)\r\n\t\t{\t\t    \r\n\t\t   var oConnectionDRM = RexCtl.CreateConnection(\"http.csv\");\r\n\t\t    \r\n\t\t   try\r\n\t\t   {\r\n\t\t   \t\t//\r\n\t\t    \t//oConnectionDRM.Path = \"http://\" + location.host + \"/portal/rexpert/MaFpsCommon.jsp\";\r\n\t\t    \t//oConnectionDRM.Path = rex_gsRexServiceRootURL + \"rexpert/jsp/MaFpsCommon.jsp\";\r\n\t\t    \toConnectionDRM.Path = rex_goRptMainParam.get(\"rex_markany_path\");\r\n\t\t    \toConnectionDRM.AddParameter(\"xml\", RexCtl.GetPageRTX(i));\r\n\t\t    \toConnectionDRM.AddParameter(\"cellwidth\", sCellWidth);\r\n\t\t    \toConnectionDRM.AddParameter(\"cellheight\", sCellHeight);\r\n\t\t    \t\r\n\t\t    \toConnectionDRM.Send();\r\n\r\n\t\t    \t//RexCtl.SetPageData(i, \"markany\", oConnectionDRM.Response(), \"MaPrintInfoNhicRex.dat\", \"\");\r\n\t\t    \tRexCtl.SetPageData(i, \"markany\", oConnectionDRM.Response(), rex_goRptMainParam.get(\"rex_markany_setpagedata\"), \"\");\r\n\t\t    }\r\n\t\t    catch(e)\r\n\t\t    {\r\n\t\t    \tfnAlert(e.message);\r\n\t\t    }\r\n\t\t    \r\n\t\t}\r\n\t\t\t\r\n\t}\t\r\n\t\r\n\tfunction fnGetSubReportData()\r\n\t{\r\n\t\tif (rex_goRptMainParam.get(\"rex_getsubreportdata\") == null) {\r\n\t\t\treturn rex_gsGetSubReportData;\r\n\t\t} else {\r\n\t\t\treturn rex_goRptMainParam.get(\"rex_getsubreportdata\");\r\n\t\t}\r\n\t}\r\n\r\n\tfunction fnGetSplitFields(sReportName, sSplitFields)\r\n\t{\r\n\t\tvar aReport;\r\n\t\tvar aTmp;\r\n\t\t\r\n\t\tif (sReportName == \"\") {\r\n\t\t\tsReportName = \"main\";\r\n\t\t}\r\n\r\n\t\taReport = sSplitFields.split(\";\");\r\n\t\t\r\n\t\tfor (var i = 0; i < aReport.length; i++) {\r\n\t\t\taTmp = aReport[i].split(\"=\");\r\n\t\t\t\r\n\t\t\tif (aTmp[0].trim() == sReportName) {\r\n\t\t\t\treturn aTmp[1].trim();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\tfunction fnGetImageFields(sReportName, sImageFields)\r\n\t{\r\n\t\tvar aReport;\r\n\t\tvar aTmp;\r\n\r\n\t\tif (sReportName == \"\") {\r\n\t\t\tsReportName = \"main\";\r\n\t\t}\r\n\r\n\t\taReport = sImageFields.split(\";\");\r\n\r\n\t\tfor (var i = 0; i < aReport.length; i++) {\r\n\t\t\taTmp = aReport[i].split(\"=\");\r\n\t\t\t\r\n\t\t\tif (aTmp[0].trim() == sReportName) {\r\n\t\t\t\treturn aTmp[1].trim();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\tfunction fnRptParamShare()\r\n\t{\r\n\t\tif (rex_goRptMainParam.get(\"rex_param_share\") == null) {\r\n\t\t\treturn rex_gsRptParamShare;\r\n\t\t} else {\r\n\t\t\treturn rex_goRptMainParam.get(\"rex_param_share\");\r\n\t\t}\r\n\t}\r\n\r\n\tfunction fnGetErrorMsg(oConnection)\r\n\t{\r\n\t\tvar oXMLDOM = oConnection.GetXMLDOM();\r\n\r\n\t\tif(oXMLDOM == null) {\r\n\t\t\tfnAlert(oConnection.Response());\r\n\t\t\treturn fnException();\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\toXMLDOM.setProperty(\"SelectionLanguage\", \"XPath\");\r\n\t\t\tvar oNodes = oXMLDOM.selectSingleNode(\"gubun/error/msg\");\r\n\r\n\t\t\tif(oNodes == null) {\r\n\t\t\t\tif (oXMLDOM.parseError.errorCode != 0) {\r\n\t\t\t\t\tvar oError = oXMLDOM.parseError;\r\n\t\t\t\t\tfnAlert(oError.reason);\r\n\t\t\t\t\treturn \"error\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn \"\";\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfnAlert(oNodes.text);\r\n\t\t\t\treturn \"error\";\r\n\t\t\t}\r\n\t\t} catch(e) {\r\n\t\t\tfnAlert(e.message);\r\n\t\t\treturn \"error\";\r\n\t\t}\r\n\t} // end fnGetErrorMsg\r\n\r\n\t// 예외 발생시 처리 함수\r\n\tfunction fnException() {\r\n\t\t//rex_goUserWindow.rex_gsEndLoadReportStatus = \"false\";\r\n\r\n";
  private final static String _jspx_template11 = "\r\n\t\tfnCloseProgress();\r\n\t}\r\n\r\n\tfunction fnCloseProgress() {\r\n\t\t// Progress 닫기\r\n\t\ttry\r\n\t\t{\r\n\t\t\tgoWin.close();\r\n\t\t} catch (e)\t{}\r\n\t}\r\n\r\n\tfunction fnAlert(sMsg) {\r\n\t\tif(rex_goRptMainParam.get(\"rex_script_alert\") != null &&\r\n\t\t   rex_goRptMainParam.get(\"rex_script_alert\") == \"false\") {\r\n\t\t\treturn;\r\n\t\t} else {\r\n\t\t\talert(sMsg);\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction fnArrToStr(aInData) {\r\n\t\tvar sSplitRow = \"|!|\";\r\n\t\tvar sSplitCol = \"|*|\";\r\n\t\t\r\n\t\tvar sOut = \"\";\r\n\t\t\r\n\t\tif (aInData == null) return sOut;\r\n\r\n\t\tfor(var i = 0; i < aInData.length; i++) {\r\n\t\t\tif (i > 0) sOut += sSplitRow;\r\n\t\t\tsOut += aInData[i][0] + sSplitCol;\r\n\t\t\tsOut += aInData[i][1];\r\n\t\t}\r\n\r\n\t\treturn sOut;\r\n\t}\r\n\r\n\tfunction fnGetParamSql(sReportName, oRptParam)\r\n\t{\r\n\t\tvar sRptNmKey = \"rex_param_sql\"; \r\n\r\n\t\tif (sReportName != \"\") sRptNmKey += \"_\" + sReportName;\r\n\r\n\t\tif (oRptParam.get(sRptNmKey) != null) {\r\n\t\t\treturn fnArrToStr(oRptParam.get(sRptNmKey));\r\n\t\t}\r\n\r\n \t\treturn \"\";\r\n\t}\r\n\r\n\tfunction fnSave() {\r\n\t\tif (rex_goRptMainParam.get(\"rex_save\") != null) {\r\n\t\t\tif (rex_goRptMainParam.get(\"rex_save\") == \"true\") {\r\n\t\t\t\tvar sFileType = \"\";\r\n\t\t\t\tvar sFileName = \"\";\r\n\t\t\t\tvar sFileOption = \"\";\r\n\t\r\n\t\t\t\tvar bSaveDirect = true;\r\n\t\r\n\t\t\t\tif (rex_goRptMainParam.get(\"rex_save_direct\") == null) {\r\n\t\t\t\t\tbSaveDirect = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (rex_goRptMainParam.get(\"rex_save_direct\") == \"true\") {\r\n\t\t\t\t\t\tbSaveDirect = true;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbSaveDirect = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tsFileName = rex_goRptMainParam.get(\"rex_save_file\");\r\n\t\t\t\t\r\n\t\t\t\tif (rex_goRptMainParam.get(\"rex_save_file_option\") == null) {\r\n\t\t\t\t\tsFileOption = \"\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsFileOption = rex_goRptMainParam.get(\"rex_save_file_option\");\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif (rex_goRptMainParam.get(\"rex_save_file_type\") == null) {\r\n\t\t\t\t\r\n\t\t\t\t\tvar aFileExt = sFileName.split(\".\");\r\n\t\t\t\t\t\r\n\t\t\t\t\tsFileType = aFileExt[aFileExt.length - 1];\r\n\t\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsFileType = rex_goRptMainParam.get(\"rex_save_file_type\");\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif (bSaveDirect == true) {\r\n\t\t\t\t\tRexCtl.SaveAs(sFileType, sFileName, 1, -1, sFileOption);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tRexCtl.SaveAsFilter = sFileType;\r\n\t\t\t\t\tRexCtl.SaveAsDefaultFileName = sFileName;\r\n\t\t\t\t\tRexCtl.SaveAsOption(\"xls\",sFileOption);\r\n\t\t\t\t\tRexCtl.SaveAsDialog(sFileOption);\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tif (rex_goRptMainParam.SaveEnd != null) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tif (rex_goRptMainParam.get(\"rex_save_end\") != null) {\r\n\t\t\t\t\t\t\trex_goRptMainParam.SaveEnd(sFileType, sFileName, rex_goRptMainParam.get(\"rex_save_end\"));\r\n\t                    }\r\n\t\t\t\t\t} catch(e) {\r\n\t\t\t\t\t\t//\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<script LANGUAGE=\"JavaScript\" FOR=\"RexCtl\" EVENT=\"EndLoadReport\">\r\n\t//SaveAs([타입명], [저장 경로], [시작페이지], [끝페이지], [옵션리스트])\r\n\t//RexCtl.SaveAs(\"xls\", \"c:\\\\test1.xls\", 1, -1, \"\");\r\n\t//RexCtl.SaveAs(\"rtf\", \"c:\\\\test.doc\", 1, -1, \"\");\r\n\r\n\t//RexCtl.SaveAsFilter = \"doc\";\r\n\t\r\n\t//RexCtl.PrintEx2(true, 1, 1, 1, \"printername=\\\\\\\\124.137.28.171\\\\HP LaserJet 4200 PCL 6\");\r\n\t//RexCtl.PrintEx2(false, 1, 1, 1, \"printername=FinePrint\");\r\n\t//RexCtl.PrintEx2(false, 1, 1, 1, \"hp LaserJet 1015\");\r\n\t//RexCtl.PrintEx2(false, 1, 1, 1, \"printername=hp LaserJet 1015\");\r\n\r\n\tif (rex_goRptMainParam.get(\"rex_progress\") != null &&\r\n\t\trex_goRptMainParam.get(\"rex_progress\") == \"true\") {\r\n\r\n\t\tfnCloseProgress();\r\n\t}\r\n\r\n\r\n\tif (rex_goRptMainParam.EndLoadEnd != null) {\r\n\t\ttry {\r\n\t\t\tif (rex_goRptMainParam.get(\"rex_endload_end\") != null) {\r\n\t\t\t\trex_goRptMainParam.EndLoadEnd(rex_goMainReport, rex_goMainDataSet, rex_goRptMainParam.get(\"rex_endload_end\"));\r\n            }\r\n\t\t} catch(e) {\r\n\t\t\t//\r\n\t\t}\r\n\t}\r\n\r\n\tfnSave();\r\n\r\n\tif (rex_goRptMainParam.get(\"rex_print\") != null) {\r\n\t\tif (rex_goRptMainParam.get(\"rex_print\") == \"true\" && rex_gsPrintStatus == \"false\") {\r\n\r\n\t\t\tif (rex_goRptMainParam.get(\"rex_print_option\") != null) {\r\n\t\t\t\tRexCtl.PrintOption = rex_goRptMainParam.get(\"rex_print_option\");\r\n\t\t\t}\r\n\r\n\t\t\tvar bPrintDirect = rex_goRptMainParam.get(\"rex_printdirect\");\r\n\r\n\t\t\tif (bPrintDirect == \"true\") {\r\n\t\t\t\tbPrintDirect = true;\r\n\t\t\t} else {\r\n\t\t\t\tbPrintDirect = false;\r\n\t\t\t}\r\n\r\n\t\t\tvar sStartPage = rex_goRptMainParam.get(\"rex_print_startpage\");\r\n\t\t\tif (sStartPage == null) sStartPage";
  private final static String _jspx_template12 = " = \"1\";\r\n\r\n\t\t\tvar sEndPage = rex_goRptMainParam.get(\"rex_print_endpage\");\r\n\t\t\tif (sEndPage == null) sEndPage = \"-1\";\r\n\r\n\t\t\tvar sCount = rex_goRptMainParam.get(\"rex_print_count\");\r\n\t\t\tif (sCount == null) sCount = \"1\";\r\n\r\n\t\t\tvar sPrintSkipZero = rex_goRptMainParam.get(\"rex_print_skipzero\");\r\n\t\t\tif (sPrintSkipZero == null) sPrintSkipZero = \"false\";\r\n\r\n\t\t\t//if (sPrintSkipZero == \"true\" && rex_goMainDataSet.RowCount <= 0) {\r\n\t\t\tif (sPrintSkipZero == \"true\" && giMainDataSetRowCount <= 0) {\r\n\t\t\t\t// skip\r\n\t\t\t} else {\r\n\t\t\t\tif (rex_goRptMainParam.get(\"rex_print_printername\") != null) {\r\n\t\t\t\t\tRexCtl.PrintEx2(!bPrintDirect, parseInt(sStartPage), parseInt(sEndPage), parseInt(sCount),\r\n\t\t\t\t\t\t\t\t\t\"printername=\" + rex_goRptMainParam.get(\"rex_print_printername\"));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tRexCtl.Print(!bPrintDirect, parseInt(sStartPage), parseInt(sEndPage), parseInt(sCount));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif (rex_goRptMainParam.get(\"rex_auto_next_page\") != null) {\r\n\t\tvar iSec = parseInt(rex_goRptMainParam.get(\"rex_auto_next_page\"));\r\n\t\twindow.setInterval(\"fnAutoNextPage();\", iSec * 1000);\r\n\t}\r\n</script>\r\n\r\n<script LANGUAGE=\"JavaScript\" FOR=\"RexCtl\" EVENT=\"FinishPrint\">\r\n\tif (rex_goRptMainParam.PrintEnd != null) {\r\n\t\ttry {\r\n\t\t\tif (rex_goRptMainParam.get(\"rex_print_end\") != null) {\r\n\t\t\t\trex_goRptMainParam.PrintEnd(rex_goMainReport, rex_goMainDataSet, giMainDataSetRowCount, rex_goRptMainParam.get(\"rex_print_end\"), RexCtl);\r\n            }\r\n\t\t} catch(e) {\r\n\t\t\t//\r\n\t\t}\r\n\t}\r\n\r\n\tif (rex_goRptMainParam.get(\"rex_print\") != null) {\r\n\t\tif (rex_goRptMainParam.get(\"rex_print\") == \"true\") {\r\n\t\t\trex_gsPrintStatus = \"true\";\r\n\t\t\trex_goUserWindow.rex_gsPrintStatus = rex_gsPrintStatus;\r\n\t\t}\r\n\t}\r\n\r\n\t//alert(\"출력이 완료 되었습니다.\");\r\n\r\n</script>\r\n\r\n<!--script LANGUAGE=\"JavaScript\" FOR=\"RexCtl\" EVENT=\"HyperLinkClicked(bstrLink, bstrToolTip, vtCanceled)\">\r\n\t//window.open(\"http://www.naver.com\", \"\", \"center=yes,scrollbars=no,status=no,toolbar=no,resizable=0,location=no,menu=no,width=800,height=600\");\r\nalert(bstrLink);\r\n\tvtCanceled = true;\r\n\r\n\tif (rex_goRptMainParam.HyperLinkEnd != null) {\r\n\t\ttry {\r\n\t\t\tif (rex_goRptMainParam.get(\"rex_hyperlink_end\") != null) {\r\n\t\t\t\trex_goRptMainParam.HyperLinkEnd(rex_goMainReport, bstrLink, bstrToolTip, rex_goRptMainParam.get(\"rex_hyperlink_end\"));\r\n            }\r\n\t\t} catch(e) {\r\n\t\t\t//alert(e);\r\n\t\t}\r\n\t}\r\n</script -->\r\n\r\n<script LANGUAGE=\"VBScript\" FOR=\"RexCtl\" EVENT=\"HyperLinkClicked(bstrLink, bstrToolTip, vtCanceled)\">\r\n\t' Call window.open(\"http://www.naver.com\", \"\", \"center=yes,scrollbars=no,status=no,toolbar=no,resizable=0,location=no,menu=no,width=800,height=600\")\r\n\r\n\tvtCanceled = true\r\n\r\n\tOn Error Resume Next\r\n\t\r\n\tIf Not IsNull(rex_goRptMainParam.HyperLinkEnd) Then\r\n\r\n\t\tIf Not IsNull(rex_goRptMainParam.get(\"rex_hyperlink_end\")) Then\r\n\t\t\tCall rex_goRptMainParam.HyperLinkEnd(rex_goMainReport, bstrLink, bstrToolTip, rex_goRptMainParam.get(\"rex_hyperlink_end\"))\r\n\t\tEnd If\r\n\tEnd If\r\n\t\r\n\tErr.Clear\r\n</script>\r\n\r\n<script LANGUAGE=\"VBScript\" FOR=\"RexCtl\" EVENT=\"ButtonSaveAsClickBefore(Cancel)\">\r\n\tDim sFileOption\r\n\r\n\tIf IsNull(rex_goRptMainParam.get(\"rex_save_file_option\")) Then\r\n\t\tsFileOption = \"\"\r\n\tElse\r\n\t\tsFileOption = rex_goRptMainParam.get(\"rex_save_file_option\")\r\n\r\n\t\tCall RexCtl.SaveAsOption(\"xls\", sFileOption)\r\n\tEnd If\r\n\r\n\tIf Not IsNull(rex_goRptMainParam.get(\"rex_save_file\")) Then\r\n\t\tRexCtl.SaveAsDefaultFileName = rex_goRptMainParam.get(\"rex_save_file\")\r\n\tEnd If\r\n\r\n\tIf Not IsNull(rex_goRptMainParam.get(\"rex_save_preview_direct\")) Then\r\n\t\tIf rex_goRptMainParam.get(\"rex_save_preview_direct\") = \"true\" Then\r\n\t\t\tCancel = true\r\n\t\t\t\t\r\n\t\t\tCall rex_goRptMainParam.put(\"rex_save\", \"true\")\r\n\t\t\t\r\n\t\t\tCall fnSave()\r\n\t\tEnd If\r\n\tEnd If\r\n</script>\r\n\r\n<script LANGUAGE=\"JavaScript\" >\r\n\r\n\tvar gnPageNo = 1;\r\n\r\n\tfunction fnAutoNextPage()\r\n\t{\t\r\n\t\tif(gnPageNo == RexCtl.GetPageCount()) \r\n\t\t{ \r\n\t\t\tRexCtl.movefirstpage();\r\n\t\t\tgnPageNo = 1;\r\n\t\t} \r\n\t\telse\r\n\t\t{  \r\n\t\t\tRexCtl.movenextpage();\r\n\t\t\tgnPageNo++;\r\n\t\t}\r\n\t}\r\n\r\n</script>\r\n\r\n\r\n<script LANGUAGE=\"JavaScript\" FOR=\"window\" EVENT=\"onbeforeunload\">\r\n\t//RexCtl.CloseReport();\r\n\t//alert(\"onfeforeunload\");\r\n</script>\r\n\r\n</head>\r\n<";
  private final static String _jspx_template13 = "body topmargin=\"0\" leftmargin=\"0\"  rightmargin=\"0\" bottommargin=\"0\" onload=\"OnLoad();\" style=\"width:100%;height:100%\">\r\n\t<!--input type=\"text\" id=\"idCnt\"><br-->\r\n\t<script src=\"./rexscript/rexplugin.js\"></script>\r\n\t";
  private final static String _jspx_template14 = "\r\n\t\t<script language=\"JavaScript\" src=\"./rexscript/";
  private final static String _jspx_template15 = "\"></script>\r\n\t";
  private final static String _jspx_template16 = "\r\n\t<!--script src=\"./rexscript/rex_addon.js\"></script-->\r\n</body>\r\n</html>";
}
