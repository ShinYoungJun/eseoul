// \uc815\uae30\ubd84 \uc870\ud68c \ub9ac\uc2a4\ud2b8
Querys.jumyong.junggi.getNowPrice =\
SELECT MAX(PRICE) PRICE \
  FROM ( \
        SELECT PRICE FROM NOW_PRICE WHERE ADMIN_NO= ? AND YEAR >= ? \
         UNION \
        SELECT '0' AS PRICE FROM DUAL \
       )

Querys.jumyong.junggi.PriceApllyUpdate3 =\
UPDATE NOW_PRICE \
   SET PRICE = DECODE((SELECT CP.JIGA \
                  FROM PLACE P,CP_BD_600 CP \
                 WHERE '11' || P.SIGUNGU || P.BJ_CD || P.SPC_CD || LPAD(p.bonbun,4, '0') || LPAD(DECODE(P.BUBUN,NULL,'0',P.BUBUN), 4, 0) = CP.ADDRESS \
                   AND P.ADMIN_NO = ?), NULL, 0) \
       , YEAR = TO_CHAR(SYSDATE, 'YYYY') \
       , UP_DATE = TO_CHAR(SYSDATE, 'YYYYMMDD') \
 WHERE ADMIN_NO=?

Querys.jumyong.junggi.PriceApllySelect =\
SELECT COUNT(*) FROM NOW_PRICE WHERE ADMIN_NO = ?

Querys.jumyong.junggi.PriceApllyUpdate2 =\
UPDATE PLACE \
   SET PRICE = DECODE((SELECT CP.JIGA \
                  FROM PLACE P,CP_BD_600 CP \
                 WHERE '11' || P.SIGUNGU || P.BJ_CD || P.SPC_CD || LPAD(p.bonbun,4, '0') || LPAD(DECODE(P.BUBUN,NULL,'0',P.BUBUN), 4, 0) = CP.ADDRESS \
                   AND P.ADMIN_NO = ?), NULL, 0) \
 WHERE ADMIN_NO=?

Querys.jumyong.junggi.PriceApllyUpdate =\
INSERT \
  INTO NOW_PRICE \
SELECT P.ADMIN_NO, TO_CHAR(SYSDATE, 'YYYY') YEAR, CP.JIGA, TO_CHAR(SYSDATE, 'YYYYMMDD') UP_DATE \
  FROM PLACE P,CP_BD_600 CP \
 WHERE '11' || P.SIGUNGU || P.BJ_CD || P.SPC_CD || LPAD(p.bonbun,4, '0') || LPAD(DECODE(P.BUBUN,NULL,'0',P.BUBUN), 4, 0) = CP.ADDRESS \
   AND P.ADMIN_NO = ?

Querys.jumyong.junggi.PriceAplly =\
SELECT P.ADMIN_NO \
  FROM APPEAL A, PLACE P, TAXATION_INFO T, CALCULATION_INFO CI \
 WHERE P.ADMIN_NO = A.ADMIN_NO \
   AND P.ADMIN_NO = CI.ADMIN_NO \
   AND CI.CAL_SUM_SEQ = T.SEQ(+) \
   AND P.PURPOSE_CD NOT LIKE '7%' \
   AND P.SECTION NOT IN (2,4) \
   AND SUBSTR(A.ADMIN_NO,7,3) = ? \
   AND SUBSTR(T.TAX_YM,0,4) = ? \
   AND P.TYPE LIKE ? \
   AND P.TAX_SET LIKE ? \
   AND DECODE(T.TAX_YN,NULL,'0',T.TAX_YN) LIKE ? \
   AND P.PURPOSE_CD LIKE ? \
   AND P.PURPOSE_CD NOT LIKE '7%' \
   AND P.BJ_CD LIKE ? \
   AND P.HJ_CD LIKE ? \
   AND A.NAME LIKE ? \
   AND P.SECTION LIKE ? \
 GROUP BY P.ADMIN_NO \
 ORDER BY ADMIN_NO DESC

Querys.jumyong.junggi.landPriceAllApllyCount =\
SELECT COUNT(*) \
  FROM ( \
SELECT ADMIN_NO, NAME, JIGA, BJ_NM, BONBUN, BUBUN \
  FROM ( \
SELECT substr(P.ADMIN_NO, 10, 20) ADMIN_NO, A.NAME, NVL(CP.JIGA, 0) JIGA \
       , ( SELECT DISTINCT(BJ_NM) \
             FROM REF_DONGCODE \
            WHERE P.BJ_CD = BJ_CD \
              AND P.SIDO = SI_CD  \
              AND P.SIGUNGU = GU_CD \
              AND P.HJ_CD = HJ_CD(+) ) AS BJ_NM \
       , P.BONBUN \
       , P.BUBUN \
   FROM APPEAL A, PLACE P, TAXATION_INFO T, CALCULATION_INFO CI, CP_BD_600 CP, CAL_SUM_INFO C \
 WHERE C.ADMIN_NO = A.ADMIN_NO \
	AND C.ADMIN_NO = P.ADMIN_NO \
	AND CI.ADMIN_NO = C.ADMIN_NO \
	AND C.SEQ = CI.CAL_SUM_SEQ \
	AND C.ADMIN_NO = T.ADMIN_NO(+) \
	AND C.TAX_SEQ = T.SEQ(+) \
   AND '11' || P.SIGUNGU || P.BJ_CD || P.SPC_CD || LPAD(p.bonbun,4, '0') || LPAD(DECODE(P.BUBUN,NULL,'0',P.BUBUN), 4, 0) = CP.ADDRESS(+) \
   AND P.PURPOSE_CD NOT LIKE '7%' \
   AND P.SECTION NOT IN (2,4) \
   AND SUBSTR(A.ADMIN_NO,7,3) = ? \
   AND SUBSTR(T.TAX_YM,0,4) = ? \
   AND P.TYPE LIKE ? \
   AND P.TAX_SET LIKE ? \
   AND DECODE(T.TAX_YN,NULL,'0',T.TAX_YN) LIKE ? \
   AND P.PURPOSE_CD LIKE ?  \
   AND P.BJ_CD LIKE ? \
   AND P.HJ_CD LIKE ? \
   AND A.NAME LIKE ? \
   AND P.SECTION LIKE ? \
 ORDER BY ADMIN_NO DESC \
   ) \
 GROUP BY ADMIN_NO, NAME, JIGA, BJ_NM, BONBUN, BUBUN \
 )
   
Querys.jumyong.junggi.landPriceAllAplly =\
SELECT R_ID, AA.ADMIN_NO, AA.NAME, AA.JIGA, AA.BJ_NM, AA.BONBUN, AA.BUBUN, AA.AREA_SIZE \
  FROM ( \
SELECT ROWNUM R_ID, AA.* \
  FROM ( \
SELECT ADMIN_NO, NAME, JIGA, BJ_NM, BONBUN, BUBUN, AREA_SIZE \
  FROM ( \
SELECT substr(P.ADMIN_NO, 10, 20) ADMIN_NO, A.NAME, NVL(CP.JIGA, 0) JIGA \
       , ( SELECT DISTINCT(BJ_NM) \
             FROM REF_DONGCODE \
            WHERE P.BJ_CD = BJ_CD \
              AND P.SIDO = SI_CD \
              AND P.SIGUNGU = GU_CD \
              AND P.HJ_CD = HJ_CD(+) ) AS BJ_NM  \
       , P.BONBUN \
       , P.BUBUN \
       , P.AREA_SIZE \
  FROM APPEAL A, PLACE P, TAXATION_INFO T, CALCULATION_INFO CI, CP_BD_600 CP, CAL_SUM_INFO C \
 WHERE C.ADMIN_NO = A.ADMIN_NO \
	AND C.ADMIN_NO = P.ADMIN_NO \
	AND CI.ADMIN_NO = C.ADMIN_NO \
	AND C.SEQ = CI.CAL_SUM_SEQ \
	AND C.ADMIN_NO = T.ADMIN_NO(+) \
	AND C.TAX_SEQ = T.SEQ(+) \
   AND '11' || P.SIGUNGU || P.BJ_CD || P.SPC_CD || LPAD(p.bonbun,4, '0') || LPAD(DECODE(P.BUBUN,NULL,'0',P.BUBUN), 4, 0) = CP.ADDRESS(+) \
   AND P.PURPOSE_CD NOT LIKE '7%' \
   AND P.SECTION NOT IN (2,4) \
   AND SUBSTR(A.ADMIN_NO,7,3) = ? \
   AND SUBSTR(T.TAX_YM,0,4) = ? \
   AND P.TYPE LIKE ? \
   AND P.TAX_SET LIKE ? \
   AND DECODE(T.TAX_YN,NULL,'0',T.TAX_YN) LIKE ? \
   AND P.PURPOSE_CD LIKE ?  \
   AND P.BJ_CD LIKE ? \
   AND P.HJ_CD LIKE ? \
   AND A.NAME LIKE ? \
   AND P.SECTION LIKE ? \
   ) \
 GROUP BY ADMIN_NO, NAME, JIGA, BJ_NM, BONBUN, BUBUN, AREA_SIZE \
 ORDER BY ADMIN_NO DESC \
   ) AA \
   ) AA WHERE R_ID BETWEEN ? AND ?  
   
Querys.jumyong.junggi.periodicalList = \
SELECT 		R_ID, YEAR, ADMIN_NO, ADMIN_NO2, NAME, PURPOSE_CD, BONBUN, BUBUN , WITH_ADDR1 , SUM_ADJUST , SSN\
			, SUM , AREA , FROMDATE , TODATE , RATE , PRICE , LAST_FROMDATE , LAST_TODATE , TAX_NO ,TAX_YN \
			, BJ_NM , TYPE , SECTION , SECTION_NAME , TAX_SET, FORM_ADJUST, OWNER_SET_NM \
			, SIGU_CD , BJ_CD , DEPT_CD , TAX_GUBUN , OBJ_SET \
		    , TAXPAYER_ID , TAXPAYER_SET , OCR_SIGU_CD , OCR_BUSEO_CD , TAX_CD \
		    , LIVE , ADD_SET , ADD_YN , SUM_LASTYEAR , REDUCTION_RATE \
		    , SUBUSEO_CD , REDUCTION_REASON , VAT , TAXNAME \
			, (SELECT DISTINCT(CLASS_NM||' '||SORT_NM||' '||KIND_NM) FROM REF_PURPOSECODE \
            WHERE PURPOSE_CD = CODE AND SECTION = TYPE ) AS PURPOSE_NM \
            , REDUCTION_SUM , REDUCTION_FORM \
            , WSP_YN, WITH_SUM_PRICE \
	       	, POST, ADDR \
	       	, SI, GUN, DORO_NM, BD_NM, BD_DET_NM, BD_BON , BD_BU, ADDR_NEW \
	       	, ROAD_ADDR \
	FROM  ( \
		SELECT ROWNUM R_ID, YEAR, ADMIN_NO, ADMIN_NO2, NAME, PURPOSE_CD, BONBUN, BUBUN , WITH_ADDR1 , SUM_ADJUST , SSN\
				, SUM, AREA , FROMDATE, TODATE, RATE, PRICE, LAST_FROMDATE, LAST_TODATE , TAX_NO ,TAX_YN \
				, BJ_NM , TYPE , SECTION , SECTION_NAME , TAX_SET, FORM_ADJUST, OWNER_SET_NM \
				, SIGU_CD , BJ_CD , DEPT_CD , TAX_GUBUN , OBJ_SET \
		       	, TAXPAYER_ID , TAXPAYER_SET , OCR_SIGU_CD , OCR_BUSEO_CD , TAX_CD \
		       	, LIVE , ADD_SET , ADD_YN , SUM_LASTYEAR , REDUCTION_RATE \
		       	, SUBUSEO_CD , REDUCTION_REASON , VAT , TAXNAME \
		       	, REDUCTION_SUM , REDUCTION_FORM \
		       	, WSP_YN, WITH_SUM_PRICE \
		       	, POST, ADDR \
		       	, SI, GUN, DORO_NM, BD_NM, BD_DET_NM, BD_BON , BD_BU, ADDR_NEW \
				, ROAD_ADDR \
			FROM  ( \
					SELECT DISTINCT (C.ADMIN_NO||T.TAX_NO||C.SEQ), C.ADMIN_NO, C.YEAR, SUBSTR(C.ADMIN_NO, 10, 19) ADMIN_NO2 , A.NAME ,P.PURPOSE_CD , A.SSN \
					       , P.BONBUN , P.BUBUN , P.WITH_ADDR1 , C.SUM_ADJUST , C.SUM \
					       , C.AREA , C.FROMDATE , C.TODATE, C.RATE, C.PRICE \
					       , C.FROMDATE AS LAST_FROMDATE , C.TODATE AS LAST_TODATE , T.TAX_NO , T.TAX_YN  , RD.BJ_NM \
					       , P.TYPE , P.SECTION , RC.NAME SECTION_NAME , P.TAX_SET, C.FORM_ADJUST \
					       , (SELECT R.NAME FROM REF_COMMONCODE R WHERE R.CODE = P.OWNER_SET AND R.TYPE='use_ownerGroup') AS OWNER_SET_NM \
					       , T.SIGU_CD , T.BJ_CD , T.DEPT_CD , T.TAX_GUBUN , T.OBJ_SET \
					       , T.TAXPAYER_ID , T.TAXPAYER_SET , T.OCR_SIGU_CD , T.OCR_BUSEO_CD , T.TAX_CD \
					       , T.LIVE , T.ADD_SET , T.ADD_YN , CI2.SUM_LASTYEAR , C.REDUCTION_RATE \
					       , T.SUBUSEO_CD , C.REDUCTION_REASON , T.VAT \
					       , A.SI, A.GUN, A.DORO_NM, A.BD_NM, A.BD_DET_NM, A.BD_BON , A.BD_BU \
					       , A.SI||' '|| A.GUN||' '|| A.DORO_NM||' '|| A.BD_NM||' '|| A.BD_DET_NM||' '|| A.BD_BON ||' '|| A.BD_BU AS ADDR_NEW \
					       , (SELECT TAXNAME FROM REF_TAXCODE WHERE T.TAX_CD = TAXCODE) TAXNAME \
					       , C.SUM AS REDUCTION_SUM , C.FORM_ADJUST AS REDUCTION_FORM \
					       , P.WSP_YN, P.WITH_SUM_PRICE \
					       , CASE WHEN LENGTH(A.POST)=5 THEN POST \
  		 						 ELSE SUBSTR(A.POST,0,3)||'-'||SUBSTR(A.POST,4,3) \
                   END AS POST \
					       , A.ADDR1||' '||DECODE(A.SAN,'1','\uc0b0 ',' ')||A.BON||DECODE(A.BU,NULL,'','-'||A.BU)||' '||A.ADDR2 AS ADDR \
						   , P.ROAD_ADDR||' '||P.ROAD_BON||DECODE(P.ROAD_BU,NULL,'','-'||P.ROAD_BU) AS ROAD_ADDR \
					FROM 	CAL_SUM_INFO C, APPEAL A, PLACE P, CALCULATION_INFO CI , TAXATION_INFO T , REF_DONGCODE RD , REF_COMMONCODE RC \
			            	, (SELECT ADMIN_NO,CAL_SUM_SEQ,MAX(SUM_LASTYEAR) AS SUM_LASTYEAR FROM CALCULATION_INFO GROUP BY ADMIN_NO,CAL_SUM_SEQ) CI2 \
					WHERE C.ADMIN_NO = A.ADMIN_NO \
					AND C.ADMIN_NO = P.ADMIN_NO \
					AND CI.ADMIN_NO = C.ADMIN_NO \
					AND C.SEQ = CI.CAL_SUM_SEQ \
					AND C.ADMIN_NO = T.ADMIN_NO \
					AND C.TAX_SEQ = T.SEQ \
					AND CI2.ADMIN_NO = C.ADMIN_NO \
					AND CI2.CAL_SUM_SEQ = C.SEQ \
					AND P.BJ_CD = RD.BJ_CD \
					AND SUBSTR(P.ADMIN_NO, 5, 2) = RD.SI_CD \
					AND SUBSTR(P.ADMIN_NO, 7, 3) = RD.GU_CD \
					AND P.SECTION <> '2' \
					AND P.SECTION <> '4' \
					AND RC.TYPE = 'use_section' \
					AND T.TAX_GUBUN = RC.CODE \
					AND C.YEAR LIKE ? \
					AND SUBSTR(A.ADMIN_NO,7,3) LIKE ? \
					AND C.YEAR LIKE ? \
					AND P.TYPE LIKE ? \
					AND P.TAX_SET LIKE ? \
					AND DECODE(T.TAX_YN,NULL,'0',T.TAX_YN) LIKE ? \
					AND C.FROMDATE >= ? \
					AND C.TODATE <= ? \
					AND P.PURPOSE_CD LIKE ? \
					AND P.PURPOSE_CD NOT LIKE '7%' \
					AND P.BJ_CD LIKE ? \
					AND P.HJ_CD LIKE ? \
					AND A.NAME LIKE ? \
					AND P.SECTION LIKE ? \
					ORDER BY ADMIN_NO DESC \
					) \
)WHERE R_ID BETWEEN ? AND ? \

Querys.jumyong.junggi.periodicalList_180612 = \
SELECT 		R_ID, YEAR, ADMIN_NO, ADMIN_NO2, NAME, PURPOSE_CD, BONBUN, BUBUN , WITH_ADDR1 , SUM_ADJUST , SSN\
			, SUM , AREA , FROMDATE , TODATE , RATE , PRICE , LAST_FROMDATE , LAST_TODATE , TAX_NO ,TAX_YN \
			, BJ_NM , TYPE , SECTION , SECTION_NAME , TAX_SET, FORM_ADJUST, OWNER_SET_NM \
			, SIGU_CD , BJ_CD , DEPT_CD , TAX_GUBUN , OBJ_SET \
		    , TAXPAYER_ID , TAXPAYER_SET , OCR_SIGU_CD , OCR_BUSEO_CD , TAX_CD \
		    , LIVE , ADD_SET , ADD_YN , SUM_LASTYEAR , REDUCTION_RATE \
		    , SUBUSEO_CD , REDUCTION_REASON , VAT , TAXNAME \
			, (SELECT DISTINCT(CLASS_NM||' '||SORT_NM||' '||KIND_NM) FROM REF_PURPOSECODE \
            WHERE PURPOSE_CD = CODE AND SECTION = TYPE ) AS PURPOSE_NM \
            , REDUCTION_SUM , REDUCTION_FORM \
            , WSP_YN, WITH_SUM_PRICE \
	       	, POST, ADDR \
	       	, SI, GUN, DORO_NM, BD_NM, BD_DET_NM, BD_BON , BD_BU, ADDR_NEW \
	       	, ROAD_ADDR \
	FROM  ( \
		SELECT ROWNUM R_ID, YEAR, ADMIN_NO, ADMIN_NO2, NAME, PURPOSE_CD, BONBUN, BUBUN , WITH_ADDR1 , SUM_ADJUST , SSN\
				, SUM, AREA , FROMDATE, TODATE, RATE, PRICE, LAST_FROMDATE, LAST_TODATE , TAX_NO ,TAX_YN \
				, BJ_NM , TYPE , SECTION , SECTION_NAME , TAX_SET, FORM_ADJUST, OWNER_SET_NM \
				, SIGU_CD , BJ_CD , DEPT_CD , TAX_GUBUN , OBJ_SET \
		       	, TAXPAYER_ID , TAXPAYER_SET , OCR_SIGU_CD , OCR_BUSEO_CD , TAX_CD \
		       	, LIVE , ADD_SET , ADD_YN , SUM_LASTYEAR , REDUCTION_RATE \
		       	, SUBUSEO_CD , REDUCTION_REASON , VAT , TAXNAME \
		       	, REDUCTION_SUM , REDUCTION_FORM \
		       	, WSP_YN, WITH_SUM_PRICE \
		       	, POST, ADDR \
		       	, SI, GUN, DORO_NM, BD_NM, BD_DET_NM, BD_BON , BD_BU, ADDR_NEW \
				, ROAD_ADDR \
			FROM  ( \
					SELECT DISTINCT (C.ADMIN_NO||T.TAX_NO||C.SEQ), C.ADMIN_NO, C.YEAR, SUBSTR(C.ADMIN_NO, 10, 19) ADMIN_NO2 , A.NAME ,P.PURPOSE_CD , A.SSN \
					       , P.BONBUN , P.BUBUN , P.WITH_ADDR1 , C.SUM_ADJUST , C.SUM \
					       , C.AREA , C.FROMDATE , C.TODATE, C.RATE, C.PRICE \
					       , C.FROMDATE AS LAST_FROMDATE , C.TODATE AS LAST_TODATE , T.TAX_NO , T.TAX_YN  , RD.BJ_NM \
					       , P.TYPE , P.SECTION , RC.NAME SECTION_NAME , P.TAX_SET, C.FORM_ADJUST \
					       , (SELECT R.NAME FROM REF_COMMONCODE R WHERE R.CODE = P.OWNER_SET AND R.TYPE='use_ownerGroup') AS OWNER_SET_NM \
					       , T.SIGU_CD , T.BJ_CD , T.DEPT_CD , T.TAX_GUBUN , T.OBJ_SET \
					       , T.TAXPAYER_ID , T.TAXPAYER_SET , T.OCR_SIGU_CD , T.OCR_BUSEO_CD , T.TAX_CD \
					       , T.LIVE , T.ADD_SET , T.ADD_YN , CI2.SUM_LASTYEAR , C.REDUCTION_RATE \
					       , T.SUBUSEO_CD , C.REDUCTION_REASON , T.VAT \
					       , A.SI, A.GUN, A.DORO_NM, A.BD_NM, A.BD_DET_NM, A.BD_BON , A.BD_BU \
					       , A.SI||' '|| A.GUN||' '|| A.DORO_NM||' '|| A.BD_NM||' '|| A.BD_DET_NM||' '|| A.BD_BON ||' '|| A.BD_BU AS ADDR_NEW \
					       , (SELECT TAXNAME FROM REF_TAXCODE WHERE T.TAX_CD = TAXCODE) TAXNAME \
					       , C.SUM AS REDUCTION_SUM , C.FORM_ADJUST AS REDUCTION_FORM \
					       , P.WSP_YN, P.WITH_SUM_PRICE \
					       , CASE WHEN LENGTH(A.POST)=5 THEN POST \
  		 						 ELSE SUBSTR(A.POST,0,3)||'-'||SUBSTR(A.POST,4,3) \
                   END AS POST \
					       , A.ADDR1||' '||DECODE(A.SAN,'1','\uc0b0 ',' ')||A.BON||DECODE(A.BU,NULL,'','-'||A.BU)||' '||A.ADDR2 AS ADDR \
						   , P.ROAD_ADDR||' '||P.ROAD_BON||DECODE(P.ROAD_BU,NULL,'','-'||P.ROAD_BU) AS ROAD_ADDR \
					FROM 	CAL_SUM_INFO C, APPEAL A, PLACE P, CALCULATION_INFO CI , TAXATION_INFO T , REF_DONGCODE RD , REF_COMMONCODE RC \
			            	, (SELECT ADMIN_NO,CAL_SUM_SEQ,MAX(SUM_LASTYEAR) AS SUM_LASTYEAR FROM CALCULATION_INFO GROUP BY ADMIN_NO,CAL_SUM_SEQ) CI2 \
					WHERE C.ADMIN_NO = A.ADMIN_NO \
					AND C.ADMIN_NO = P.ADMIN_NO \
					AND CI.ADMIN_NO = C.ADMIN_NO \
					AND C.SEQ = CI.CAL_SUM_SEQ \
					AND C.ADMIN_NO = T.ADMIN_NO \
					AND C.TAX_SEQ = T.SEQ \
					AND CI2.ADMIN_NO = C.ADMIN_NO \
					AND CI2.CAL_SUM_SEQ = C.SEQ \
					AND P.BJ_CD = RD.BJ_CD \
					AND SUBSTR(P.ADMIN_NO, 5, 2) = RD.SI_CD \
					AND SUBSTR(P.ADMIN_NO, 7, 3) = RD.GU_CD \
					AND P.SECTION <> '2' \
					AND P.SECTION <> '4' \
					AND RC.TYPE = 'use_section' \
					AND T.TAX_GUBUN = RC.CODE \
					AND C.YEAR LIKE ? \
					AND SUBSTR(A.ADMIN_NO,7,3) LIKE ? \
					AND C.YEAR LIKE ? \
					AND P.TYPE LIKE ? \
					AND P.TAX_SET LIKE ? \
					AND DECODE(T.TAX_YN,NULL,'0',T.TAX_YN) LIKE ? \
					AND C.FROMDATE >= ? \
					AND C.TODATE <= ? \
					AND P.PURPOSE_CD LIKE ? \
					AND P.PURPOSE_CD NOT LIKE '7%' \
					AND P.BJ_CD LIKE ? \
					AND P.HJ_CD LIKE ? \
					AND A.NAME LIKE ? \
					AND P.SECTION LIKE ? \
					ORDER BY ADMIN_NO DESC \
					) \
)WHERE R_ID BETWEEN ? AND ? \

Querys.jumyong.junggi.periodicalList_150917 = \
SELECT 		R_ID, YEAR, ADMIN_NO, ADMIN_NO2, NAME, PURPOSE_CD, BONBUN, BUBUN , WITH_ADDR1 , SUM_ADJUST \
			, SUM , AREA , FROMDATE , TODATE , RATE , PRICE , LAST_FROMDATE , LAST_TODATE , TAX_NO ,TAX_YN \
			, BJ_NM , TYPE , SECTION , SECTION_NAME , TAX_SET, FORM_ADJUST \
			, SIGU_CD , BJ_CD , DEPT_CD , TAX_GUBUN , OBJ_SET \
		    , TAXPAYER_ID , TAXPAYER_SET , OCR_SIGU_CD , OCR_BUSEO_CD , TAX_CD \
		    , LIVE , ADD_SET , ADD_YN , SUM_LASTYEAR , REDUCTION_RATE \
		    , SUBUSEO_CD , REDUCTION_REASON , VAT , TAXNAME \
			, (SELECT DISTINCT(CLASS_NM||' '||SORT_NM||' '||KIND_NM) FROM REF_PURPOSECODE \
            WHERE PURPOSE_CD = CODE AND SECTION = TYPE ) AS PURPOSE_NM \
            , REDUCTION_SUM , REDUCTION_FORM \
            , WSP_YN, WITH_SUM_PRICE \
	       	, POST, ADDR \
	       	, SI, GUN, DORO_NM, BD_NM, BD_DET_NM, BD_BON , BD_BU, ADDR_NEW \
	       	, ROAD_ADDR \
	FROM  ( \
		SELECT ROWNUM R_ID, YEAR, ADMIN_NO, ADMIN_NO2, NAME, PURPOSE_CD, BONBUN, BUBUN , WITH_ADDR1 , SUM_ADJUST \
				, SUM, AREA , FROMDATE, TODATE, RATE, PRICE, LAST_FROMDATE, LAST_TODATE , TAX_NO ,TAX_YN \
				, BJ_NM , TYPE , SECTION , SECTION_NAME , TAX_SET, FORM_ADJUST \
				, SIGU_CD , BJ_CD , DEPT_CD , TAX_GUBUN , OBJ_SET \
		       	, TAXPAYER_ID , TAXPAYER_SET , OCR_SIGU_CD , OCR_BUSEO_CD , TAX_CD \
		       	, LIVE , ADD_SET , ADD_YN , SUM_LASTYEAR , REDUCTION_RATE \
		       	, SUBUSEO_CD , REDUCTION_REASON , VAT , TAXNAME \
		       	, REDUCTION_SUM , REDUCTION_FORM \
		       	, WSP_YN, WITH_SUM_PRICE \
		       	, POST, ADDR \
		       	, SI, GUN, DORO_NM, BD_NM, BD_DET_NM, BD_BON , BD_BU, ADDR_NEW \
				, ROAD_ADDR \
			FROM  ( \
					SELECT DISTINCT (C.ADMIN_NO||T.TAX_NO||C.SEQ), C.ADMIN_NO, C.YEAR, SUBSTR(C.ADMIN_NO, 10, 19) ADMIN_NO2 , A.NAME ,P.PURPOSE_CD \
					       , P.BONBUN , P.BUBUN , P.WITH_ADDR1 , C.SUM_ADJUST , C.SUM \
					       , C.AREA , C.FROMDATE , C.TODATE, C.RATE, C.PRICE \
					       , C.FROMDATE AS LAST_FROMDATE , C.TODATE AS LAST_TODATE , T.TAX_NO , T.TAX_YN  , RD.BJ_NM \
					       , P.TYPE , P.SECTION , RC.NAME SECTION_NAME , P.TAX_SET, C.FORM_ADJUST \
					       , T.SIGU_CD , T.BJ_CD , T.DEPT_CD , T.TAX_GUBUN , T.OBJ_SET \
					       , T.TAXPAYER_ID , T.TAXPAYER_SET , T.OCR_SIGU_CD , T.OCR_BUSEO_CD , T.TAX_CD \
					       , T.LIVE , T.ADD_SET , T.ADD_YN , CI2.SUM_LASTYEAR , C.REDUCTION_RATE \
					       , T.SUBUSEO_CD , C.REDUCTION_REASON , T.VAT \
					       , A.SI, A.GUN, A.DORO_NM, A.BD_NM, A.BD_DET_NM, A.BD_BON , A.BD_BU \
					       , A.SI||' '|| A.GUN||' '|| A.DORO_NM||' '|| A.BD_NM||' '|| A.BD_DET_NM||' '|| A.BD_BON ||' '|| A.BD_BU AS ADDR_NEW \
					       , (SELECT TAXNAME FROM REF_TAXCODE WHERE T.TAX_CD = TAXCODE) TAXNAME \
					       , C.SUM AS REDUCTION_SUM , C.FORM_ADJUST AS REDUCTION_FORM \
					       , P.WSP_YN, P.WITH_SUM_PRICE \
					       , SUBSTR(A.POST,0,3)||'-'||SUBSTR(A.POST,4,3) AS POST, A.ADDR1||' '||DECODE(A.SAN,'1','\uc0b0 ',' ')||A.BON||DECODE(A.BU,NULL,'','-'||A.BU)||' '||A.ADDR2 AS ADDR \
						   , P.ROAD_ADDR||' '||P.ROAD_BON||DECODE(P.ROAD_BU,NULL,'','-'||P.ROAD_BU) AS ROAD_ADDR \
					FROM 	CAL_SUM_INFO C, APPEAL A, PLACE P, CALCULATION_INFO CI , TAXATION_INFO T , REF_DONGCODE RD , REF_COMMONCODE RC \
			            	, (SELECT ADMIN_NO,CAL_SUM_SEQ,MAX(SUM_LASTYEAR) AS SUM_LASTYEAR FROM CALCULATION_INFO GROUP BY ADMIN_NO,CAL_SUM_SEQ) CI2 \
					WHERE C.ADMIN_NO = A.ADMIN_NO \
					AND C.ADMIN_NO = P.ADMIN_NO \
					AND CI.ADMIN_NO = C.ADMIN_NO \
					AND C.SEQ = CI.CAL_SUM_SEQ \
					AND C.ADMIN_NO = T.ADMIN_NO \
					AND C.TAX_SEQ = T.SEQ \
					AND CI2.ADMIN_NO = C.ADMIN_NO \
					AND CI2.CAL_SUM_SEQ = C.SEQ \
					AND P.BJ_CD = RD.BJ_CD \
					AND SUBSTR(P.ADMIN_NO, 5, 2) = RD.SI_CD \
					AND SUBSTR(P.ADMIN_NO, 7, 3) = RD.GU_CD \
					AND P.SECTION <> '2' \
					AND P.SECTION <> '4' \
					AND RC.TYPE = 'use_section' \
					AND T.TAX_GUBUN = RC.CODE \
					AND C.YEAR LIKE ? \
					AND SUBSTR(A.ADMIN_NO,7,3) = ? \
					AND C.YEAR LIKE ? \
					AND P.TYPE LIKE ? \
					AND P.TAX_SET LIKE ? \
					AND DECODE(T.TAX_YN,NULL,'0',T.TAX_YN) LIKE ? \
					AND C.FROMDATE >= ? \
					AND C.TODATE <= ? \
					AND P.PURPOSE_CD LIKE ? \
					AND P.PURPOSE_CD NOT LIKE '7%' \
					AND P.BJ_CD LIKE ? \
					AND P.HJ_CD LIKE ? \
					AND A.NAME LIKE ? \
					AND P.SECTION LIKE ? \
					ORDER BY ADMIN_NO DESC \
					) \
)WHERE R_ID BETWEEN ? AND ? \



// \uc815\uae30\ubd84 \uc870\ud68c \ub9ac\uc2a4\ud2b8 \uce74\uc6b4\ud2b8
Querys.jumyong.junggi.periodicalListCount = \
SELECT COUNT(DISTINCT C.ADMIN_NO||T.TAX_NO||C.SEQ) \
FROM CAL_SUM_INFO C, APPEAL A, PLACE P, CALCULATION_INFO CI , TAXATION_INFO T \
	, REF_DONGCODE RD , REF_COMMONCODE RC \
    ,(SELECT ADMIN_NO,CAL_SUM_SEQ,MAX(SUM_LASTYEAR) AS SUM_LASTYEAR FROM CALCULATION_INFO GROUP BY ADMIN_NO,CAL_SUM_SEQ) CI2 \
WHERE C.ADMIN_NO = A.ADMIN_NO \
AND C.ADMIN_NO = P.ADMIN_NO \
AND CI.ADMIN_NO = C.ADMIN_NO \
AND C.SEQ = CI.CAL_SUM_SEQ \
AND C.ADMIN_NO = T.ADMIN_NO \
AND C.TAX_SEQ = T.SEQ \
AND CI2.ADMIN_NO = C.ADMIN_NO \
AND CI2.CAL_SUM_SEQ = C.SEQ \
AND P.BJ_CD = RD.BJ_CD \
AND SUBSTR(P.ADMIN_NO, 5, 2) = RD.SI_CD \
AND SUBSTR(P.ADMIN_NO, 7, 3) = RD.GU_CD \
AND P.SECTION <> '2' \
AND P.SECTION <> '4' \
AND RC.TYPE = 'use_section' \
AND T.TAX_GUBUN = RC.CODE \
AND C.YEAR LIKE ? \
AND SUBSTR(A.ADMIN_NO,7,3) LIKE ? \
AND C.YEAR LIKE ? \
AND P.TYPE LIKE ? \
AND P.TAX_SET LIKE ? \
AND DECODE(T.TAX_YN,NULL,'0',T.TAX_YN) LIKE ? \
AND C.FROMDATE >= ? \
AND C.TODATE <= ? \
AND P.PURPOSE_CD LIKE ? \
AND P.PURPOSE_CD NOT LIKE '7%' \
AND P.BJ_CD LIKE ? \
AND P.HJ_CD LIKE ? \
AND A.NAME LIKE ? \
AND P.SECTION LIKE ? \


// \uc815\uae30\ubd84 \uc870\ud68c \ub9ac\uc2a4\ud2b8
Querys.jumyong.junggi.periodicalList_old = \
SELECT R_ID,SUBSTR(ADMIN_NO,10,19) AS ADMIN_NO2,ADMIN_NO AS ADMIN_NO, YEAR, TYPE_NAME, NAME, BJ_NM, BONBUN, BUBUN, PURPOSE_CD, SUM_LASTYEAR, SUM_YEAR, SUM_ADJUST,  TAX_SET_NAME,CHECK_YN,CHECK_NAME \
FROM \
( \
    SELECT ROWNUM AS R_ID,ADMIN_NO, YEAR, TYPE_NAME, NAME, BJ_NM, BONBUN, BUBUN, PURPOSE_CD, SUM_LASTYEAR, SUM_YEAR, SUM_ADJUST,  TAX_SET_NAME,CHECK_YN,CHECK_NAME \
    FROM \
    (      \
          SELECT  DISTINCT(AB.ADMIN_NO),C.YEAR, R.NAME AS TYPE_NAME, A.NAME, R3.BJ_NM, P.BONBUN, P.BUBUN, P.PURPOSE_CD \
          , C.SUM_LASTYEAR, C.SUM_YEAR, C.SUM_ADJUST, R4.NAME AS TAX_SET_NAME,AB.CHECK_YN,R5.NAME AS CHECK_NAME \
          FROM ADMIN_BASE AB \
			  JOIN APPEAL A ON A.ADMIN_NO = AB.ADMIN_NO \
	  		  JOIN PLACE P ON P.ADMIN_NO = AB.ADMIN_NO \
		      JOIN (	\
		        SELECT  ADMIN_NO ,YEAR, SUM(SUM_LASTYEAR) AS SUM_LASTYEAR, SUM(SUM_YEAR) AS SUM_YEAR, SUM(SUM_ADJUST) AS SUM_ADJUST \
			    FROM CALCULATION_INFO \
			    GROUP BY ADMIN_NO,YEAR \
		      )C ON AB.ADMIN_NO = C.ADMIN_NO \
		      JOIN REF_COMMONCODE R 	  ON P.TYPE = R.CODE AND R.TYPE ='use_type' \
		      JOIN REF_DONGCODE R3 ON P.BJ_CD = R3. BJ_CD AND R3.GU_CD = '680' \
		      JOIN REF_COMMONCODE  R4  ON P.TAX_SET = R4. CODE  AND R4.TYPE = 'taxation_section' \
              JOIN REF_COMMONCODE  R5  ON AB.CHECK_YN = R5.CODE AND R5.TYPE = 'check_type'    \
	      WHERE P.SECTION = '1' AND P.MUL_FROMDATE <= ? AND P.MUL_TODATE >=? \
          AND C.YEAR LIKE ? \
          AND P.TYPE like ? \
          AND AB.CHECK_YN like ? \
          AND P.TAX_SET like ? \
          AND P.PURPOSE_CD like ? \
          AND ( SUBSTR(AB.ADMIN_NO,10,19) like ? OR SUBSTR(REQ_NO,10,19)  like ?) \
          AND A.NAME like ? \
          AND P.BJ_CD like ? \
          AND P.HJ_CD like ? \
          AND P.BONBUN like ? \
          AND DECODE(P.BUBUN,NULL,' ',P.BUBUN) like ? \
    ) \
)WHERE R_ID > (?-1)*? AND ROWNUM<= ?  


Querys.jumyong.junggi.periodicalList3 = \
SELECT R_ID, YEAR, ADMIN_NO, ADMIN_NO2, SUM_ADJUST, NAME, BJ_NM, BONBUN, BUBUN, CLASS_NM, TAX_SET_NAME , TYPE_NAME , PURPOSE_CD, AREA_AFTER \
 FROM ( \
SELECT ROWNUM R_ID, YEAR, ADMIN_NO, ADMIN_NO2, SUM_ADJUST, NAME, BJ_NM, BONBUN, BUBUN, CLASS_NM, TAX_SET_NAME , TYPE_NAME , PURPOSE_CD, AREA_AFTER \
  FROM ( \
SELECT C.YEAR, C.ADMIN_NO, SUBSTR(C.ADMIN_NO, 10, 19) ADMIN_NO2, C.SUM SUM_ADJUST, A.NAME, RD.BJ_NM, P.BONBUN, P.BUBUN \
       , RP.CLASS_NM, RC1.NAME TAX_SET_NAME, RC2.NAME TYPE_NAME, P.PURPOSE_CD, C2.AREA_AFTER \
  FROM CAL_SUM_INFO C, APPEAL A, PLACE P, REF_DONGCODE RD, REF_PURPOSECODE RP, REF_COMMONCODE RC1, REF_COMMONCODE RC2 \
       , (SELECT ADMIN_NO,SUM(AREA_AFTER) AS AREA_AFTER FROM CALCULATION_INFO \
          WHERE USE_SECTION = 2 GROUP BY ADMIN_NO ) C2 \
 WHERE C.ADMIN_NO = A.ADMIN_NO \
   AND C.ADMIN_NO = P.ADMIN_NO  \
   AND P.BJ_CD = RD.BJ_CD \
   AND SUBSTR(P.ADMIN_NO, 5, 2) = RD.SI_CD \
   AND SUBSTR(P.ADMIN_NO, 7, 3) = RD.GU_CD \
   AND P.PURPOSE_CD = RP.CODE \
   AND P.TYPE = RP.SECTION \
   AND P.TAX_SET = RC1.CODE \
   AND RC1.TYPE = 'taxation_section' \
   AND P.TYPE = RC2.CODE \
   AND RC2.TYPE = 'use_type' \
   AND C2.ADMIN_NO = C.ADMIN_NO \
   AND SUBSTR(C.ADMIN_NO, 7, 3) = ? \
   AND P.SECTION = 1 \
   AND C.YEAR = ? \
   AND P.TYPE LIKE ? \
   AND P.TAX_SET LIKE ? \
   AND P.BJ_CD LIKE ? \
   AND P.BONBUN LIKE ? \
   AND DECODE(P.BUBUN, NULL, ' ', P.BUBUN) LIKE ? \
   AND SUBSTR(C.ADMIN_NO, 10, 19)  LIKE ? \
   AND A.NAME LIKE ? \
   AND P.PURPOSE_CD LIKE ? \
GROUP BY C.YEAR,C.ADMIN_NO, SUBSTR(C.ADMIN_NO, 10, 19), C.SUM, A.NAME, RD.BJ_NM, P.BONBUN, P.BUBUN  \
       , RP.CLASS_NM, RC1.NAME, RC2.NAME, P.PURPOSE_CD, C2.AREA_AFTER \
       ) ) \
 WHERE R_ID > (?-1)*? AND ROWNUM<= ?





Querys.jumyong.junggi.periodicalList_old2 = \
SELECT R_ID, ADMIN_NO2, YEAR, ADMIN_NO, TAX_NO,SUM_LASTYEAR, SUM_ADJUST,NAME, BJ_NM,BONBUN,AREA_AFTER,  \
PURPOSE_CD,CLASS_NM,BJ_CD,TAX_YN,TYPE,TAX_SET_NAME,TYPE_NAME,TAX_YN_NAME  FROM  \
(   \
SELECT ROWNUM AS R_ID, ADMIN_NO2, YEAR, ADMIN_NO, TAX_NO,SUM_LASTYEAR, SUM_ADJUST,NAME, BJ_NM,BONBUN,AREA_AFTER,  \
PURPOSE_CD,CLASS_NM,BJ_CD,TAX_YN,TYPE,TAX_SET_NAME,TYPE_NAME,TAX_YN_NAME FROM   \
  ( SELECT  DISTINCT(SUBSTR(T1.ADMIN_NO,10,19)) AS ADMIN_NO2,  SUBSTR(T1.TAX_YM,0,4) AS YEAR,T1.ADMIN_NO,T1.TAX_NO,T2.BONSE AS SUM_LASTYEAR  \
  ,C.SUM AS SUM_ADJUST,A.NAME, R2.BJ_NM, P.BONBUN  ,C2.AREA_AFTER,P.PURPOSE_CD,RP.CLASS_NM,P.BJ_CD,T1.TAX_YN  \
  ,P.TYPE,R1.NAME AS TAX_SET_NAME, R.NAME AS TYPE_NAME   ,R3.NAME AS TAX_YN_NAME \
      FROM TAXATION_INFO T1    \
      JOIN APPEAL A ON A.ADMIN_NO = T1.ADMIN_NO  \
      JOIN PLACE P ON P.ADMIN_NO = T1.ADMIN_NO   \
      JOIN (   \
        SELECT ADMIN_NO,SUM(AREA_AFTER) AS AREA_AFTER FROM CALCULATION_INFO   \
          WHERE USE_SECTION = 2 GROUP BY ADMIN_NO   \
      ) C2 ON C2.ADMIN_NO = T1.ADMIN_NO   \
      JOIN REF_COMMONCODE R 	  ON P.TYPE = R.CODE AND R.TYPE ='use_type'    \
      JOIN REF_COMMONCODE R1 ON P.TAX_SET = R1. CODE  AND R1.TYPE = 'taxation_section'   \
      JOIN REF_DONGCODE R2 ON P.BJ_CD = R2. BJ_CD AND R2.GU_CD = ?   AND R2.SI_CD = SUBSTR(C2.ADMIN_NO,5,2) \
      JOIN REF_COMMONCODE R3 ON DECODE(T1.TAX_YN,NULL,'0',T1.TAX_YN) = R3.CODE AND R3.TYPE = 'taxation_yn'  \
      LEFT OUTER JOIN TAXATION_INFO T2 ON T1.ADMIN_NO = T2.ADMIN_NO AND SUBSTR(T1.TAX_YM,0,4) = SUBSTR(T2.TAX_YM,0,4) +1      \
      JOIN CAL_SUM_INFO C ON C.TAX_SEQ = T1.SEQ AND C.SUM>0     \
      LEFT JOIN REF_PURPOSECODE RP	 ON P.PURPOSE_CD = RP.CODE AND RP.SECTION = P.TYPE   \
    WHERE SUBSTR(T1.TAX_YM,0,4) LIKE ?   \
    AND P.TYPE LIKE ?   \
    AND P.TAX_SET LIKE ?    \
    AND DECODE(T1.TAX_YN,NULL,'0',T1.TAX_YN) LIKE ?   \
    AND P.BJ_CD LIKE ?   \
    AND P.BONBUN LIKE ?    \
    AND DECODE(P.BUBUN,NULL,' ',P.BUBUN) LIKE ?    \
    AND SUBSTR(T1.ADMIN_NO,10,19) LIKE ?   \
    AND A.NAME LIKE ?    \
    AND P.PURPOSE_CD LIKE ?    \
    )  \
)WHERE R_ID > (?-1)*? AND ROWNUM<= ?


// \uc815\uae30\ubd84 \uc870\ud68c \ub9ac\uc2a4\ud2b8 \uce74\uc6b4\ud2b8
Querys.jumyong.junggi.periodicalListCount_old = \
SELECT  COUNT(DISTINCT(AB.ADMIN_NO))\
 FROM ADMIN_BASE AB \
			  JOIN APPEAL A ON A.ADMIN_NO = AB.ADMIN_NO \
	  		  JOIN PLACE P ON P.ADMIN_NO = AB.ADMIN_NO \
		      JOIN CALCULATION_INFO C ON AB.ADMIN_NO = C.ADMIN_NO \
		      JOIN REF_COMMONCODE R 	  ON P.TYPE = R.CODE AND R.TYPE ='use_type' \
		      JOIN REF_DONGCODE R3 ON P.BJ_CD = R3. BJ_CD AND R3.GU_CD = '680' \
		      JOIN REF_COMMONCODE  R4  ON P.TAX_SET = R4. CODE  AND R4.TYPE = 'taxation_section' \
              JOIN REF_COMMONCODE  R5  ON AB.CHECK_YN = R5.CODE AND R5.TYPE = 'check_type'    \
	      WHERE P.SECTION = '1' AND P.MUL_FROMDATE <= ? AND P.MUL_TODATE >=? \
          AND C.YEAR LIKE ? \
          AND P.TYPE like ? \
          AND AB.CHECK_YN like ? \
          AND P.TAX_SET like ? \
          AND P.PURPOSE_CD like ? \
          AND ( SUBSTR(AB.ADMIN_NO,10,19) like ? OR SUBSTR(REQ_NO,10,19)  like ?) \
          AND A.NAME like ? \
          AND P.BJ_CD like ? \
          AND P.HJ_CD like ? \
          AND P.BONBUN like ? \
          AND DECODE(P.BUBUN,NULL,' ',P.BUBUN) like ? \
          
          
          
          

// \uc815\uae30\ubd84 \uc870\ud68c \ub9ac\uc2a4\ud2b8 \uce74\uc6b4\ud2b8
Querys.jumyong.junggi.periodicalListCount_old2 = \
SELECT  COUNT(DISTINCT(SUBSTR(T1.ADMIN_NO,10,19))) \
      FROM TAXATION_INFO T1    \
      JOIN APPEAL A ON A.ADMIN_NO = T1.ADMIN_NO  \
      JOIN PLACE P ON P.ADMIN_NO = T1.ADMIN_NO   \
      JOIN (   \
        SELECT ADMIN_NO,SUM(AREA_AFTER) AS AREA_AFTER FROM CALCULATION_INFO   \
          WHERE USE_SECTION = 2 GROUP BY ADMIN_NO   \
      ) C2 ON C2.ADMIN_NO = T1.ADMIN_NO   \
      JOIN REF_COMMONCODE R 	  ON P.TYPE = R.CODE AND R.TYPE ='use_type'    \
      JOIN REF_COMMONCODE R1 ON P.TAX_SET = R1. CODE  AND R1.TYPE = 'taxation_section'   \
      JOIN REF_DONGCODE R2 ON P.BJ_CD = R2. BJ_CD AND R2.GU_CD = ?   \
      LEFT OUTER JOIN TAXATION_INFO T2 ON T1.ADMIN_NO = T2.ADMIN_NO AND T1.YEAR = T2.YEAR +1   \
      JOIN CAL_SUM_INFO C ON C.ADMIN_NO = T1.ADMIN_NO AND C.YEAR = T1.YEAR AND C.SUM>0   \
      LEFT JOIN REF_PURPOSECODE RP	 ON P.PURPOSE_CD = RP.CODE AND RP.SECTION = P.TYPE   \
    WHERE SUBSTR(T1.TAX_YM,0,4) LIKE ?  \
    AND P.TYPE LIKE ?  \
    AND P.TAX_SET LIKE ?   \
    AND DECODE(T1.TAX_YN,NULL,'0',T1.TAX_YN) LIKE ?  \
    AND P.BJ_CD LIKE ?  \
    AND P.BONBUN LIKE ?   \
    AND DECODE(P.BUBUN,NULL,' ',P.BUBUN) LIKE ?   \
    AND SUBSTR(T1.ADMIN_NO,10,19) LIKE ?  \
    AND A.NAME LIKE ?   \
    AND P.PURPOSE_CD LIKE ?   \      
          
          

Querys.jumyong.junggi.periodicalListCount_old3 = \
SELECT COUNT(*) FROM \
( \
SELECT DISTINCT(SUBSTR(T1.ADMIN_NO,10,19)) AS ADMIN_NO2,T1.TAX_NO  ,C.SUM AS SUM_ADJUST \
      FROM TAXATION_INFO T1    \
      JOIN APPEAL A ON A.ADMIN_NO = T1.ADMIN_NO  \
      JOIN PLACE P ON P.ADMIN_NO = T1.ADMIN_NO   \
      JOIN (   \
        SELECT ADMIN_NO,SUM(AREA_AFTER) AS AREA_AFTER FROM CALCULATION_INFO   \
          WHERE USE_SECTION = 2 GROUP BY ADMIN_NO   \
      ) C2 ON C2.ADMIN_NO = T1.ADMIN_NO   \
      JOIN REF_COMMONCODE R 	  ON P.TYPE = R.CODE AND R.TYPE ='use_type'    \
      JOIN REF_COMMONCODE R1 ON P.TAX_SET = R1. CODE  AND R1.TYPE = 'taxation_section'   \
      JOIN REF_DONGCODE R2 ON P.BJ_CD = R2. BJ_CD AND R2.GU_CD = ?   \
      LEFT OUTER JOIN TAXATION_INFO T2 ON T1.ADMIN_NO = T2.ADMIN_NO AND T1.YEAR = T2.YEAR +1   \
      JOIN CAL_SUM_INFO C ON C.TAX_SEQ = T1.SEQ AND C.SUM>0     \
      LEFT JOIN REF_PURPOSECODE RP	 ON P.PURPOSE_CD = RP.CODE AND RP.SECTION = P.TYPE   \
    WHERE SUBSTR(T1.TAX_YM,0,4) LIKE ?  \
    AND P.TYPE LIKE ?   \
    AND P.TAX_SET LIKE ?    \
    AND DECODE(T1.TAX_YN,NULL,'0',T1.TAX_YN) LIKE ?   \
    AND P.BJ_CD LIKE ?   \
    AND P.BONBUN LIKE ?    \
    AND DECODE(P.BUBUN,NULL,' ',P.BUBUN) LIKE ?    \
    AND SUBSTR(T1.ADMIN_NO,10,19) LIKE ?   \
    AND A.NAME LIKE ?    \
    AND P.PURPOSE_CD LIKE ?  \
)         
          
          
          

//\ubd80\uacfc\uc815\ubcf4 \ub9ac\uc2a4\ud2b8
Querys.jumyong.junggi.impositionInfoList = \
SELECT R_ID,ADMIN_NO, CSEQ, YEAR, AREA_AFTER, PRICE, RATE, FROMDATE, TODATE, SUM_LASTYEAR, SUM_YEAR \
                , SUM_ADJUST, ADJUSTMENT, FORM, FORM_ADJUST, PERIOD,USE_SECTION , SUM \
FROM \
( \
	SELECT ROWNUM AS R_ID,ADMIN_NO, CSEQ, YEAR, AREA_AFTER, PRICE, RATE, FROMDATE, TODATE, SUM_LASTYEAR, SUM_YEAR \
                , SUM_ADJUST, ADJUSTMENT, FORM, FORM_ADJUST, PERIOD,USE_SECTION , SUM \
	FROM \
	( \
		SELECT	A.ADMIN_NO, A.SEQ AS CSEQ, A.YEAR, A.AREA_AFTER, A.PRICE, A.RATE, A.FROMDATE, A.TODATE, A.SUM_LASTYEAR, A.SUM_YEAR \
				, A.SUM_ADJUST, A.ADJUSTMENT, A.FORM, A.FORM_ADJUST, A.PERIOD, A.USE_SECTION ,B.SUM \
		FROM CALCULATION_INFO A, CAL_SUM_INFO B \
		WHERE A.CAL_SUM_SEQ = B.SEQ \
		AND A.ADMIN_NO = ? \
		AND A.YEAR = ? \
	) \
)WHERE R_ID > (?-1)*? AND ROWNUM<= ? \
ORDER BY YEAR DESC


//\ubd80\uacfc\uc815\ubcf4 \ub9ac\uc2a4\ud2b8
Querys.jumyong.junggi.impositionInfoByCalSumList = \
SELECT R_ID,ADMIN_NO, CSEQ, YEAR, AREA_AFTER, PRICE, RATE, FROMDATE, TODATE, SUM_LASTYEAR, SUM_YEAR \
                , SUM_ADJUST, ADJUSTMENT, FORM, FORM_ADJUST, PERIOD,USE_SECTION \
FROM \
( \
	SELECT ROWNUM AS R_ID,ADMIN_NO, CSEQ, YEAR, AREA_AFTER, PRICE, RATE, FROMDATE, TODATE, SUM_LASTYEAR, SUM_YEAR \
                , SUM_ADJUST, ADJUSTMENT, FORM, FORM_ADJUST, PERIOD,USE_SECTION \
	FROM \
	( \
		SELECT ADMIN_NO,SEQ AS CSEQ, YEAR, AREA_AFTER,PRICE, RATE, FROMDATE, TODATE, SUM_LASTYEAR, SUM_YEAR \
		, SUM_ADJUST, ADJUSTMENT, FORM, FORM_ADJUST, PERIOD,USE_SECTION \
		FROM CALCULATION_INFO  \
		WHERE CAL_SUM_SEQ = ? \
	) \
)WHERE R_ID > (?-1)*? AND ROWNUM<= ? \
ORDER BY YEAR DESC


//\ubd80\uacfc\uc815\ubcf4 \ub9ac\uc2a4\ud2b8 - \uc218\uc2dc
Querys.jumyong.junggi.impositionInfoList2 = \
		SELECT ADMIN_NO,SEQ AS CSEQ, YEAR, AREA_AFTER,PRICE, RATE, FROMDATE, TODATE, SUM_LASTYEAR, SUM_YEAR \
		, SUM_ADJUST, ADJUSTMENT, FORM, FORM_ADJUST, PERIOD,USE_SECTION \
		FROM CALCULATION_INFO  \
		WHERE SEQ = ? \


//\ubd80\uacfc\uc815\ubcf4 \ub9ac\uc2a4\ud2b8 \uce74\uc6b4\ud2b8
Querys.jumyong.junggi.impositionInfoListCount = \
SELECT COUNT(T.ADMIN_NO)  FROM TAXATION_INFO T 	JOIN CALCULATION_INFO C ON T.ADMIN_NO = C.ADMIN_NO AND T.YEAR = C.YEAR \
JOIN REF_COMMONCODE R    ON T.TAX_YN = R.CODE AND R.TYPE = 'taxation_yn'  WHERE T.ADMIN_NO = ?

//\ubd80\uacfc\uc815\ubcf4 \ub144\ub3c4\ubcc4 \uac1c\ubcc4 \uc815\ubcf4
Querys.jumyong.junggi.impositionInfo = \
SELECT  C.SEQ,  C.YEAR,  C.PRICE,  C.AREA_AFTER,  C.RATE,  C.FROMDATE,  C.TODATE,  C.SUM_LASTYEAR \
		,C.SUM_YEAR,  C.SUM_ADJUST,  C.ADJUSTMENT,  C.FORM,  C.FORM_ADJUST,  C.PERIOD, C.FIRST_SEQ, C.USE_SECTION, R.NAME \
		,T.TAX_DATE, T.INDATE, T.OVERDATE, T.OVERTAX \
		,T.SIGU_CD , T.BJ_CD, T.TAX_NO, T.DEPT_CD, T.TAX_CD, T.TAX_GUBUN, T.OBJ_SET, T.TAXPAYER_ID \
 		,T.TAXPAYER_SET, T.OCR_SIGU_CD, T.OCR_BUSEO_CD, T.SEQ TSEQ , C.CAL_SUM_SEQ , T.TAX_YN \
 		, CI.SUM , T.LIVE , RP.CHECK_YN , RP.YOYUL , RP.MOMEY \
FROM CALCULATION_INFO C ,REF_COMMONCODE R ,TAXATION_INFO T , CAL_SUM_INFO CI , PLACE PL, REF_PURPOSECODE RP \
WHERE R.CODE = T.TAX_GUBUN \
AND R.TYPE = 'use_section' \
AND C.ADMIN_NO = T.ADMIN_NO(+) \
AND C.CAL_SUM_SEQ = T.SEQ(+) \
AND C.CAL_SUM_SEQ = CI.SEQ \
AND C.ADMIN_NO = PL.ADMIN_NO \
AND PL.PURPOSE_CD = RP.CODE \
AND C.SEQ = ?

//\ubd80\uacfc\uc815\ubcf4 \uc791\ub144\ub3c4 \uc810\uc6a9\ub8cc
Querys.jumyong.junggi.sum_lastyear = \
SELECT SUM_ADJUST,FROMDATE,TODATE FROM	\
(	\
	SELECT SUM_ADJUST, FROMDATE,TODATE, YEAR FROM CALCULATION_INFO WHERE ADMIN_NO = ? AND YEAR = ?	\
	UNION \
	SELECT 0 AS SUM_ADJUST,' ' AS FROMDATE, ' ' AS TODATE, '-1' AS YEAR FROM DUAL	\
	ORDER BY YEAR DESC	\
) WHERE ROWNUM = 1 

//\uc0b0\ucd9c\uc815\ubcf4 \uc785\ub825\ud6c4 SEQ \uad6c\ud558\uae30
Querys.jumyong.junggi.getProductSeq = \
SELECT SEQ FROM CALCULATION_INFO WHERE ADMIN_NO = ? AND YEAR = ? AND ROWNUM = 1

//\ubd80\uacfc\uc815\ubcf4 \uac00\uc7a5 \ub098\uc911 \uc785\ub825\ub41c YEAR
Querys.jumyong.junggi.getLastYear = \
SELECT DECODE(MAX(T.YEAR),NULL,99999999,(MAX(T.YEAR))) AS LASTYEAR	FROM TAXATION_INFO T 	JOIN CALCULATION_INFO C ON T.ADMIN_NO = C.ADMIN_NO AND T.YEAR = C.YEAR \
WHERE T.ADMIN_NO = ?

//\ubd80\uacfc \ubbf8\ubd80\uacfc \uc5ec\ubd80
Querys.jumyong.junggi.getTaxYn = \
SELECT MAX(TAX_YN) AS TAX_YN FROM \
   (   SELECT TAX_YN FROM TAXATION_INFO WHERE SEQ = ? \
      UNION \
      SELECT '0' AS TAX_YN FROM DUAL \
   )
   
//\ub144\ub3c4\ubcc4 \ud569\uacc4 \ub9ac\uc2a4\ud2b8
Querys.jumyong.junggi.ImpositionSumListByYear = \
SELECT R_ID, ADMIN_NO, YEAR,USE_SECTIONNAME,USE_SECTION, SUM_LASTYEAR,SUM_YEAR,SUM_ADJUST,AREA_AFTER, SEQ \
FROM \
( \
  SELECT ROWNUM AS R_ID, ADMIN_NO, YEAR,NAME AS USE_SECTIONNAME,USE_SECTION,  SUM_LASTYEAR,SUM_YEAR,SUM_ADJUST,AREA_AFTER, SEQ \
  FROM \
  ( \
    SELECT * FROM (      \
      SELECT ADMIN_NO,YEAR,USE_SECTION, SUM(SUM_LASTYEAR) AS SUM_LASTYEAR, SUM(SUM_YEAR) AS SUM_YEAR \
      , SUM(SUM_ADJUST) AS SUM_ADJUST, SUM(AREA_AFTER) AS AREA_AFTER, NULL AS SEQ \
      FROM CALCULATION_INFO  \
      WHERE ADMIN_NO = ? AND USE_SECTION = '1' \
      GROUP BY ADMIN_NO, YEAR, USE_SECTION \
        UNION ALL \
      SELECT ADMIN_NO,YEAR,USE_SECTION, SUM_LASTYEAR , SUM_YEAR , SUM_ADJUST, AREA_AFTER, SEQ \
      FROM CALCULATION_INFO  \
      WHERE ADMIN_NO = ? AND USE_SECTION = '2'     \
    ) JOIN REF_COMMONCODE R ON R.CODE = USE_SECTION AND R.TYPE = 'use_section' \
    ORDER BY YEAR DESC \
  ) \
)WHERE R_ID > (?-1)*? AND ROWNUM<= ? \
ORDER BY YEAR DESC

//\ub144\ub3c4\ubcc4 \ud569\uacc4 \ub9ac\uc2a4\ud2b8\uce74\uc6b4\ud2b8
Querys.jumyong.junggi.ImpositionSumListByYearCount = \
SELECT COUNT(YEAR) FROM( SELECT YEAR    FROM CALCULATION_INFO \
WHERE ADMIN_NO = ? GROUP BY YEAR  )

//\uba74\uc801 \ud569\uacc4
Querys.jumyong.junggi.getProductAreaSum = \
SELECT SUM(AREA_AFTER) FROM CALCULATION_INFO WHERE FIRST_SEQ=? AND USE_SECTION = '2'
   

//\uc815\uae30\ubd84 \uc120\ud0dd \ub9ac\uc2a4\ud2b8
Querys.jumyong.productjunggi_addList_old = \
SELECT A.*, DECODE(C.SEQ,NULL,'N','Y')AS CAL_YN,C.SEQ	\
FROM	\
(	\
SELECT A.ADMIN_NO,C.SEQ,C.FIRST_SEQ,A.YEAR,C.YEAR AS CAL_YEAR,A.AREA_AFTER,C.SUM_ADJUST,C.USE_SECTION, R1.NAME  \
FROM (  \
  SELECT C.ADMIN_NO, SEQ,YEAR,AREA AS AREA_AFTER FROM CALCULATION_INFO C JOIN  \
  (  \
          SELECT FIRST_SEQ,SUM(AREA_AFTER) AS AREA FROM CALCULATION_INFO  \
          WHERE ADMIN_NO = ? AND USE_SECTION = '2'  \
		  GROUP BY FIRST_SEQ  \
  ) C2  ON C.SEQ = C2.FIRST_SEQ  \
)A JOIN calculation_info C ON A.SEQ = C.FIRST_SEQ AND C.YEAR = ? AND C.AREA_AFTER > 0  \
JOIN REF_COMMONCODE R1 ON R1.CODE = C.USE_SECTION AND R1.TYPE = 'use_section'   \
) A  \
LEFT JOIN CALCULATION_INFO C ON A.ADMIN_NO = C.ADMIN_NO AND C.YEAR=? \
AND A.FIRST_SEQ = C.FIRST_SEQ AND C.USE_SECTION = '1'


//\uc815\uae30\ubd84 \uc120\ud0dd \ub9ac\uc2a4\ud2b8
Querys.jumyong.productjunggi_addList = \
SELECT AA.*, DECODE(C.SEQ,NULL,'N','Y')AS CAL_YN,C.SEQ,R1.NAME AS NAME	  FROM  \
( \
SELECT ADMIN_NO, C.SEQ,FIRST_SEQ,S.YEAR, C.YEAR AS CAL_YEAR,S.AREA AS AREA_AFTER , \
CASE \
WHEN A.COUNT1 >= 2 THEN '2' \
WHEN A.COUNT1 =1 THEN USE_SECTION \
END AS USE_SECTION \
,S.AREA,C.SUM_ADJUST \
FROM CALCULATION_INFO C \
JOIN \
( \
    SELECT FIRST_SEQ,COUNT(SEQ) AS COUNT1 \
    FROM CALCULATION_INFO WHERE ADMIN_NO =  ? AND YEAR = ?  \
    GROUP BY FIRST_SEQ \
)A ON C.FIRST_SEQ = A.FIRST_SEQ AND C.AREA_AFTER > 0 AND C.YEAR = ? \
JOIN \
( \
  SELECT C2.FIRST_SEQ, C.ADMIN_NO, SEQ,YEAR,AREA  FROM CALCULATION_INFO C JOIN   \
  (   \
          SELECT FIRST_SEQ,SUM(AREA_AFTER) AS AREA FROM CALCULATION_INFO   \
          WHERE ADMIN_NO = ? AND USE_SECTION = '2'   \
		  GROUP BY FIRST_SEQ   \
  ) C2  ON C.SEQ = C2.FIRST_SEQ  \
)S ON S.FIRST_SEQ = A.FIRST_SEQ  \
)AA  \
LEFT JOIN CALCULATION_INFO C ON AA.ADMIN_NO = C.ADMIN_NO AND C.YEAR= ? \
AND AA.FIRST_SEQ = C.FIRST_SEQ AND C.USE_SECTION = '1' \
JOIN REF_COMMONCODE R1 ON R1.CODE = AA.USE_SECTION AND R1.TYPE = 'use_section' 


//\uc0b0\ucd9c_\ubd80\uacfc \ud14c\uc774\ube14 SEQ \uc5bb\uae30
Querys.jumyong.getcal_tax_seq = \
SELECT MAX(CAL_SUM_SEQ) \
FROM \
( \
  SELECT CAL_SUM_SEQ FROM CALCULATION_INFO WHERE ADMIN_NO = ? AND YEAR = ? \
  AND USE_SECTION = '1' AND ROWNUM = 1 \
  UNION \
  SELECT 0 AS CAL_SUM_SEQ FROM DUAL \
)


//\ub144\ub3c4\ubcc4 \ud569\uacc4 \ub9ac\uc2a4\ud2b8
Querys.jumyong.junggi.cal_sum_infoList = \
SELECT R_ID, ADMIN_NO, SEQ, YEAR, AREA, SUM_ADJUST, SUM, USE_SECTION, USE_SECTIONNAME ,REDUCTION_RATE, REDUCTION_REASON, PERCENT_RATE, PERCENT_REASON, TAX_SET_NAME \
FROM  \
(  \
	SELECT ROWNUM AS R_ID, ADMIN_NO, SEQ, YEAR, AREA, SUM_ADJUST, SUM, USE_SECTION, USE_SECTIONNAME ,REDUCTION_RATE, REDUCTION_REASON, PERCENT_RATE, PERCENT_REASON, TAX_SET_NAME \
  	FROM  \
  		(  \
	    SELECT C.ADMIN_NO, C.SEQ, C.YEAR, C.AREA, C.SUM_ADJUST, C.SUM, C.USE_SECTION, R.NAME AS USE_SECTIONNAME,C.REDUCTION_RATE, C.REDUCTION_REASON, C.PERCENT_RATE, C.PERCENT_REASON \
	    		,R2.NAME AS TAX_SET_NAME \
	    FROM CAL_SUM_INFO C \
	    JOIN TAXATION_INFO T ON C.ADMIN_NO = T.ADMIN_NO AND C.SEQ = T.SEQ \
	    JOIN REF_COMMONCODE R ON T.TAX_GUBUN = R.CODE AND R.TYPE = 'use_section'  \
	    JOIN PLACE P ON P.ADMIN_NO = C.ADMIN_NO \
	    LEFT JOIN REF_COMMONCODE R2 ON R2.CODE = P.TAX_SET AND R2.TYPE = 'taxation_section' \
	    WHERE C.ADMIN_NO =? \
	    AND C.YEAR = ? \
	    ORDER BY C.YEAR DESC \
  		)  \
)WHERE R_ID between ? and ? \
ORDER BY YEAR DESC

//\ub144\ub3c4\ubcc4 \ud569\uacc4 \ub9ac\uc2a4\ud2b8 \uac1c\uc218
Querys.jumyong.junggi.cal_sum_infoListCount = \
    SELECT COUNT(*) FROM CAL_SUM_INFO WHERE ADMIN_NO = ? AND YEAR = ?
    
//CAL_SUM_INFO \ud14c\uc774\ube14 \uba74\uc801 \ucd94\uac00 \uc5c5\ub370\uc774\ud2b8
Querys.jumyong.junggi.cal_sum_addUpdate = \
UPDATE CAL_SUM_INFO SET AREA = ? \
, SUM_ADJUST = ? \
, VAT = TRUNC(? *(100-REDUCTION_RATE)/100/100,0)*10  \
, SUM = TRUNC(? *(100-REDUCTION_RATE)/100/100,0)*100  \
, FORM_ADJUST = ? \
WHERE SEQ = ?


//CAL_SUM_INFO \uac10\uba74 \uc785\ub825(\uc218\uc815)
Querys.jumyong.junggi.cal_sum_reductionUpdate = \
UPDATE CAL_SUM_INFO SET REDUCTION_RATE = ? , REDUCTION_REASON = ? , SUM = TRUNC(SUM_ADJUST * (100-?)/10000,0)*100 \
, VAT = TRUNC(SUM_ADJUST * (100-?)/10000,0)*10 \
WHERE SEQ = ?

//SUM_ADJUST, AREA_AFTER \ud569\uacc4 SUM_SEQ\ubcc4
Querys.jumyong.junggi.getSumBysumseq = \
SELECT SUM(SUM_ADJUST) AS SUM_ADJUST,SUM(AREA_AFTER) AS AREA_AFTER FROM CALCULATION_INFO WHERE CAL_SUM_SEQ=?

//SUM_ADJUST, AREA_AFTER \ud569\uacc4 SUM_SEQ\ubcc4
Querys.jumyong.junggi.getReduction = \
SELECT YEAR, SEQ,REDUCTION_RATE, REDUCTION_REASON FROM CAL_SUM_INFO WHERE SEQ = ? AND ADMIN_NO = ?

//\uc815\uae30\ubd84 \uac10\uc18c \uba74\uc801 \uc788\ub294\uc9c0 \uccb4\ud06c
Querys.jumyong.junggi.getCountSameCalculation = \
SELECT COUNT(ADMIN_NO) FROM CALCULATION_INFO WHERE FIRST_SEQ = ? AND YEAR = ?

//calculation_temp_insert
Querys.jumyong.junggi.junggiCalculationTempInsert = \
INSERT INTO CALCULATION_INFO (ADMIN_NO,YEAR,SEQ,AREA_AFTER,RATE,SUM_LASTYEAR,FROMDATE,TODATE,UP_DATE,PERIOD,USE_SECTION, \
FIRST_SEQ,CAL_SUM_SEQ,PRICE,SUM_YEAR,VAT,FORM_ADJUST,FORM) \
SELECT ADMIN_NO,?,CALCULATION_SEQ.NEXTVAL,A.AREA_AFTER,DECODE(CHECK_YN,1,MOMEY,YOYUL) AS RATE, \
CI.SUM_ADJUST*12/CI.PERIOD*A.AREA_AFTER/CI.AREA_AFTER AS SUM_ADJUST, \
?,?,?,'12','1',A.FIRST_SEQ,?,0,0,0,' ',' ' \
 FROM  \
( \
SELECT FIRST_SEQ,SUM(AREA_AFTER) AS AREA_AFTER FROM CALCULATION_INFO \
WHERE ADMIN_NO =  ? AND USE_SECTION = '2' \
GROUP BY FIRST_SEQ \
) A \
JOIN CALCULATION_INFO CI ON A.FIRST_SEQ = CI.FIRST_SEQ AND CI.YEAR =? AND CI.AREA_AFTER > 0 \
JOIN PLACE P ON P.ADMIN_NO = CI.ADMIN_NO \
JOIN REF_PURPOSECODE RP ON RP.CODE = P.PURPOSE_CD  AND P.TYPE = RP.SECTION

// getCal_sum_seq
Querys.jumyong.junggi.getCal_sum_seq = \
SELECT MAX(SEQ) FROM( \
SELECT SEQ FROM CAL_SUM_INFO WHERE ADMIN_NO = ? AND YEAR = ? AND USE_SECTION = 1 \
UNION ALL SELECT 0 AS SEQ FROM DUAL )

//junggi cal_sum_exist
Querys.jumyong.junggi.cal_sum_exist = \
SELECT COUNT(*) FROM CAL_SUM_INFO A, TAXATION_INFO B \
WHERE A.ADMIN_NO = B.ADMIN_NO \
AND A.SEQ = B.SEQ \
AND B.TAX_GUBUN = '1' \
AND A.ADMIN_NO = ? \
AND B.YEAR = ? \
AND ((A.FROMDATE <= ? AND A.TODATE >= ?) OR (A.FROMDATE <= ? AND A.TODATE >= ?))

//junggi getUseSection
Querys.jumyong.junggi.getUseSection = \
SELECT USE_SECTION FROM CALCULATION_INFO WHERE SEQ = ?

Querys.jumyong.junggi.Bugwa_Register = \
	insert into TAXATION_INFO(ADMIN_NO, TAX_NO, TAX_GUBUN, TAX_YM, TAX_CD, SIGU_CD, DEPT_CD, TAXPAYER_SET, LIVE, OBJ_SET, \
		BONSE, VAT, TAX_DATE, INTAX, INDATE, OVERTAX, OVERDATE, ADD_SET, ADD_YN, NOTES, \
		LIMIT_SUM, LIMIT_CNT, RATE, RATE_CAUSE, YEAR, SEQ, SISE, GIGUM, GUKSE, GUSE, SUBUSEO_CD, OCR_SIGU_CD, OCR_BUSEO_CD, \
		FORM1, FORM2 , TAXPAYER_ID ) \
		values(?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?  ,?)
		
//\ubd80\uacfc\uc815\ubcf4 \ub144\ub3c4\ubcc4 \uac1c\ubcc4 \uc815\ubcf4
Querys.jumyong.junggi.impositionInfo_tax = \
SELECT  DISTINCT C.SEQ , CI.YEAR , C.PRICE , C.AREA_AFTER , C.RATE \
		, CI.FROMDATE , CI.TODATE , C.SUM_LASTYEAR , C.SUM_YEAR , CI.SUM_ADJUST \
		, C.ADJUSTMENT , C.FORM , C.FORM_ADJUST , C.PERIOD , C.FIRST_SEQ \
		, C.USE_SECTION , R.NAME , T.TAX_DATE , T.INDATE , T.OVERDATE \
		, T.OVERTAX , T.SIGU_CD , PL.BJ_CD , T.TAX_NO , T.DEPT_CD \
		, DECODE(SUBSTR(T.TAX_CD,1,2),PL.TAX_SET,T.TAX_CD,NVL((SELECT RT.TAXCODE FROM REF_TAXCODE RT WHERE RT.TAXCODE = PL.TAX_SET||SUBSTR(T.TAX_CD,3,6)),T.TAX_CD)) AS TAX_CD \
		, T.TAX_GUBUN , T.OBJ_SET , T.TAXPAYER_ID , T.TAXPAYER_SET \
 		, T.OCR_SIGU_CD, T.OCR_BUSEO_CD, T.SEQ TSEQ , C.CAL_SUM_SEQ , T.TAX_YN \
 		, T.SUBUSEO_CD , T.LIVE , RP.CHECK_YN , RP.YOYUL , RP.MOMEY \
 		, PL.SECTION , C.SURCHARGE_RATE , T.ADD_SET, T.ADD_YN , CI.SUM AS REDUCTION_SUM \
 		, CI.REDUCTION_RATE AS OLD_REDUCTION_RATE, CI.REDUCTION_REASON as OLD_REDUCTION_REASON \
 		, CI.PERCENT_RATE AS OLD_PERCENT_RATE, CI.PERCENT_REASON as OLD_PERCENT_REASON \
 		, PL.REDUCTION_RATE , PL.REDUCTION_REASON, PL.PERCENT_RATE , PL.PERCENT_REASON, PL.AREA_SIZE , T.VAT, CI.FORM_ADJUST AS REDUCTION_FORM, PL.TYPE \
 		, PL.WSP_YN , PL.WITH_SUM_PRICE, PL.PURPOSE_CD \
FROM CALCULATION_INFO C ,REF_COMMONCODE R ,TAXATION_INFO T , CAL_SUM_INFO CI , PLACE PL, REF_PURPOSECODE RP \
WHERE R.CODE = T.TAX_GUBUN \
AND R.TYPE = 'use_section' \
AND CI.ADMIN_NO = T.ADMIN_NO(+) \
AND C.ADMIN_NO = CI.ADMIN_NO \
AND CI.TAX_SEQ = T.SEQ(+) \
AND C.CAL_SUM_SEQ = CI.SEQ \
AND C.ADMIN_NO = PL.ADMIN_NO \
AND PL.PURPOSE_CD = RP.CODE \
AND PL.TYPE = RP.SECTION \
AND C.SEQ = ? \
AND C.ADMIN_NO = ? \
AND CI.YEAR = ?


//\ubd80\uacfc\uc815\ubcf4 \ub9ac\uc2a4\ud2b8
Querys.jumyong.junggi.impositionInfoList_multi = \
SELECT	DISTINCT A.ADMIN_NO, A.SEQ AS CSEQ, B.YEAR, A.AREA_AFTER, A.PRICE, A.RATE, A.FROMDATE, A.TODATE, A.SUM_LASTYEAR, A.SUM_YEAR \
		, A.SUM_ADJUST, A.ADJUSTMENT, A.FORM, A.FORM_ADJUST, A.PERIOD, A.USE_SECTION , B.SUM AS REDUCTION_SUM, B.FORM_ADJUST AS REDUCTION_FORM \
FROM CALCULATION_INFO A, CAL_SUM_INFO B , PLACE P \
WHERE A.CAL_SUM_SEQ = B.SEQ \
AND A.ADMIN_NO = B.ADMIN_NO \
AND A.ADMIN_NO = P.ADMIN_NO \
AND A.ADMIN_NO = ? \
AND B.YEAR = ? \
ORDER BY A.SEQ DESC \


//\uba74\uc801 \ud569\uacc4
Querys.jumyong.junggi.getProductAreaSum_year = \
SELECT SUM(AREA_AFTER) FROM CALCULATION_INFO WHERE ADMIN_NO = ? AND YEAR =? AND USE_SECTION = '1'

//\uc810\uc6a9\ubaa9\uc801\ucf54\ub4dc\ub85c \ucf54\ub4dc\uba85 \uac00\uc838\uc624\uae30
Querys.gapan.junggi.getPurposeNm = \
SELECT MAX(CLASS_NM) CLASS_NM \
FROM( \
	SELECT CLASS_NM || '@' || CHECK_YN CLASS_NM \
	FROM( \
		SELECT DECODE(CLASS_NM,NULL,'', CLASS_NM) CLASS_NM , CHECK_YN \
		FROM REF_PURPOSECODE WHERE SECTION = ? AND CODE = ? \
		UNION ALL SELECT 'null', 'null' AS CLASS_NM FROM DUAL \
		) \
)

Querys.gapan.junggi.updateTaxseq = \
UPDATE CAL_SUM_INFO SET TAX_SEQ = ? WHERE SEQ = ?


Querys.junggi.taxation_infoUpdate = \
UPDATE TAXATION_INFO \
	SET \
	TAX_YM       = ? \
	, INDATE     = ? \
	, OVERDATE   = ? \
	, TAX_DATE   = ? \
	, VAT		 = ? \
	, OVERTAX 	 = ? \
	, FORM1      = ? \
	, FORM2      = ? \
	, BONSE 	 = ? \
	, SISE		 = ? \
	, GUSE		 = ? \
	, INTAX		 = ? \
WHERE ADMIN_NO = ? \
AND SEQ = ?

Querys.jumyong.junggi.cal_sum_reductionUpdate_noPermission = \
UPDATE CAL_SUM_INFO SET REDUCTION_RATE = ? , REDUCTION_REASON = ? , SUM = TRUNC(SUM_ADJUST * DECODE(?,0,100,?)/10000,0)*100 \
, VAT = TRUNC(SUM_ADJUST * DECODE(?,0,100,?)/10000,0)*10 \
WHERE ADMIN_NO = ? AND SEQ = ?

Querys.junggi.CalSumUpdate = \
UPDATE CAL_SUM_INFO SET \
		AREA             = ? \
		, SUM_ADJUST       = ? \
		, VAT              = ? \
		, PERCENT_RATE   = ? \
		, REDUCTION_RATE   = ? \
		, SUM              = ? \
		, USE_SECTION      = ? \
		, PERCENT_REASON = ? \
		, REDUCTION_REASON = ? \
		, PRICE            = ? \
		, RATE             = ? \
		, FORM_ADJUST      = ? \
		, FROMDATE         = ? \
		, TODATE           = ? \
WHERE SEQ = ? \
AND ADMIN_NO = ?

Querys.jumyong.junggi.periodicalList_AllCal = \
SELECT 		R_ID, YEAR, ADMIN_NO, ADMIN_NO2, NAME, PURPOSE_CD, BONBUN, BUBUN , WITH_ADDR1 , SUM_ADJUST \
			, SUM , AREA , FROMDATE , TODATE , OLD_RATE , PRICE , LAST_FROMDATE , LAST_TODATE , TAX_NO ,TAX_YN \
			, BJ_NM , TYPE , SECTION , SECTION_NAME , TAX_SET, FORM_ADJUST, OWNER_SET_NM \
			, SIGU_CD , BJ_CD , DEPT_CD , TAX_GUBUN , OBJ_SET \
		    , TAXPAYER_ID , TAXPAYER_SET , OCR_SIGU_CD , OCR_BUSEO_CD , TAX_CD \
		    , LIVE , ADD_SET , ADD_YN , SUM_LASTYEAR , PERCENT_RATE , REDUCTION_RATE \
		    , SUBUSEO_CD , PERCENT_REASON , REDUCTION_REASON , SURCHARGE_RATE , AREA_AFTER , MAX_TAX_NO \
			, (SELECT DISTINCT(CLASS_NM||' '||SORT_NM||' '||KIND_NM) FROM REF_PURPOSECODE \
            WHERE PURPOSE_CD = CODE AND SECTION = TYPE ) AS PURPOSE_NM \
            , (SELECT DECODE(CHECK_YN,'1',MOMEY,YOYUL) FROM REF_PURPOSECODE \
            WHERE PURPOSE_CD = CODE AND SECTION = TYPE ) AS RATE,ROAD_ADDR \
	FROM  ( \
		SELECT ROWNUM R_ID, YEAR, ADMIN_NO, ADMIN_NO2, NAME, PURPOSE_CD, BONBUN, BUBUN , WITH_ADDR1 , SUM_ADJUST \
				, SUM, AREA , FROMDATE, TODATE, OLD_RATE, PRICE, LAST_FROMDATE, LAST_TODATE , TAX_NO ,TAX_YN \
				, BJ_NM , TYPE , SECTION , SECTION_NAME , TAX_SET, FORM_ADJUST, OWNER_SET_NM \
				, SIGU_CD , BJ_CD , DEPT_CD , TAX_GUBUN , OBJ_SET \
		       	, TAXPAYER_ID , TAXPAYER_SET , OCR_SIGU_CD , OCR_BUSEO_CD , TAX_CD \
		       	, LIVE , ADD_SET , ADD_YN , SUM_LASTYEAR , PERCENT_RATE , REDUCTION_RATE \
		       	, SUBUSEO_CD , PERCENT_REASON , REDUCTION_REASON , SURCHARGE_RATE , AREA_AFTER , MAX_TAX_NO \
		       	, ROAD_ADDR \
			FROM  ( \
					SELECT DISTINCT (C.ADMIN_NO||T.TAX_NO||C.SEQ), C.ADMIN_NO, C.YEAR, SUBSTR(C.ADMIN_NO, 10, 19) ADMIN_NO2 , A.NAME ,P.PURPOSE_CD \
					       , P.BONBUN , P.BUBUN , P.WITH_ADDR1 , C.SUM_ADJUST , C.SUM \
					       , P.AREA_SIZE AREA , C.FROMDATE , C.TODATE, C.RATE AS OLD_RATE, C.PRICE \
					       , C.FROMDATE AS LAST_FROMDATE , C.TODATE AS LAST_TODATE , T.TAX_NO , T.TAX_YN  , RD.BJ_NM \
					       , P.TYPE , P.SECTION , RC.NAME SECTION_NAME , P.TAX_SET, C.FORM_ADJUST \
					       , (SELECT R.NAME FROM REF_COMMONCODE R WHERE R.CODE = P.OWNER_SET AND R.TYPE='use_ownerGroup') AS OWNER_SET_NM \
					       , T.SIGU_CD , P.BJ_CD , T.DEPT_CD , T.TAX_GUBUN , T.OBJ_SET \
					       , T.TAXPAYER_ID , T.TAXPAYER_SET , T.OCR_SIGU_CD , T.OCR_BUSEO_CD , DECODE(SUBSTR(T.TAX_CD,1,2),P.TAX_SET,T.TAX_CD,NVL((SELECT RT.TAXCODE FROM REF_TAXCODE RT WHERE RT.TAXCODE = P.TAX_SET||SUBSTR(T.TAX_CD,3,6)),T.TAX_CD)) AS TAX_CD \
					       , T.LIVE , T.ADD_SET , T.ADD_YN , CI2.SUM_LASTYEAR , P.PERCENT_RATE , P.REDUCTION_RATE \
					       , T.SUBUSEO_CD , P.PERCENT_REASON  , P.REDUCTION_REASON , CI2.SURCHARGE_RATE , C.AREA AS AREA_AFTER \
					       ,(SELECT MAX(TAX_NO) FROM TAXATION_INFO WHERE ADMIN_NO = T.ADMIN_NO AND YEAR=T.YEAR) MAX_TAX_NO \
					       ,P.ROAD_ADDR||' '||P.ROAD_BON||DECODE(P.ROAD_BU,NULL,'','-'||P.ROAD_BU) AS ROAD_ADDR \
			       	FROM 	CAL_SUM_INFO C, APPEAL A, PLACE P, CALCULATION_INFO CI , TAXATION_INFO T , REF_DONGCODE RD , REF_COMMONCODE RC \
			            	, (SELECT ADMIN_NO,CAL_SUM_SEQ,MAX(SUM_LASTYEAR) AS SUM_LASTYEAR, MAX(SURCHARGE_RATE) AS SURCHARGE_RATE FROM CALCULATION_INFO GROUP BY ADMIN_NO,CAL_SUM_SEQ) CI2 \
					WHERE C.ADMIN_NO = A.ADMIN_NO \
					AND C.ADMIN_NO = P.ADMIN_NO \
					AND CI.ADMIN_NO = C.ADMIN_NO \
					AND C.SEQ = CI.CAL_SUM_SEQ \
					AND C.ADMIN_NO = T.ADMIN_NO \
					AND C.TAX_SEQ = T.SEQ \
					AND CI2.ADMIN_NO = C.ADMIN_NO \
					AND CI2.CAL_SUM_SEQ = C.SEQ \
					AND P.BJ_CD = RD.BJ_CD \
					AND SUBSTR(P.ADMIN_NO, 5, 2) = RD.SI_CD \
					AND SUBSTR(P.ADMIN_NO, 7, 3) = RD.GU_CD \
					AND P.SECTION <> '2' \
					AND P.SECTION <> '4' \
					AND RC.TYPE = 'use_section' \
					AND T.TAX_GUBUN = RC.CODE \
					AND C.YEAR LIKE ? \
					AND SUBSTR(A.ADMIN_NO,7,3) LIKE ? \
					AND C.YEAR LIKE ? \
					AND P.TYPE LIKE ? \
					AND P.TAX_SET LIKE ? \
					AND DECODE(T.TAX_YN,NULL,'0',T.TAX_YN) LIKE ? \
					AND C.FROMDATE >= ? \
					AND C.TODATE <= ? \
					AND P.PURPOSE_CD LIKE ? \
					AND P.PURPOSE_CD NOT LIKE '7%' \
					AND P.BJ_CD LIKE ? \
					AND P.HJ_CD LIKE ? \
					AND A.NAME LIKE ? \
					AND P.SECTION LIKE ? \
					ORDER BY ADMIN_NO DESC \
					) \
)WHERE R_ID BETWEEN ? AND ? \


Querys.junggi.WithSumAddrUpdate = \
UPDATE PLACE SET WITH_SUM_PRICE = ?,WITH_ADDR1 = ?, WITH_ADDR2 = ? WHERE ADMIN_NO = ? \