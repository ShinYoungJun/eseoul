
Querys.gapan.junggi.landPriceAllApllyCount = \
SELECT COUNT(*) \
FROM GAPAN_INFO I, GAPAN_HEAD H ,GAPAN_CALCULATION_INFO CI, GAPAN_TAXATION_INFO T, CP_BD_600 CP \
 WHERE I.GAPAN_NO = H.GAPAN_NO \
   AND I.GAPAN_NO = CI.GAPAN_NO \
   AND CI.GAPAN_NO = T.GAPAN_NO \
   AND CI.CAL_SUM_SEQ = T.SEQ \
   AND I.WITH_PNU = CP.ADDRESS(+) \
   AND SUBSTR(I.WITH_PNU,3,3) = ? \
   AND SUBSTR(T.TAX_YM,0,4) LIKE ? \
   AND I.GP_TYP LIKE ? \
   AND I.TAX_SET LIKE ? \
   AND T.TAX_YN LIKE ? \
   AND T.TAX_DATE BETWEEN ? AND ? \
   AND I.PURPOSE_CD LIKE ? \
   AND SUBSTR(I.WITH_PNU,6,5) LIKE ? \
   AND H.OWNER_NAME LIKE ? \
   AND DECODE(CI.SUM_ADJUST,NULL,'1', '2') LIKE ? 

Querys.gapan.junggi.landPriceAllAplly = \
SELECT R_ID, GAPAN_NO, OWNER_NAME, BJ_NM, WITH_ADDR, JIGA, PLACE_A \
  FROM ( \
SELECT ROWNUM R_ID, AA.* \
  FROM ( \
SELECT I.GAPAN_NO, H.OWNER_NAME \
       , (SELECT BJ_NM  \
            FROM REF_DONGCODE \
           WHERE SI_CD = SUBSTR(I.WITH_PNU,1,2) \
             AND GU_CD = SUBSTR(I.WITH_PNU,3,3) \
             AND BJ_CD = SUBSTR(I.WITH_PNU,6,3)||'00' \
             GROUP BY BJ_NM) BJ_NM \
       , I.WITH_ADDR, NVL(CP.JIGA, 0) JIGA, I.PLACE_A \
  FROM GAPAN_INFO I, GAPAN_HEAD H ,GAPAN_CALCULATION_INFO CI, GAPAN_TAXATION_INFO T, CP_BD_600 CP \
 WHERE I.GAPAN_NO = H.GAPAN_NO \
   AND I.GAPAN_NO = CI.GAPAN_NO \
   AND CI.GAPAN_NO = T.GAPAN_NO \
   AND CI.CAL_SUM_SEQ = T.SEQ \
   AND I.WITH_PNU = CP.ADDRESS(+) \
   AND SUBSTR(I.WITH_PNU,3,3) = ? \
   AND SUBSTR(T.TAX_YM,0,4) LIKE ? \
   AND I.GP_TYP LIKE ? \
   AND I.TAX_SET LIKE ? \
   AND T.TAX_YN LIKE ? \
   AND T.TAX_DATE BETWEEN ? AND ?  \
   AND I.PURPOSE_CD LIKE ? \
   AND SUBSTR(I.WITH_PNU,6,5) LIKE ? \
   AND H.OWNER_NAME LIKE ? \
   AND DECODE(CI.SUM_ADJUST,NULL,'1', '2') LIKE ? \
 ORDER BY I.GAPAN_NO DESC \
   ) AA \
   ) WHERE R_ID BETWEEN ? AND ?
   
Querys.gapan.junggi.PriceAplly = \
SELECT I.GAPAN_NO \
  FROM GAPAN_INFO I, GAPAN_HEAD H ,GAPAN_CALCULATION_INFO CI, GAPAN_TAXATION_INFO T, CP_BD_600 CP \
 WHERE I.GAPAN_NO = H.GAPAN_NO \
   AND I.GAPAN_NO = CI.GAPAN_NO \
   AND CI.GAPAN_NO = T.GAPAN_NO \
   AND CI.CAL_SUM_SEQ = T.SEQ \
   AND I.WITH_PNU = CP.ADDRESS(+) \
   AND SUBSTR(I.WITH_PNU,3,3) = ? \
   AND SUBSTR(T.TAX_YM,0,4) LIKE ? \
   AND I.GP_TYP LIKE ? \
   AND I.TAX_SET LIKE ? \
   AND T.TAX_YN LIKE ? \
   AND T.TAX_DATE BETWEEN ? AND ? \
   AND I.PURPOSE_CD LIKE ? \
   AND SUBSTR(I.WITH_PNU,6,5) LIKE ? \
   AND H.OWNER_NAME LIKE ? \
   AND DECODE(CI.SUM_ADJUST,NULL,'1', '2') LIKE ?
   
Querys.gapan.junggi.PriceApllySelect =\
SELECT COUNT(*) FROM GAPAN_NOW_PRICE WHERE GAPAN_NO = ?   

Querys.gapan.junggi.PriceApllyUpdate =\
INSERT \
  INTO GAPAN_NOW_PRICE \
SELECT I.GAPAN_NO, TO_CHAR(SYSDATE, 'YYYY') YEAR, CP.JIGA, TO_CHAR(SYSDATE, 'YYYYMMDD') UP_DATE \
  FROM GAPAN_INFO I,CP_BD_600 CP \
 WHERE I.WITH_PNU = CP.ADDRESS(+) \
   AND I.GAPAN_NO = ?
   
Querys.gapan.junggi.PriceApllyUpdate2 =\
UPDATE GAPAN_NOW_PRICE \
   SET PRICE = DECODE((SELECT CP.JIGA \
                  FROM GAPAN_INFO I,CP_BD_600 CP \
                 WHERE I.WITH_PNU = CP.ADDRESS  \
                   AND I.GAPAN_NO = ?), NULL, 0) \
       , YEAR = TO_CHAR(SYSDATE, 'YYYY') \
       , UP_DATE = TO_CHAR(SYSDATE, 'YYYYMMDD') \
 WHERE GAPAN_NO=?
    
Querys.gapan.junggi.periodicalList = \
SELECT R_ID, GAPAN_NO, GAPAN_NO2 , YEAR , TAX_NO , OWNER_NAME , SIDO, SIGUNGU, BJ_CD, BONBUN \
		, BUBUN, SPC_CD , PURPOSE_CD , CLASS_NM , SORT_NM , SUM_ADJUST , LAST_FROMDATE , LAST_TODATE , FROMDATE \
		, TODATE , RATE , PRICE , TAX_YN , GP_TYP, SUM_LASTYEAR , FT_TYP, NAME, WITH_ADDR, AREA , AREA_AFTER \
		, SEQ , CAL_SUM_SEQ , SI_NM , GU_NM , BJ_NM \
		FROM  ( \
				SELECT ROWNUM R_ID, GAPAN_NO, GAPAN_NO2 , YEAR , TAX_NO , OWNER_NAME , SIDO, SIGUNGU, BJ_CD, BONBUN \
						, BUBUN, SPC_CD , PURPOSE_CD , CLASS_NM , SORT_NM , SUM_ADJUST , LAST_FROMDATE , LAST_TODATE , FROMDATE \
						, TODATE , RATE , PRICE , TAX_YN , GP_TYP, SUM_LASTYEAR , FT_TYP, NAME, WITH_ADDR, AREA , AREA_AFTER \
						, SEQ , CAL_SUM_SEQ , SI_NM , GU_NM , BJ_NM \
				FROM  ( \
						SELECT DISTINCT A.GAPAN_NO , SUBSTR(A.GAPAN_NO,10,19) GAPAN_NO2  ,SUBSTR(T.TAX_YM,0,4) AS YEAR , T.TAX_NO , B.OWNER_NAME \
								, SUBSTR(A.WITH_PNU,1,2) SIDO, SUBSTR(A.WITH_PNU,3,3) SIGUNGU, SUBSTR(A.WITH_PNU,6,3) BJ_CD, SUBSTR(A.WITH_PNU,12,4) BONBUN \
						        , SUBSTR(A.WITH_PNU,16,4) BUBUN, SUBSTR(A.WITH_PNU,11,1) SPC_CD \
						        , A.PURPOSE_CD , RP.CLASS_NM , RP.SORT_NM ,C.SUM_ADJUST \
						        , CI2.LAST_FROMDATE , CI2.LAST_TODATE , C.FROMDATE , C.TODATE , C.RATE \
								, C.PRICE , T.TAX_YN \
								, A.GP_TYP, T.BONSE AS SUM_LASTYEAR , A.FT_TYP, GC.NAME, A.WITH_ADDR, GS.AREA , C.AREA_AFTER \
						        , C.SEQ , C.CAL_SUM_SEQ \
						        , RD.SI_NM , RD.GU_NM , RD.BJ_NM \
						FROM GAPAN_INFO A, GAPAN_HEAD B ,GAPAN_CALCULATION_INFO C, GAPAN_CAL_SUM_INFO GS, GAPAN_TAXATION_INFO T ,REF_PURPOSECODE RP , GAPAN_CODE GC ,REF_DONGCODE RD \
							,(SELECT GAPAN_NO,SUM(AREA_AFTER) AS AREA_AFTER FROM GAPAN_CALCULATION_INFO \
						    	WHERE USE_SECTION = 2 AND YEAR = ? GROUP BY GAPAN_NO \
						     ) C2  \
						    ,(SELECT GAPAN_NO, FROMDATE LAST_FROMDATE, TODATE LAST_TODATE \
      							FROM GAPAN_CALCULATION_INFO WHERE  YEAR = ? \
    						 ) CI2 \
						WHERE A.GAPAN_NO = B.GAPAN_NO \
						AND A.GAPAN_NO = C.GAPAN_NO \
						AND A.GAPAN_NO = GS.GAPAN_NO \
						AND A.GAPAN_NO = T.GAPAN_NO \
						AND A.PURPOSE_CD = RP.CODE \
						AND GC.TYPE = 'GP_TYP' \
						AND GC.CODE = A.GP_TYP \
						AND C2.GAPAN_NO(+) = T.GAPAN_NO \
						AND A.GAPAN_NO = CI2.GAPAN_NO(+) \
						AND C.CAL_SUM_SEQ = GS.SEQ \
						AND GS.TAX_SEQ = T.SEQ \
						AND RD.SI_CD = SUBSTR(A.WITH_PNU,1,2) \
						AND RD.GU_CD = SUBSTR(A.WITH_PNU,3,3) \
						AND RD.BJ_CD = SUBSTR(A.WITH_PNU,6,3)||'00' \
						AND C.YEAR = SUBSTR(T.TAX_YM,0,4) \
						AND SUBSTR(T.TAX_YM,0,4) LIKE ? \
						AND SUBSTR(A.WITH_PNU,3,3) = ? \
						AND A.GP_TYP LIKE ? \
						AND A.TAX_SET LIKE ? \
						AND T.TAX_YN LIKE ? \
						AND T.TAX_DATE BETWEEN ? AND ? \
						AND A.PURPOSE_CD LIKE ? \
						AND SUBSTR(A.WITH_PNU,6,5) LIKE ? \
						AND B.OWNER_NAME LIKE ? \
						AND DECODE(C.SUM_ADJUST,NULL,'1', '2') LIKE ? \
						ORDER BY A.GAPAN_NO DESC \
						) \
)WHERE R_ID BETWEEN ? AND ?


// \ub178\uc810 \uc815\uae30\ubd84\ub9ac\uc2a4\ud2b8 \uce74\uc6b4\ud2b8
Querys.gapan.junggi.periodicalListCount = \
SELECT COUNT(*) \
FROM GAPAN_INFO A, GAPAN_HEAD B ,GAPAN_CALCULATION_INFO C, GAPAN_CAL_SUM_INFO GS, GAPAN_TAXATION_INFO T ,REF_PURPOSECODE RP , GAPAN_CODE GC ,REF_DONGCODE RD \
	,(SELECT GAPAN_NO,SUM(AREA_AFTER) AS AREA_AFTER FROM GAPAN_CALCULATION_INFO \
		WHERE USE_SECTION = 2 AND YEAR = ? GROUP BY GAPAN_NO \
     ) C2  \
    ,(SELECT GAPAN_NO, FROMDATE LAST_FROMDATE, TODATE LAST_TODATE \
  		FROM GAPAN_CALCULATION_INFO WHERE  YEAR = ? \
	 ) CI2 \
WHERE A.GAPAN_NO = B.GAPAN_NO \
AND A.GAPAN_NO = C.GAPAN_NO \
AND A.GAPAN_NO = GS.GAPAN_NO \
AND A.GAPAN_NO = T.GAPAN_NO \
AND A.PURPOSE_CD = RP.CODE \
AND GC.TYPE = 'GP_TYP' \
AND GC.CODE = A.GP_TYP \
AND C2.GAPAN_NO(+) = T.GAPAN_NO \
AND A.GAPAN_NO = CI2.GAPAN_NO(+) \
AND C.CAL_SUM_SEQ = GS.SEQ \
AND GS.TAX_SEQ = T.SEQ \
AND RD.SI_CD = SUBSTR(A.WITH_PNU,1,2) \
AND RD.GU_CD = SUBSTR(A.WITH_PNU,3,3) \
AND RD.BJ_CD = SUBSTR(A.WITH_PNU,6,3)||'00' \
AND C.YEAR = SUBSTR(T.TAX_YM,0,4) \
AND SUBSTR(T.TAX_YM,0,4) LIKE ? \
AND SUBSTR(A.WITH_PNU,3,3) = ? \
AND A.GP_TYP LIKE ? \
AND A.TAX_SET LIKE ? \
AND T.TAX_YN LIKE ? \
AND T.TAX_DATE BETWEEN ? AND ? \
AND A.PURPOSE_CD LIKE ? \
AND SUBSTR(A.WITH_PNU,6,5) LIKE ? \
AND B.OWNER_NAME LIKE ? \
AND DECODE(C.SUM_ADJUST,NULL,'1', '2') LIKE ? 


Querys.gapan.junggi.periodicalList_old = \
SELECT R_ID,SUBSTR(ADMIN_NO,10,19) AS ADMIN_NO2,ADMIN_NO AS ADMIN_NO, YEAR, TYPE_NAME, NAME, BJ_NM, BONBUN, BUBUN, PURPOSE_CD, SUM_LASTYEAR, SUM_YEAR, SUM_ADJUST,  TAX_SET_NAME,CHECK_YN,CHECK_NAME \
FROM \
( \
    SELECT ROWNUM AS R_ID,ADMIN_NO, YEAR, TYPE_NAME, NAME, BJ_NM, BONBUN, BUBUN, PURPOSE_CD, SUM_LASTYEAR, SUM_YEAR, SUM_ADJUST,  TAX_SET_NAME,CHECK_YN,CHECK_NAME \
    FROM \
    (      \
          SELECT  DISTINCT(AB.ADMIN_NO),C.YEAR, R.NAME AS TYPE_NAME, A.NAME, R3.BJ_NM, P.BONBUN, P.BUBUN, P.PURPOSE_CD \
          , C.SUM_LASTYEAR, C.SUM_YEAR, C.SUM_ADJUST, R4.NAME AS TAX_SET_NAME,AB.CHECK_YN,R5.NAME AS CHECK_NAME \
          FROM ADMIN_BASE AB \
			  JOIN APPEAL A ON A.ADMIN_NO = AB.ADMIN_NO \
	  		  JOIN PLACE P ON P.ADMIN_NO = AB.ADMIN_NO \
		      JOIN (	\
		        SELECT  ADMIN_NO ,YEAR, SUM(SUM_LASTYEAR) AS SUM_LASTYEAR, SUM(SUM_YEAR) AS SUM_YEAR, SUM(SUM_ADJUST) AS SUM_ADJUST \
			    FROM CALCULATION_INFO \
			    GROUP BY ADMIN_NO,YEAR \
		      )C ON AB.ADMIN_NO = C.ADMIN_NO \
		      JOIN REF_COMMONCODE R 	  ON P.TYPE = R.CODE AND R.TYPE ='use_type' \
		      JOIN REF_DONGCODE R3 ON P.BJ_CD = R3. BJ_CD AND R3.GU_CD = '680' \
		      JOIN REF_COMMONCODE  R4  ON P.TAX_SET = R4. CODE  AND R4.TYPE = 'taxation_section' \
              JOIN REF_COMMONCODE  R5  ON AB.CHECK_YN = R5.CODE AND R5.TYPE = 'check_type'    \
	      WHERE P.SECTION = '1' AND P.MUL_FROMDATE <= ? AND P.MUL_TODATE >=? \
          AND C.YEAR LIKE ? \
          AND P.TYPE like ? \
          AND AB.CHECK_YN like ? \
          AND P.TAX_SET like ? \
          AND P.PURPOSE_CD like ? \
          AND ( SUBSTR(AB.ADMIN_NO,10,19) like ? OR SUBSTR(REQ_NO,10,19)  like ?) \
          AND A.NAME like ? \
          AND P.BJ_CD like ? \
          AND P.HJ_CD like ? \
          AND P.BONBUN like ? \
          AND DECODE(P.BUBUN,NULL,' ',P.BUBUN) like ? \
    ) \
)WHERE R_ID > (?-1)*? AND ROWNUM<= ?  

// \uc815\uae30\ubd84 \uc870\ud68c \ub9ac\uc2a4\ud2b8
Querys.gapan.junggi.periodicalList_old2 = \
SELECT R_ID, ADMIN_NO2, YEAR, ADMIN_NO, TAX_NO,SUM_LASTYEAR, SUM_ADJUST,NAME, BJ_NM,BONBUN,AREA_AFTER,  \
PURPOSE_CD,CLASS_NM,BJ_CD,TAX_YN,TYPE,TAX_SET_NAME,TYPE_NAME,TAX_YN_NAME  FROM  \
(   \
SELECT ROWNUM AS R_ID, ADMIN_NO2, YEAR, ADMIN_NO, TAX_NO,SUM_LASTYEAR, SUM_ADJUST,NAME, BJ_NM,BONBUN,AREA_AFTER,  \
PURPOSE_CD,CLASS_NM,BJ_CD,TAX_YN,TYPE,TAX_SET_NAME,TYPE_NAME,TAX_YN_NAME FROM   \
  ( SELECT  DISTINCT(SUBSTR(T1.ADMIN_NO,10,19)) AS ADMIN_NO2,  SUBSTR(T1.TAX_YM,0,4) AS YEAR,T1.ADMIN_NO,T1.TAX_NO,T2.BONSE AS SUM_LASTYEAR  \
  ,C.SUM AS SUM_ADJUST,A.NAME, R2.BJ_NM, P.BONBUN  ,C2.AREA_AFTER,P.PURPOSE_CD,RP.CLASS_NM,P.BJ_CD,T1.TAX_YN  \
  ,P.TYPE,R1.NAME AS TAX_SET_NAME, R.NAME AS TYPE_NAME   ,R3.NAME AS TAX_YN_NAME \
      FROM TAXATION_INFO T1    \
      JOIN APPEAL A ON A.ADMIN_NO = T1.ADMIN_NO  \
      JOIN PLACE P ON P.ADMIN_NO = T1.ADMIN_NO   \
      JOIN (   \
        SELECT ADMIN_NO,SUM(AREA_AFTER) AS AREA_AFTER FROM CALCULATION_INFO   \
          WHERE USE_SECTION = 2 GROUP BY ADMIN_NO   \
      ) C2 ON C2.ADMIN_NO = T1.ADMIN_NO   \
      JOIN REF_COMMONCODE R 	  ON P.TYPE = R.CODE AND R.TYPE ='use_type'    \
      JOIN REF_COMMONCODE R1 ON P.TAX_SET = R1. CODE  AND R1.TYPE = 'taxation_section'   \
      JOIN REF_DONGCODE R2 ON P.BJ_CD = R2. BJ_CD AND R2.GU_CD = ?   AND R2.SI_CD = SUBSTR(C2.ADMIN_NO,5,2) \
      JOIN REF_COMMONCODE R3 ON DECODE(T1.TAX_YN,NULL,'0',T1.TAX_YN) = R3.CODE AND R3.TYPE = 'taxation_yn'  \
      LEFT OUTER JOIN TAXATION_INFO T2 ON T1.ADMIN_NO = T2.ADMIN_NO AND SUBSTR(T1.TAX_YM,0,4) = SUBSTR(T2.TAX_YM,0,4) +1      \
      JOIN CAL_SUM_INFO C ON C.TAX_SEQ = T1.SEQ AND C.SUM>0     \
      LEFT JOIN REF_PURPOSECODE RP	 ON P.PURPOSE_CD = RP.CODE AND RP.SECTION = P.TYPE   \
    WHERE SUBSTR(T1.TAX_YM,0,4) LIKE ?   \
    AND P.TYPE LIKE ?   \
    AND P.TAX_SET LIKE ?    \
    AND DECODE(T1.TAX_YN,NULL,'0',T1.TAX_YN) LIKE ?   \
    AND P.BJ_CD LIKE ?   \
    AND P.BONBUN LIKE ?    \
    AND DECODE(P.BUBUN,NULL,' ',P.BUBUN) LIKE ?    \
    AND SUBSTR(T1.ADMIN_NO,10,19) LIKE ?   \
    AND A.NAME LIKE ?    \
    AND P.PURPOSE_CD LIKE ?    \
    )  \
)WHERE R_ID > (?-1)*? AND ROWNUM<= ?


// \uc815\uae30\ubd84 \uc870\ud68c \ub9ac\uc2a4\ud2b8 \uce74\uc6b4\ud2b8
Querys.gapan.junggi.periodicalListCount_old = \
SELECT  COUNT(DISTINCT(AB.ADMIN_NO))\
 FROM ADMIN_BASE AB \
			  JOIN APPEAL A ON A.ADMIN_NO = AB.ADMIN_NO \
	  		  JOIN PLACE P ON P.ADMIN_NO = AB.ADMIN_NO \
		      JOIN CALCULATION_INFO C ON AB.ADMIN_NO = C.ADMIN_NO \
		      JOIN REF_COMMONCODE R 	  ON P.TYPE = R.CODE AND R.TYPE ='use_type' \
		      JOIN REF_DONGCODE R3 ON P.BJ_CD = R3. BJ_CD AND R3.GU_CD = '680' \
		      JOIN REF_COMMONCODE  R4  ON P.TAX_SET = R4. CODE  AND R4.TYPE = 'taxation_section' \
              JOIN REF_COMMONCODE  R5  ON AB.CHECK_YN = R5.CODE AND R5.TYPE = 'check_type'    \
	      WHERE P.SECTION = '1' AND P.MUL_FROMDATE <= ? AND P.MUL_TODATE >=? \
          AND C.YEAR LIKE ? \
          AND P.TYPE like ? \
          AND AB.CHECK_YN like ? \
          AND P.TAX_SET like ? \
          AND P.PURPOSE_CD like ? \
          AND ( SUBSTR(AB.ADMIN_NO,10,19) like ? OR SUBSTR(REQ_NO,10,19)  like ?) \
          AND A.NAME like ? \
          AND P.BJ_CD like ? \
          AND P.HJ_CD like ? \
          AND P.BONBUN like ? \
          AND DECODE(P.BUBUN,NULL,' ',P.BUBUN) like ? \
          
          
          
          

// \uc815\uae30\ubd84 \uc870\ud68c \ub9ac\uc2a4\ud2b8 \uce74\uc6b4\ud2b8
Querys.gapan.junggi.periodicalListCount_old = \
SELECT  COUNT(DISTINCT(SUBSTR(T1.ADMIN_NO,10,19))) \
      FROM TAXATION_INFO T1    \
      JOIN APPEAL A ON A.ADMIN_NO = T1.ADMIN_NO  \
      JOIN PLACE P ON P.ADMIN_NO = T1.ADMIN_NO   \
      JOIN (   \
        SELECT ADMIN_NO,SUM(AREA_AFTER) AS AREA_AFTER FROM CALCULATION_INFO   \
          WHERE USE_SECTION = 2 GROUP BY ADMIN_NO   \
      ) C2 ON C2.ADMIN_NO = T1.ADMIN_NO   \
      JOIN REF_COMMONCODE R 	  ON P.TYPE = R.CODE AND R.TYPE ='use_type'    \
      JOIN REF_COMMONCODE R1 ON P.TAX_SET = R1. CODE  AND R1.TYPE = 'taxation_section'   \
      JOIN REF_DONGCODE R2 ON P.BJ_CD = R2. BJ_CD AND R2.GU_CD = ?   \
      LEFT OUTER JOIN TAXATION_INFO T2 ON T1.ADMIN_NO = T2.ADMIN_NO AND T1.YEAR = T2.YEAR +1   \
      JOIN CAL_SUM_INFO C ON C.ADMIN_NO = T1.ADMIN_NO AND C.YEAR = T1.YEAR AND C.SUM>0   \
      LEFT JOIN REF_PURPOSECODE RP	 ON P.PURPOSE_CD = RP.CODE AND RP.SECTION = P.TYPE   \
    WHERE SUBSTR(T1.TAX_YM,0,4) LIKE ?  \
    AND P.TYPE LIKE ?  \
    AND P.TAX_SET LIKE ?   \
    AND DECODE(T1.TAX_YN,NULL,'0',T1.TAX_YN) LIKE ?  \
    AND P.BJ_CD LIKE ?  \
    AND P.BONBUN LIKE ?   \
    AND DECODE(P.BUBUN,NULL,' ',P.BUBUN) LIKE ?   \
    AND SUBSTR(T1.ADMIN_NO,10,19) LIKE ?  \
    AND A.NAME LIKE ?   \
    AND P.PURPOSE_CD LIKE ?   \      
          
          

// \uc815\uae30\ubd84 \uc870\ud68c \ub9ac\uc2a4\ud2b8 \uce74\uc6b4\ud2b8
Querys.gapan.junggi.periodicalListCount_old2 = \
SELECT COUNT(*) FROM \
( \
SELECT DISTINCT(SUBSTR(T1.ADMIN_NO,10,19)) AS ADMIN_NO2,T1.TAX_NO  ,C.SUM AS SUM_ADJUST \
      FROM TAXATION_INFO T1    \
      JOIN APPEAL A ON A.ADMIN_NO = T1.ADMIN_NO  \
      JOIN PLACE P ON P.ADMIN_NO = T1.ADMIN_NO   \
      JOIN (   \
        SELECT ADMIN_NO,SUM(AREA_AFTER) AS AREA_AFTER FROM CALCULATION_INFO   \
          WHERE USE_SECTION = 2 GROUP BY ADMIN_NO   \
      ) C2 ON C2.ADMIN_NO = T1.ADMIN_NO   \
      JOIN REF_COMMONCODE R 	  ON P.TYPE = R.CODE AND R.TYPE ='use_type'    \
      JOIN REF_COMMONCODE R1 ON P.TAX_SET = R1. CODE  AND R1.TYPE = 'taxation_section'   \
      JOIN REF_DONGCODE R2 ON P.BJ_CD = R2. BJ_CD AND R2.GU_CD = ?   \
      LEFT OUTER JOIN TAXATION_INFO T2 ON T1.ADMIN_NO = T2.ADMIN_NO AND T1.YEAR = T2.YEAR +1   \
      JOIN CAL_SUM_INFO C ON C.TAX_SEQ = T1.SEQ AND C.SUM>0     \
      LEFT JOIN REF_PURPOSECODE RP	 ON P.PURPOSE_CD = RP.CODE AND RP.SECTION = P.TYPE   \
    WHERE SUBSTR(T1.TAX_YM,0,4) LIKE ?  \
    AND P.TYPE LIKE ?   \
    AND P.TAX_SET LIKE ?    \
    AND DECODE(T1.TAX_YN,NULL,'0',T1.TAX_YN) LIKE ?   \
    AND P.BJ_CD LIKE ?   \
    AND P.BONBUN LIKE ?    \
    AND DECODE(P.BUBUN,NULL,' ',P.BUBUN) LIKE ?    \
    AND SUBSTR(T1.ADMIN_NO,10,19) LIKE ?   \
    AND A.NAME LIKE ?    \
    AND P.PURPOSE_CD LIKE ?  \
)         
          
          
          

//\ubd80\uacfc\uc815\ubcf4 \ub9ac\uc2a4\ud2b8
Querys.gapan.junggi.impositionInfoList = \
SELECT R_ID,ADMIN_NO, CSEQ, YEAR, AREA_AFTER, PRICE, RATE, FROMDATE, TODATE, SUM_LASTYEAR, SUM_YEAR \
                , SUM_ADJUST, ADJUSTMENT, FORM, FORM_ADJUST, PERIOD,USE_SECTION \
FROM \
( \
	SELECT ROWNUM AS R_ID,ADMIN_NO, CSEQ, YEAR, AREA_AFTER, PRICE, RATE, FROMDATE, TODATE, SUM_LASTYEAR, SUM_YEAR \
                , SUM_ADJUST, ADJUSTMENT, FORM, FORM_ADJUST, PERIOD,USE_SECTION \
	FROM \
	( \
		SELECT ADMIN_NO,SEQ AS CSEQ, YEAR, AREA_AFTER,PRICE, RATE, FROMDATE, TODATE, SUM_LASTYEAR, SUM_YEAR \
		, SUM_ADJUST, ADJUSTMENT, FORM, FORM_ADJUST, PERIOD,USE_SECTION \
		FROM CALCULATION_INFO  \
		WHERE ADMIN_NO = ? AND YEAR = ? \
	) \
)WHERE R_ID > (?-1)*? AND ROWNUM<= ? \
ORDER BY YEAR DESC \


//\ubd80\uacfc\uc815\ubcf4 \ub9ac\uc2a4\ud2b8
Querys.gapan.junggi.impositionInfoByCalSumList = \
SELECT GAPAN_NO,SEQ AS CSEQ, YEAR, AREA_AFTER,PRICE, RATE, FROMDATE, TODATE, SUM_LASTYEAR, SUM_YEAR \
		, SUM_ADJUST, ADJUSTMENT, FORM, FORM_ADJUST, PERIOD,USE_SECTION \
FROM GAPAN_CALCULATION_INFO \
WHERE CAL_SUM_SEQ = ? \
ORDER BY YEAR DESC \


//\ubd80\uacfc\uc815\ubcf4 \ub9ac\uc2a4\ud2b8 - \uc218\uc2dc
Querys.gapan.junggi.impositionInfoList2 = \
		SELECT ADMIN_NO,SEQ AS CSEQ, YEAR, AREA_AFTER,PRICE, RATE, FROMDATE, TODATE, SUM_LASTYEAR, SUM_YEAR \
		, SUM_ADJUST, ADJUSTMENT, FORM, FORM_ADJUST, PERIOD,USE_SECTION \
		FROM CALCULATION_INFO  \
		WHERE SEQ = ? \


//\ubd80\uacfc\uc815\ubcf4 \ub9ac\uc2a4\ud2b8 \uce74\uc6b4\ud2b8
Querys.gapan.junggi.impositionInfoListCount = \
SELECT COUNT(T.ADMIN_NO)  FROM TAXATION_INFO T 	JOIN CALCULATION_INFO C ON T.ADMIN_NO = C.ADMIN_NO AND T.YEAR = C.YEAR \
JOIN REF_COMMONCODE R    ON T.TAX_YN = R.CODE AND R.TYPE = 'taxation_yn'  WHERE T.ADMIN_NO = ?

//\ubd80\uacfc\uc815\ubcf4 \ub144\ub3c4\ubcc4 \uac1c\ubcc4 \uc815\ubcf4
Querys.gapan.junggi.impositionInfo = \
SELECT C.SEQ,  C.YEAR,  C.PRICE,  C.AREA_AFTER,  C.RATE \
		, C.FROMDATE,  C.TODATE,  C.SUM_LASTYEAR ,  C.SUM_YEAR,  C.SUM_ADJUST \
		, C.ADJUSTMENT,  C.FORM,  C.FORM_ADJUST,  C.PERIOD, C.FIRST_SEQ \
		, C.USE_SECTION, R.NAME , T.TAX_DATE, T.INDATE , T.OVERDATE \
		, T.OVERTAX , T.VAT \
		, T.SIGU_CD , T.BJ_CD, T.TAX_NO, T.DEPT_CD, T.TAX_CD, T.TAX_GUBUN, T.OBJ_SET, T.TAXPAYER_ID \
 		, T.TAXPAYER_SET, T.OCR_SIGU_CD, T.OCR_BUSEO_CD, T.SEQ TSEQ , C.CAL_SUM_SEQ , T.TAX_YN \
 		, (SELECT NVL(LPAD(MAX(TAX_NO)+1 , 6 ,0 ), '000001') FROM GAPAN_TAXATION_INFO  ) MAX_TAX_NO \
 		, T.LIVE , GC.REDUCTION_RATE   , C.SURCHARGE_RATE , T.ADD_SET, T.ADD_YN , T.SUBUSEO_CD \
 		, GI.GP_TYP , GI.PLACE_A , GC.REDUCTION_REASON \
 		, (SELECT MAX(TAX_GUBUN) FROM GAPAN_TAXATION_INFO WHERE GAPAN_NO = C.GAPAN_NO AND YEAR+1=C.YEAR ) OLD_TAX_GUBUN \
FROM GAPAN_CALCULATION_INFO C , REF_COMMONCODE R , GAPAN_TAXATION_INFO T , GAPAN_CAL_SUM_INFO GC , GAPAN_INFO GI \
WHERE R.CODE = C.USE_SECTION \
AND R.TYPE = 'use_section' \
AND C.GAPAN_NO = T.GAPAN_NO \
AND C.CAL_SUM_SEQ = T.SEQ \
AND C.GAPAN_NO = GC.GAPAN_NO \
AND C.CAL_SUM_SEQ = GC.SEQ \
AND C.GAPAN_NO = GI.GAPAN_NO \
AND C.GP_TYP = GI.GP_TYP \
AND C.GAPAN_NO = ? \
AND C.SEQ = ?

//\ubd80\uacfc\uc815\ubcf4 \uc791\ub144\ub3c4 \uc810\uc6a9\ub8cc
Querys.gapan.junggi.sum_lastyear = \
SELECT SUM_ADJUST,FROMDATE,TODATE FROM	\
(	\
	SELECT SUM_ADJUST, FROMDATE,TODATE, YEAR FROM CALCULATION_INFO WHERE ADMIN_NO = ? AND YEAR = ?	\
	UNION \
	SELECT 0 AS SUM_ADJUST,' ' AS FROMDATE, ' ' AS TODATE, '-1' AS YEAR FROM DUAL	\
	ORDER BY YEAR DESC	\
) WHERE ROWNUM = 1 

//\uc0b0\ucd9c\uc815\ubcf4 \uc785\ub825\ud6c4 SEQ \uad6c\ud558\uae30
Querys.gapan.junggi.getProductSeq = \
SELECT SEQ FROM CALCULATION_INFO WHERE ADMIN_NO = ? AND YEAR = ? AND ROWNUM = 1 \

//\ubd80\uacfc\uc815\ubcf4 \uac00\uc7a5 \ub098\uc911 \uc785\ub825\ub41c YEAR
Querys.gapan.junggi.getLastYear = \
SELECT DECODE(MAX(T.YEAR),NULL,99999999,(MAX(T.YEAR))) AS LASTYEAR	FROM TAXATION_INFO T 	JOIN CALCULATION_INFO C ON T.ADMIN_NO = C.ADMIN_NO AND T.YEAR = C.YEAR \
WHERE T.ADMIN_NO = ?

//\ubd80\uacfc \ubbf8\ubd80\uacfc \uc5ec\ubd80
Querys.gapan.junggi.getTaxYn = \
SELECT MAX(TAX_YN) AS TAX_YN FROM \
   (   SELECT TAX_YN FROM TAXATION_INFO WHERE SEQ = ? \
      UNION \
      SELECT '0' AS TAX_YN FROM DUAL \
   )
   
//\ub144\ub3c4\ubcc4 \ud569\uacc4 \ub9ac\uc2a4\ud2b8
Querys.gapan.junggi.ImpositionSumListByYear = \
SELECT R_ID, ADMIN_NO, YEAR,USE_SECTIONNAME,USE_SECTION, SUM_LASTYEAR,SUM_YEAR,SUM_ADJUST,AREA_AFTER, SEQ \
FROM \
( \
  SELECT ROWNUM AS R_ID, ADMIN_NO, YEAR,NAME AS USE_SECTIONNAME,USE_SECTION,  SUM_LASTYEAR,SUM_YEAR,SUM_ADJUST,AREA_AFTER, SEQ \
  FROM \
  ( \
    SELECT * FROM (      \
      SELECT ADMIN_NO,YEAR,USE_SECTION, SUM(SUM_LASTYEAR) AS SUM_LASTYEAR, SUM(SUM_YEAR) AS SUM_YEAR \
      , SUM(SUM_ADJUST) AS SUM_ADJUST, SUM(AREA_AFTER) AS AREA_AFTER, NULL AS SEQ \
      FROM CALCULATION_INFO  \
      WHERE ADMIN_NO = ? AND USE_SECTION = '1' \
      GROUP BY ADMIN_NO, YEAR, USE_SECTION \
        UNION ALL \
      SELECT ADMIN_NO,YEAR,USE_SECTION, SUM_LASTYEAR , SUM_YEAR , SUM_ADJUST, AREA_AFTER, SEQ \
      FROM CALCULATION_INFO  \
      WHERE ADMIN_NO = ? AND USE_SECTION = '2'     \
    ) JOIN REF_COMMONCODE R ON R.CODE = USE_SECTION AND R.TYPE = 'use_section' \
    ORDER BY YEAR DESC \
  ) \
)WHERE R_ID > (?-1)*? AND ROWNUM<= ? \
ORDER BY YEAR DESC

//\ub144\ub3c4\ubcc4 \ud569\uacc4 \ub9ac\uc2a4\ud2b8\uce74\uc6b4\ud2b8
Querys.gapan.junggi.ImpositionSumListByYearCount = \
SELECT COUNT(YEAR) FROM( SELECT YEAR    FROM CALCULATION_INFO \
WHERE ADMIN_NO = ? GROUP BY YEAR  )

//\uba74\uc801 \ud569\uacc4
Querys.gapan.junggi.getProductAreaSum = \
SELECT SUM(AREA_AFTER) FROM GAPAN_CALCULATION_INFO WHERE FIRST_SEQ=? AND USE_SECTION = '2'
   

//\uc815\uae30\ubd84 \uc120\ud0dd \ub9ac\uc2a4\ud2b8
Querys.jumyong.productjunggi_addList_old = \
SELECT A.*, DECODE(C.SEQ,NULL,'N','Y')AS CAL_YN,C.SEQ	\
FROM	\
(	\
SELECT A.ADMIN_NO,C.SEQ,C.FIRST_SEQ,A.YEAR,C.YEAR AS CAL_YEAR,A.AREA_AFTER,C.SUM_ADJUST,C.USE_SECTION, R1.NAME  \
FROM (  \
  SELECT C.ADMIN_NO, SEQ,YEAR,AREA AS AREA_AFTER FROM CALCULATION_INFO C JOIN  \
  (  \
          SELECT FIRST_SEQ,SUM(AREA_AFTER) AS AREA FROM CALCULATION_INFO  \
          WHERE ADMIN_NO = ? AND USE_SECTION = '2'  \
		  GROUP BY FIRST_SEQ  \
  ) C2  ON C.SEQ = C2.FIRST_SEQ  \
)A JOIN calculation_info C ON A.SEQ = C.FIRST_SEQ AND C.YEAR = ? AND C.AREA_AFTER > 0  \
JOIN REF_COMMONCODE R1 ON R1.CODE = C.USE_SECTION AND R1.TYPE = 'use_section'   \
) A  \
LEFT JOIN CALCULATION_INFO C ON A.ADMIN_NO = C.ADMIN_NO AND C.YEAR=? \
AND A.FIRST_SEQ = C.FIRST_SEQ AND C.USE_SECTION = '1'


//\uc815\uae30\ubd84 \uc120\ud0dd \ub9ac\uc2a4\ud2b8
Querys.jumyong.productjunggi_addList = \
SELECT AA.*, DECODE(C.SEQ,NULL,'N','Y')AS CAL_YN,C.SEQ,R1.NAME AS NAME	  FROM  \
( \
SELECT ADMIN_NO, C.SEQ,FIRST_SEQ,S.YEAR, C.YEAR AS CAL_YEAR,S.AREA AS AREA_AFTER , \
CASE \
WHEN A.COUNT1 >= 2 THEN '2' \
WHEN A.COUNT1 =1 THEN USE_SECTION \
END AS USE_SECTION \
,S.AREA,C.SUM_ADJUST \
FROM CALCULATION_INFO C \
JOIN \
( \
    SELECT FIRST_SEQ,COUNT(SEQ) AS COUNT1 \
    FROM CALCULATION_INFO WHERE ADMIN_NO =  ? AND YEAR = ?  \
    GROUP BY FIRST_SEQ \
)A ON C.FIRST_SEQ = A.FIRST_SEQ AND C.AREA_AFTER > 0 AND C.YEAR = ? \
JOIN \
( \
  SELECT C2.FIRST_SEQ, C.ADMIN_NO, SEQ,YEAR,AREA  FROM CALCULATION_INFO C JOIN   \
  (   \
          SELECT FIRST_SEQ,SUM(AREA_AFTER) AS AREA FROM CALCULATION_INFO   \
          WHERE ADMIN_NO = ? AND USE_SECTION = '2'   \
		  GROUP BY FIRST_SEQ   \
  ) C2  ON C.SEQ = C2.FIRST_SEQ  \
)S ON S.FIRST_SEQ = A.FIRST_SEQ  \
)AA  \
LEFT JOIN CALCULATION_INFO C ON AA.ADMIN_NO = C.ADMIN_NO AND C.YEAR= ? \
AND AA.FIRST_SEQ = C.FIRST_SEQ AND C.USE_SECTION = '1' \
JOIN REF_COMMONCODE R1 ON R1.CODE = AA.USE_SECTION AND R1.TYPE = 'use_section'   


//\uc0b0\ucd9c_\ubd80\uacfc \ud14c\uc774\ube14 SEQ \uc5bb\uae30
Querys.gapan.junggi.getcal_tax_seq = \
SELECT MAX(CAL_SUM_SEQ) \
FROM \
( \
  SELECT CAL_SUM_SEQ FROM GAPAN_CALCULATION_INFO WHERE GAPAN_NO = ? AND YEAR = ? \
  AND USE_SECTION = '1' AND ROWNUM = 1 \
  UNION \
  SELECT 0 AS GAPAN_CAL_SUM_SEQ FROM DUAL \
)


//\ub144\ub3c4\ubcc4 \ud569\uacc4 \ub9ac\uc2a4\ud2b8
Querys.gapan.junggi.cal_sum_infoList = \
SELECT R_ID, GAPAN_NO, SEQ, YEAR, AREA, SUM_ADJUST, SUM, USE_SECTION, USE_SECTIONNAME ,REDUCTION_RATE, REDUCTION_REASON  ,TAX_SET_NAME  \
FROM  \
(  \
	SELECT ROWNUM AS R_ID, GAPAN_NO, SEQ, YEAR, AREA, SUM_ADJUST, SUM, USE_SECTION, USE_SECTIONNAME ,REDUCTION_RATE, REDUCTION_REASON,TAX_SET_NAME  \
  	FROM  \
  	(  \
    	SELECT  C.GAPAN_NO, C.SEQ, C.YEAR, C.AREA, C.SUM_ADJUST \
        		, C.SUM, C.USE_SECTION ,R.NAME AS USE_SECTIONNAME \
        		, C.REDUCTION_RATE, C.REDUCTION_REASON  ,R2.NAME AS TAX_SET_NAME \
			FROM GAPAN_INFO A ,GAPAN_CAL_SUM_INFO C , REF_COMMONCODE R , REF_COMMONCODE R2 \
			WHERE A.GAPAN_NO = C.GAPAN_NO \
			AND C.USE_SECTION = R.CODE \
			AND R.TYPE = 'use_section' \
			AND R2.CODE = A.TAX_SET \
			AND R2.TYPE = 'taxation_section' \
			AND C.GAPAN_NO = ? \
			AND C.YEAR = ? \
			ORDER BY YEAR DESC \
  	)  \
)WHERE R_ID BETWEEN ? AND ? \
ORDER BY SEQ DESC

//\ub144\ub3c4\ubcc4 \ud569\uacc4 \ub9ac\uc2a4\ud2b8 \uac1c\uc218
Querys.gapan.junggi.cal_sum_infoListCount = \
    SELECT COUNT(1) FROM GAPAN_CAL_SUM_INFO WHERE GAPAN_NO = ? AND YEAR = ? \
    
//CAL_SUM_INFO \ud14c\uc774\ube14 \uba74\uc801 \ucd94\uac00 \uc5c5\ub370\uc774\ud2b8
Querys.gapan.junggi.cal_sum_addUpdate = \
UPDATE CAL_SUM_INFO SET AREA = ? \
, SUM_ADJUST = ? \
, VAT = TRUNC(? *(100-REDUCTION_RATE)/100/100,0)*10  \
, SUM = TRUNC(? *(100-REDUCTION_RATE)/100/100,0)*100  \
, FORM_ADJUST = ? \
WHERE SEQ = ?


//CAL_SUM_INFO \uac10\uba74 \uc785\ub825(\uc218\uc815)
Querys.gapan.junggi.cal_sum_reductionUpdate = \
UPDATE GAPAN_CAL_SUM_INFO SET REDUCTION_RATE = ? , REDUCTION_REASON = ? , SUM = TRUNC(SUM_ADJUST * (100-?)/10000,0)*100 \
, VAT = TRUNC(SUM_ADJUST * (100-?)/10000,0)*10 \
WHERE SEQ = ?

//SUM_ADJUST, AREA_AFTER \ud569\uacc4 SUM_SEQ\ubcc4
Querys.gapan.junggi.getSumBysumseq = \
SELECT SUM(SUM_ADJUST) AS SUM_ADJUST,SUM(AREA_AFTER) AS AREA_AFTER FROM CALCULATION_INFO WHERE CAL_SUM_SEQ=?

//SUM_ADJUST, AREA_AFTER \ud569\uacc4 SUM_SEQ\ubcc4
Querys.gapan.junggi.getReduction = \
SELECT YEAR, SEQ,REDUCTION_RATE, REDUCTION_REASON FROM GAPAN_CAL_SUM_INFO WHERE SEQ = ?

//\uc815\uae30\ubd84 \uac10\uc18c \uba74\uc801 \uc788\ub294\uc9c0 \uccb4\ud06c
Querys.gapan.junggi.getCountSameCalculation = \
SELECT COUNT(GAPAN_NO) FROM GAPAN_CALCULATION_INFO WHERE FIRST_SEQ = ? AND YEAR = ?

//calculation_temp_insert
Querys.gapan.junggi.junggiCalculationTempInsert = \
INSERT INTO CALCULATION_INFO (ADMIN_NO,YEAR,SEQ,AREA_AFTER,RATE,SUM_LASTYEAR,FROMDATE,TODATE,UP_DATE,PERIOD,USE_SECTION, \
FIRST_SEQ,CAL_SUM_SEQ,PRICE,SUM_YEAR,VAT,FORM_ADJUST,FORM) \
SELECT ADMIN_NO,?,CALCULATION_SEQ.NEXTVAL,A.AREA_AFTER,DECODE(CHECK_YN,1,MOMEY,YOYUL) AS RATE, \
CI.SUM_ADJUST*12/CI.PERIOD*A.AREA_AFTER/CI.AREA_AFTER AS SUM_ADJUST, \
?,?,?,'12','1',A.FIRST_SEQ,?,0,0,0,' ',' ' \
 FROM  \
( \
SELECT FIRST_SEQ,SUM(AREA_AFTER) AS AREA_AFTER FROM CALCULATION_INFO \
WHERE ADMIN_NO =  ? AND USE_SECTION = '2' \
GROUP BY FIRST_SEQ \
) A \
JOIN CALCULATION_INFO CI ON A.FIRST_SEQ = CI.FIRST_SEQ AND CI.YEAR =? AND CI.AREA_AFTER > 0 \
JOIN PLACE P ON P.ADMIN_NO = CI.ADMIN_NO \
JOIN REF_PURPOSECODE RP ON RP.CODE = P.PURPOSE_CD  AND P.TYPE = RP.SECTION

// getCal_sum_seq
Querys.gapan.junggi.getCal_sum_seq = \
SELECT MAX(SEQ) FROM( \
SELECT SEQ FROM GAPAN_CAL_SUM_INFO WHERE GAPAN_NO = ? AND YEAR = ? AND USE_SECTION = 1 \
UNION ALL SELECT 0 AS SEQ FROM DUAL )

//junggi cal_sum_exist
Querys.gapan.junggi.cal_sum_exist = \
SELECT COUNT(*) FROM GAPAN_CAL_SUM_INFO  WHERE GAPAN_NO = ? AND USE_SECTION = '1' AND YEAR =?


//junggi getUseSection
Querys.gapan.junggi.getUseSection = \
SELECT USE_SECTION FROM GAPAN_CALCULATION_INFO WHERE SEQ = ?

//\uc0b0\ucd9c\ubb3c \uc785\ub825
Querys.gapan.calInsert = \
INSERT INTO GAPAN_CALCULATION_INFO \
(GAPAN_NO,SEQ,YEAR,PRICE, FROMDATE,TODATE,AREA_BEFORE,AREA_AFTER,RATE,SUM_LASTYEAR,SUM_YEAR,SUM_ADJUST,FORM_ADJUST,FORM,LICENSE_TAX,PERIOD,VAT,ADJUSTMENT,REDUCTION_RATE,REDUCTION_REASON,SURCHARGE_RATE,USE_SECTION,FIRST_SEQ,CAL_SUM_SEQ,PREV_SEQ,UP_DATE,GP_TYP) \
VALUES(?,GAPAN_CALCULATION_SEQ.NEXTVAL,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)

//\uc0b0\ucd9c\ubb3c \uc785\ub825(\uc218\uc2dc\ubd84)
Querys.gapan.calInsert2 = \
INSERT INTO GAPAN_CALCULATION_INFO \
(GAPAN_NO,SEQ,YEAR,PRICE, FROMDATE,TODATE,AREA_BEFORE,AREA_AFTER,RATE,SUM_LASTYEAR,SUM_YEAR,SUM_ADJUST,FORM_ADJUST,FORM,LICENSE_TAX,PERIOD,VAT,ADJUSTMENT,REDUCTION_RATE,REDUCTION_REASON,SURCHARGE_RATE,USE_SECTION,FIRST_SEQ,CAL_SUM_SEQ,PREV_SEQ, UP_DATE,GP_TYP) \
VALUES(?,GAPAN_CALCULATION_SEQ.NEXTVAL,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,GAPAN_CALCULATION_SEQ.currval,?,?,?,?)

//\uc0b0\ucd9c\ubb3c \ubd80\uacfc \uc785\ub825
Querys.gapan.cal_sum_infoInsert = \
INSERT INTO GAPAN_CAL_SUM_INFO \
(GAPAN_NO, SEQ, YEAR, AREA, SUM_ADJUST,VAT,REDUCTION_RATE,SUM,USE_SECTION,REDUCTION_REASON,PRICE,RATE,FORM_ADJUST,FROMDATE,TODATE,TAX_SEQ) \
VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?) \

//GAPAN_CAL_SUM_INFO \uc2dc\ud000\uc2a4 \uc99d\uac00\uac12
Querys.gapan.GetCAL_SUM_SEQ = \
SELECT GAPAN_CAL_SUM_SEQ.NEXTVAL FROM DUAL

// GAPAN_TAXATION_INFO \uc785\ub825
Querys.gapan.junggi.Bugwa_Register = \
INSERT INTO GAPAN_TAXATION_INFO(GAPAN_NO, TAX_NO, TAX_GUBUN, TAX_YM, TAX_CD, SIGU_CD, DEPT_CD, TAXPAYER_SET, LIVE, OBJ_SET, \
	BONSE, VAT, TAX_DATE, INTAX, INDATE, OVERTAX, OVERDATE, ADD_SET, ADD_YN, NOTES, \
	LIMIT_SUM, LIMIT_CNT, RATE, RATE_CAUSE, YEAR, SEQ, SISE, GIGUM, GUKSE, GUSE, SUBUSEO_CD, OCR_SIGU_CD, OCR_BUSEO_CD, \
	FORM1, FORM2 , BJ_CD) \
VALUES(?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?, ?,?,?,?,?  ,?)


// GAPAN_INFO \ubd80\uacfc\uc5ec\ubd80 \ubcc0\uacbd
Querys.gapan.junggi.setTax_Yn = \
UPDATE GAPAN_INFO SET TAXTATION = '0' SECTION = '1' WHERE GAPAN_NO = ?


//GAPAN_CALCULATION_INFO \uc218\uc815
Querys.gapan.calculationInfoUpdate = \
UPDATE GAPAN_CALCULATION_INFO \
    SET \
    YEAR = ?, \
    PRICE = ?, \
    FROMDATE = ?, \
    TODATE = ?, \
    AREA_AFTER = ?, \
    RATE = ?, \
    SUM_LASTYEAR = ?, \
    SUM_YEAR = ?, \
    SUM_ADJUST = ?, \
    VAT = ?, \
    FORM_ADJUST = ?, \
    FORM = ? , \
    PERIOD= ?,  \
    ADJUSTMENT = ?, \
    LICENSE_TAX=?, \
    REDUCTION_RATE=?, \
    REDUCTION_REASON=?, \
    SURCHARGE_RATE =? ,\
    UP_DATE = ? \
WHERE SEQ = ?

// GAPAN_CAL_SUM_INFO \uc218\uc815 
Querys.gapan.cal_sum_infoUpdate = \
UPDATE GAPAN_CAL_SUM_INFO \
	SET \
	SUM_ADJUST       = ? \
	, VAT              = ? \
	, REDUCTION_RATE   = ? \
	, SUM              = ? \
	, REDUCTION_REASON = ? \
	, PRICE            = ? \
	, RATE             = ? \
	, FORM_ADJUST      = ? \
	, FROMDATE         = ? \
	, TODATE           = ? \
WHERE GAPAN_NO = ? \
AND SEQ = ?


// GAPAN_TAXATION_INFO
Querys.gapan.taxation_infoUpdate = \
UPDATE GAPAN_TAXATION_INFO \
	SET \
	TAX_YM       = ? \
	, INDATE     = ? \
	, OVERDATE   = ? \
	, TAX_DATE   = ? \
	, VAT		 = ? \
	, OVERTAX 	 = ? \
	, FORM1      = ? \
	, FORM2      = ? \
	, BONSE 	 = ? \
	, SISE		 = ? \
	, GUSE		 = ? \
	, INTAX		 = ? \
WHERE GAPAN_NO = ? \
AND SEQ = ?


Querys.gapan.junggi.periodicalList_AllCal = \
SELECT R_ID, GAPAN_NO, GAPAN_NO2 , YEAR , TAX_NO , OWNER_NAME , SIDO, SIGUNGU, BJ_CD, BONBUN \
		, BUBUN, SPC_CD , AREA_AFTER , PURPOSE_CD , CLASS_NM , SORT_NM , SUM_ADJUST , LAST_FROMDATE , LAST_TODATE , FROMDATE \
		, TODATE , RATE , PRICE , TAX_YN , GP_TYP , SUM_LASTYEAR , FT_TYP, NAME, WITH_ADDR, AREA \
		, SEQ , CAL_SUM_SEQ , SI_NM , GU_NM , BJ_NM , TAX_GUBUN \
		, REDUCTION_RATE , REDUCTION_REASON ,SURCHARGE_RATE , SIGU_CD \
        , DEPT_CD , OBJ_SET , TAXPAYER_ID , OCR_SIGU_CD, OCR_BUSEO_CD \
        , TAX_CD , LIVE , ADD_SET , ADD_YN , SUBUSEO_CD , TYPE , SECTION , SECTION_NAME \
        , TAXPAYER_SET , PLACE_A \
		FROM  ( \
				SELECT ROWNUM R_ID, GAPAN_NO, GAPAN_NO2 , YEAR , TAX_NO , OWNER_NAME , SIDO, SIGUNGU, BJ_CD, BONBUN \
						, BUBUN, SPC_CD , AREA_AFTER , PURPOSE_CD , CLASS_NM , SORT_NM , SUM_ADJUST , LAST_FROMDATE , LAST_TODATE , FROMDATE \
						, TODATE , RATE , PRICE , TAX_YN , GP_TYP, SUM_LASTYEAR , FT_TYP, NAME, WITH_ADDR, AREA \
						, SEQ , CAL_SUM_SEQ , SI_NM , GU_NM , BJ_NM , TAX_GUBUN \
						, REDUCTION_RATE , REDUCTION_REASON , SURCHARGE_RATE , SIGU_CD \
				        , DEPT_CD , OBJ_SET , TAXPAYER_ID , OCR_SIGU_CD, OCR_BUSEO_CD \
				        , TAX_CD , LIVE , ADD_SET , ADD_YN , SUBUSEO_CD , TYPE , SECTION , SECTION_NAME \
				        , TAXPAYER_SET , PLACE_A \
				FROM  ( \
						SELECT DISTINCT A.GAPAN_NO , SUBSTR(A.GAPAN_NO,10,19) GAPAN_NO2  ,SUBSTR(T.TAX_YM,0,4) AS YEAR , T.TAX_NO , B.OWNER_NAME \
								, SUBSTR(A.WITH_PNU,1,2) SIDO, SUBSTR(A.WITH_PNU,3,3) SIGUNGU, SUBSTR(A.WITH_PNU,6,3) BJ_CD, SUBSTR(A.WITH_PNU,12,4) BONBUN \
						        , SUBSTR(A.WITH_PNU,16,4) BUBUN, SUBSTR(A.WITH_PNU,11,1) SPC_CD \
						        , C2.AREA_AFTER , A.PURPOSE_CD , RP.CLASS_NM , RP.SORT_NM ,C.SUM_ADJUST \
						        , CI2.LAST_FROMDATE , CI2.LAST_TODATE , C.FROMDATE , C.TODATE , C.RATE \
								, C.PRICE , T.TAX_YN \
								, A.GP_TYP , A.FT_TYP, GC.NAME, A.WITH_ADDR, GS.AREA \
						        , C.SEQ , C.CAL_SUM_SEQ \
						        , RD.SI_NM , RD.GU_NM , RD.BJ_NM , T.TAX_GUBUN \
						        , GS.REDUCTION_RATE , GS.REDUCTION_REASON , C.SURCHARGE_RATE , T.SIGU_CD \
						        , T.DEPT_CD , T.OBJ_SET , T.TAXPAYER_ID , T.OCR_SIGU_CD, T.OCR_BUSEO_CD \
						        , T.TAX_CD , T.LIVE , T.ADD_SET , T.ADD_YN , T.SUBUSEO_CD , C.SUM_LASTYEAR , A.TYPE , A.SECTION , RC.NAME SECTION_NAME \
						        , T.TAXPAYER_SET , A.PLACE_A \
						FROM GAPAN_INFO A, GAPAN_HEAD B ,GAPAN_CALCULATION_INFO C, GAPAN_CAL_SUM_INFO GS, GAPAN_TAXATION_INFO T ,REF_PURPOSECODE RP , GAPAN_CODE GC ,REF_DONGCODE RD , REF_COMMONCODE RC \
							,(SELECT GAPAN_NO,SUM(AREA_AFTER) AS AREA_AFTER FROM GAPAN_CALCULATION_INFO \
						    	WHERE USE_SECTION = 2 AND YEAR = ? GROUP BY GAPAN_NO \
						     ) C2  \
						    ,(SELECT GAPAN_NO, FROMDATE LAST_FROMDATE, TODATE LAST_TODATE \
      							FROM GAPAN_CALCULATION_INFO WHERE  YEAR = ? \
    						 ) CI2 \
						WHERE A.GAPAN_NO = B.GAPAN_NO \
						AND A.GAPAN_NO = C.GAPAN_NO \
						AND A.GAPAN_NO = GS.GAPAN_NO \
						AND A.GAPAN_NO = T.GAPAN_NO \
						AND A.PURPOSE_CD = RP.CODE \
						AND GC.TYPE = 'GP_TYP' \
						AND GC.CODE = A.GP_TYP \
						AND C2.GAPAN_NO(+) = T.GAPAN_NO \
						AND A.GAPAN_NO = CI2.GAPAN_NO(+) \
						AND C.CAL_SUM_SEQ = GS.SEQ \
						AND GS.TAX_SEQ = T.SEQ \
						AND RD.SI_CD = SUBSTR(A.WITH_PNU,1,2) \
						AND RD.GU_CD = SUBSTR(A.WITH_PNU,3,3) \
						AND RD.BJ_CD = SUBSTR(A.WITH_PNU,6,3)||'00' \
						AND C.YEAR = SUBSTR(T.TAX_YM,0,4) \
						AND RC.TYPE = 'use_section' \
						AND T.TAX_GUBUN = RC.CODE \
						AND SUBSTR(T.TAX_YM,0,4) LIKE ? \
						AND SUBSTR(A.WITH_PNU,3,3) = ? \
						AND A.GP_TYP LIKE ? \
						AND A.TAX_SET LIKE ? \
						AND T.TAX_YN LIKE ? \
						AND T.TAX_DATE BETWEEN ? AND ? \
						AND A.PURPOSE_CD LIKE ? \
						AND SUBSTR(A.WITH_PNU,6,5) LIKE ? \
						AND B.OWNER_NAME LIKE ? \
						AND DECODE(C.SUM_ADJUST,NULL,'1', '2') LIKE ? \
						ORDER BY A.GAPAN_NO DESC \
						) \
)WHERE R_ID BETWEEN ? AND ?

Querys.gapan.junggi.getNowPrice = \
SELECT MAX(PRICE) PRICE \
  FROM ( \
        SELECT PRICE FROM GAPAN_NOW_PRICE WHERE GAPAN_NO= ? AND YEAR >= ? \
         UNION \
        SELECT '0' AS PRICE FROM DUAL \
       )
       
Querys.gapan.gapan.junggi.updateTaxseq = \
UPDATE GAPAN_CAL_SUM_INFO SET TAX_SEQ = ? WHERE SEQ = ?