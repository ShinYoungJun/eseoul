//\uc815\uae30/////////////////////////////////////////////////////////////////////////////////////////    
Querys.facility.junggi.searchList = \
SELECT AAA.R_ID, AAA.CORP_CD, AAA.GU_CODE, AAA.YEAR, AAA.OFFICE_NM, AAA.JIJUM_NM, AAA.JUM_SUM, AAA.NAME, AAA.M_COUNT, AAA.GAE_COUNT, AAA.CAL_YN, AAA.M_GAE \
  FROM ( \
 \
SELECT ROWNUM AS R_ID, AA.CORP_CD, AA.GU_CODE, AA.YEAR, AA.OFFICE_NM, AA.JIJUM_NM, AA.JUM_SUM, AA.NAME, AA.M_COUNT, AA.GAE_COUNT, AA.CAL_YN, AA.M_GAE \
  FROM ( \
 \
SELECT A.CORP_CD, A.GU_CODE, B.YEAR, RO.OFFICE_NM, nvl(RO.JIJUM_NM, '-') JIJUM_NM, A.JUM_SUM, A.NAME, A.M_COUNT, A.GAE_COUNT \
       , DECODE(B.CAL_YN,NULL,'0','1') CAL_YN \
       , C.M_COUNT || '(' || C.GAE_COUNT || ')' M_GAE \
  FROM ( \
 \
 \
SELECT B.CORP_CD, B.GU_CODE, NVL(A.JUM_SUM, 0) JUM_SUM, B.NAME, B.M_COUNT, B.GAE_COUNT \
  FROM ( \
 \
         SELECT ECS.CORP_CD, ECS.GU_CODE, SUM(ECS.SUM) JUM_SUM, RC.NAME \
           FROM EQUIP_CAL_SUM_INFO ECS, REF_COMMONCODE RC \
          WHERE RC.CODE = ECS.TAX_SET \
            AND RC.TYPE = 'taxation_section' \
            AND ECS.YEAR LIKE ? \
          GROUP BY ECS.CORP_CD, ECS.GU_CODE, RC.NAME \
         HAVING SUM(ECS.SUM) >0 \
 \
       ) A, ( \
 \
         SELECT B.CORP_CD, B.GU_CODE, SUM(M_COUNT) M_COUNT, SUM(GAE_COUNT) GAE_COUNT, RC.NAME \
           FROM ( SELECT B.CORP_CD, B.GU_CODE, B.REQUEST_NO, DECODE(B.DANWII, 'm', QUAN_SUM, 0) M_COUNT \
                         , DECODE(B.DANWII, '\uac1c', QUAN_SUM, 0) GAE_COUNT, B.DANWII, b.tax_set \
                    FROM ( SELECT A.CORP_CD, A.GU_CODE, A.REQUEST_NO, SUM(A.QUANTITY) QUAN_SUM, A.DANWII, A.TAX_SET \
                             FROM (SELECT EP.CORP_CD, EP.GU_CODE,EP.REQUEST_NO, EP.QUANTITY ,DECODE(RP.DANWII, '\u33a1', '\uac1c', RP.DANWII) DANWII \
                                          , EP.TAX_SET \
                                     FROM EQUIP_PLACE EP, REF_PURPOSECODE RP \
                                    WHERE EP.PURPOSE_CD = RP.CLASS_CD || RP.SORT_CD || KIND_CD \
                                    AND EP.SECTION = RP.SECTION \
                                  ) A  \
                            GROUP BY A.CORP_CD, A.GU_CODE, A.REQUEST_NO, A.DANWII, A.TAX_SET \
                         ) B \
                ) B, REF_COMMONCODE RC \
         WHERE RC.CODE = B.TAX_SET \
           AND RC.TYPE = 'taxation_section' \
         GROUP BY B.CORP_CD, B.GU_CODE, RC.NAME \
 \
       ) B \
 WHERE A.CORP_CD = B.CORP_CD \
   AND A.GU_CODE = B.GU_CODE \
   AND A.NAME = B.NAME \
   \
) A, \
 \
 \
( \
SELECT EP.CORP_CD,EP.GU_CODE, MAX(EC.GU_CODE ) AS CAL_YN, EP.YEAR \
  FROM EQUIP_PLACE EP, EQUIP_CALCULATION EC  \
  WHERE EP.GU_CODE = EC.GU_CODE(+) \
   AND EP.CORP_CD = EC.CORP_CD(+) \
   AND EP.REQUEST_NO = EC.REQUEST_NO(+) \
   AND EP.OBJECT_NO = EC.OBJECT_NO(+) \
 GROUP BY  EP.CORP_CD,EP.GU_CODE , EP.YEAR\
   ) B, \
 \
 \
( \
SELECT M_GAE.CORP_CD, M_GAE.GU_CODE, SUM(M_GAE.M_COUNT) M_COUNT, SUM(M_GAE.GAE_COUNT) GAE_COUNT, RC.NAME, M_GAE.YEAR \
  FROM \
        (SELECT B.CORP_CD, B.GU_CODE, B.REQUEST_NO, SUM(M_COUNT) M_COUNT, SUM(GAE_COUNT) GAE_COUNT, B.YEAR, B.TAX_SET \
           FROM ( SELECT B.CORP_CD, B.GU_CODE, B.REQUEST_NO, DECODE(B.DANWII, 'm', QUAN_SUM, 0) M_COUNT \
                         , DECODE(B.DANWII, '\uac1c', QUAN_SUM, 0) GAE_COUNT, B.DANWII, B.YEAR, B.TAX_SET \
                    FROM ( SELECT A.CORP_CD, A.GU_CODE, A.REQUEST_NO, SUM(A.QUANTITY) QUAN_SUM, A.DANWII, A.YEAR, A.TAX_SET \
                             FROM (SELECT EP.CORP_CD, EP.GU_CODE,EP.REQUEST_NO, EP.QUANTITY ,DECODE(RP.DANWII, '\u33a1', '\uac1c', RP.DANWII) DANWII \
                                          , EP.YEAR, EP.TAX_SET \
                                     FROM EQUIP_PLACE EP, REF_PURPOSECODE RP, EQUIP_CALCULATION EC \
                                    WHERE EP.PURPOSE_CD = RP.CLASS_CD || RP.SORT_CD || KIND_CD \
                                      AND EP.CORP_CD = EC.CORP_CD \
                                      AND EP.GU_CODE = EC.GU_CODE \
                                      AND EP.REQUEST_NO = EC.REQUEST_NO \
                                      AND EP.OBJECT_NO = EC.OBJECT_NO \
                                      AND EP.YEAR = EC.YEAR \
                                      AND EC.USE_SECTION = 2 \
                                      AND EP.SECTION = RP.SECTION  \
                                  ) A  \
                            GROUP BY A.CORP_CD, A.GU_CODE, A.REQUEST_NO, A.DANWII, A.YEAR, A.TAX_SET  \
                         ) B \
                ) B \
         GROUP BY B.CORP_CD, B.GU_CODE, B.YEAR, B.REQUEST_NO, B.TAX_SET) M_GAE, REF_COMMONCODE RC \
 WHERE RC.CODE = M_GAE.TAX_SET \
   AND RC.TYPE = 'taxation_section' \
 GROUP BY M_GAE.CORP_CD, M_GAE.GU_CODE , M_GAE.TAX_SET, RC.NAME, M_GAE.YEAR \
) C, REF_OFFICECODE RO \
 \
 \
 WHERE A.CORP_CD = B.CORP_CD \
   AND A.GU_CODE = B.GU_CODE \
   AND A.CORP_CD = C.CORP_CD(+) \
   AND A.GU_CODE = C.GU_CODE(+) \
   AND A.NAME = C.NAME(+) \
   AND A.CORP_CD = RO.OFFICE_CD || RO.JIJUM_CD \
   AND A.GU_CODE = RO.GU_CD \
   AND A.GU_CODE = ? \
   AND RO.OFFICE_NM LIKE ? \
 \
) AA \
 \
) AAA WHERE R_ID > (?-1)*? AND ROWNUM<= ?

Querys.facility.junggi.searchList_OLD = \
SELECT R_ID, OFFICE_NM, nvl(JIJUM_NM, '-') JIJUM_NM, CORP_CD, GU_CODE, REQUEST_NO, YEAR, SISE_JUM, GUSE_JUM \
       , SISE_M, SISE_GAE, GUSE_M, GUSE_GAE, CAL_YN  \
  FROM ( \
SELECT ROWNUM AS R_ID, OFFICE_NM, JIJUM_NM , CORP_CD, GU_CODE, REQUEST_NO, YEAR, SISE_JUM, GUSE_JUM, SISE_M, SISE_GAE, GUSE_M, GUSE_GAE, CAL_YN \
  FROM ( \
 \
SELECT A.CORP_CD , A.GU_CODE, A.REQUEST_NO, B.YEAR, A.OFFICE_NM, A.JIJUM_NM, A.SISE_JUM, A.GUSE_JUM, A.SISE_M, A.SISE_GAE, A.GUSE_M, A.GUSE_GAE  \
       , DECODE(B.CAL_YN,NULL,'0','1') CAL_YN \
  FROM (  \
  \
SELECT A.CORP_CD , A.GU_CODE, A.REQUEST_NO, SUM(A.SISE_JUM) SISE_JUM, SUM(A.GUSE_JUM) GUSE_JUM, RO.OFFICE_NM, RO.JIJUM_NM \
       , SUM(A.SISE_M) SISE_M, SUM(A.SISE_GAE) SISE_GAE \
       , SUM(A.GUSE_M) GUSE_M, SUM(A.GUSE_GAE) GUSE_GAE \
  FROM ( \
\
    SELECT A.CORP_CD, A.GU_CODE, A.REQUEST_NO \
           , DECODE(A.NAME, '\uc2dc\uc138', A.JUM_SUM, 0) SISE_JUM \
           , DECODE(A.NAME, '\uad6c\uc138', A.JUM_SUM, 0) GUSE_JUM \
           , DECODE(A.NAME, '\uc2dc\uc138', A.M_COUNT, 0) SISE_M \
           , DECODE(A.NAME, '\uad6c\uc138', A.M_COUNT, 0) GUSE_M \
           , DECODE(A.NAME, '\uc2dc\uc138', A.GAE_COUNT, 0) SISE_GAE \
           , DECODE(A.NAME, '\uad6c\uc138', A.GAE_COUNT, 0) GUSE_GAE \
    FROM ( \
\
SELECT B.CORP_CD, B.GU_CODE, B.REQUEST_NO, NVL(A.JUM_SUM, 0) JUM_SUM \
       , B.NAME \
       , B.M_COUNT, B.GAE_COUNT \
  FROM ( \
\
         SELECT ECS.CORP_CD, ECS.GU_CODE, ECS.REQUEST_NO, SUM(ECS.SUM) JUM_SUM, RC.NAME \
           FROM EQUIP_CAL_SUM_INFO ECS, REF_COMMONCODE RC \
          WHERE RC.CODE = ECS.TAX_SET \
            AND RC.TYPE = 'taxation_section' \
          GROUP BY ECS.CORP_CD, ECS.GU_CODE, RC.NAME,ECS.REQUEST_NO \
         HAVING SUM(ECS.SUM) >0\
\
       ) A, ( \
\
         SELECT B.CORP_CD, B.GU_CODE, B.REQUEST_NO, SUM(M_COUNT) M_COUNT, SUM(GAE_COUNT) GAE_COUNT, RC.NAME \
           FROM ( SELECT B.CORP_CD, B.GU_CODE, B.REQUEST_NO, DECODE(B.DANWII, 'm', QUAN_SUM, 0) M_COUNT \
                         , DECODE(B.DANWII, '\uac1c', QUAN_SUM, 0) GAE_COUNT, B.DANWII, b.tax_set \
                    FROM ( SELECT A.CORP_CD, A.GU_CODE, A.REQUEST_NO, SUM(A.QUANTITY) QUAN_SUM, A.DANWII, A.TAX_SET \
                             FROM (SELECT EP.CORP_CD, EP.GU_CODE,EP.REQUEST_NO, EP.QUANTITY ,DECODE(RP.DANWII, '\u33a1', '\uac1c', RP.DANWII) DANWII \
                                          , EP.TAX_SET \
                                     FROM EQUIP_PLACE EP, REF_PURPOSECODE RP \
                                    WHERE EP.PURPOSE_CD = RP.CLASS_CD || RP.SORT_CD || KIND_CD \
                                  ) A  \
                            GROUP BY A.CORP_CD, A.GU_CODE, A.REQUEST_NO, A.DANWII, A.TAX_SET \
                         ) B \
                ) B, REF_COMMONCODE RC \
         WHERE RC.CODE = B.TAX_SET \
           AND RC.TYPE = 'taxation_section' \
         GROUP BY B.CORP_CD, B.GU_CODE, B.REQUEST_NO, RC.NAME \
\
       ) B \
 WHERE A.CORP_CD = B.CORP_CD \
   AND A.GU_CODE = B.GU_CODE \
   AND A.REQUEST_NO = B.REQUEST_NO \
   AND A.NAME = B.NAME \
\
         ) A \
         ) A, REF_OFFICECODE RO \
 WHERE A.CORP_CD = RO.OFFICE_CD || RO.JIJUM_CD \
   AND A.GU_CODE = RO.GU_CD \
 GROUP BY A.CORP_CD , A.GU_CODE, A.REQUEST_NO, RO.OFFICE_NM, RO.JIJUM_NM \
\
        ) A, ( \
\
SELECT EP.CORP_CD,EP.GU_CODE, MAX(EC.GU_CODE ) AS CAL_YN, EP.YEAR, EP.REQUEST_NO \
  FROM EQUIP_PLACE EP \
  LEFT JOIN EQUIP_CALCULATION EC \
    ON EP.GU_CODE = EC.GU_CODE \
   AND EP.CORP_CD = EC.CORP_CD \
   AND EP.REQUEST_NO = EC.REQUEST_NO \
   AND EP.OBJECT_NO = EC.OBJECT_NO    \
   AND EC.USE_SECTION = 1 \
 GROUP BY  EP.CORP_CD,EP.GU_CODE , EP.YEAR, EP.REQUEST_NO \
\
        )B \
 WHERE A.CORP_CD = B.CORP_CD \
   AND A.GU_CODE = B.GU_CODE \
   AND A.REQUEST_NO = B.REQUEST_NO \
   AND B.YEAR like ? \
   AND A.GU_CODE = ? \
   AND A.OFFICE_NM LIKE ? \
  ) A \
  )WHERE R_ID > (?-1)*? AND ROWNUM<= ?




//  \uc815\uae30 \uc870\ud68c  \uce74\uc6b4\ud2b8
Querys.facility.junggi.searchListCount = \
SELECT COUNT(*) \
  FROM ( \
 \
 \
SELECT B.CORP_CD, B.GU_CODE, NVL(A.JUM_SUM, 0) JUM_SUM, B.NAME, B.M_COUNT, B.GAE_COUNT \
  FROM ( \
 \
         SELECT ECS.CORP_CD, ECS.GU_CODE, SUM(ECS.SUM) JUM_SUM, RC.NAME \
           FROM EQUIP_CAL_SUM_INFO ECS, REF_COMMONCODE RC \
          WHERE RC.CODE = ECS.TAX_SET \
            AND RC.TYPE = 'taxation_section' \
          GROUP BY ECS.CORP_CD, ECS.GU_CODE, RC.NAME \
         HAVING SUM(ECS.SUM) >0 \
 \
       ) A, ( \
 \
         SELECT B.CORP_CD, B.GU_CODE, SUM(M_COUNT) M_COUNT, SUM(GAE_COUNT) GAE_COUNT, RC.NAME \
           FROM ( SELECT B.CORP_CD, B.GU_CODE, B.REQUEST_NO, DECODE(B.DANWII, 'm', QUAN_SUM, 0) M_COUNT \
                         , DECODE(B.DANWII, '\uac1c', QUAN_SUM, 0) GAE_COUNT, B.DANWII, b.tax_set \
                    FROM ( SELECT A.CORP_CD, A.GU_CODE, A.REQUEST_NO, SUM(A.QUANTITY) QUAN_SUM, A.DANWII, A.TAX_SET \
                             FROM (SELECT EP.CORP_CD, EP.GU_CODE,EP.REQUEST_NO, EP.QUANTITY ,DECODE(RP.DANWII, '\u33a1', '\uac1c', RP.DANWII) DANWII \
                                          , EP.TAX_SET \
                                     FROM EQUIP_PLACE EP, REF_PURPOSECODE RP \
                                    WHERE EP.PURPOSE_CD = RP.CLASS_CD || RP.SORT_CD || KIND_CD \
                                  ) A  \
                            GROUP BY A.CORP_CD, A.GU_CODE, A.REQUEST_NO, A.DANWII, A.TAX_SET \
                         ) B \
                ) B, REF_COMMONCODE RC \
         WHERE RC.CODE = B.TAX_SET \
           AND RC.TYPE = 'taxation_section' \
         GROUP BY B.CORP_CD, B.GU_CODE, RC.NAME \
 \
       ) B \
 WHERE A.CORP_CD = B.CORP_CD \
   AND A.GU_CODE = B.GU_CODE \
   AND A.NAME = B.NAME \
 \
) A, \
 \
 \
( \
SELECT EP.CORP_CD,EP.GU_CODE, MAX(EC.GU_CODE ) AS CAL_YN, EP.YEAR \
  FROM EQUIP_PLACE EP \
  LEFT JOIN EQUIP_CALCULATION EC \
    ON EP.GU_CODE = EC.GU_CODE \
   AND EP.CORP_CD = EC.CORP_CD \
   AND EP.REQUEST_NO = EC.REQUEST_NO \
   AND EP.OBJECT_NO = EC.OBJECT_NO \
 GROUP BY  EP.CORP_CD,EP.GU_CODE , EP.YEAR \
   ) B, \
\
\
( \
SELECT M_GAE.CORP_CD, M_GAE.GU_CODE, SUM(M_GAE.M_COUNT) M_COUNT, SUM(M_GAE.GAE_COUNT) GAE_COUNT \
  FROM EQUIP_TAXATION_INFO ETI, \
        (SELECT B.CORP_CD, B.GU_CODE, B.REQUEST_NO, SUM(M_COUNT) M_COUNT, SUM(GAE_COUNT) GAE_COUNT, B.YEAR \
           FROM ( SELECT B.CORP_CD, B.GU_CODE, B.REQUEST_NO, DECODE(B.DANWII, 'm', QUAN_SUM, 0) M_COUNT \
                         , DECODE(B.DANWII, '\uac1c', QUAN_SUM, 0) GAE_COUNT, B.DANWII, B.YEAR \
                    FROM ( SELECT A.CORP_CD, A.GU_CODE, A.REQUEST_NO, SUM(A.QUANTITY) QUAN_SUM, A.DANWII, A.YEAR \
                             FROM (SELECT EP.CORP_CD, EP.GU_CODE,EP.REQUEST_NO, EP.QUANTITY ,DECODE(RP.DANWII, '\u33a1', '\uac1c', RP.DANWII) DANWII, EP.YEAR \
                                     FROM EQUIP_PLACE EP, REF_PURPOSECODE RP \
                                    WHERE EP.PURPOSE_CD = RP.CLASS_CD || RP.SORT_CD || KIND_CD \
                                  ) A  \
                            GROUP BY A.CORP_CD, A.GU_CODE, A.REQUEST_NO, A.DANWII, A.YEAR \
                         ) B \
                ) B         \
         GROUP BY B.CORP_CD, B.GU_CODE, B.YEAR, B.REQUEST_NO) M_GAE \
 WHERE ETI.YEAR = M_GAE.YEAR \
   AND ETI.REQUEST_NO = M_GAE.REQUEST_NO \
   AND ETI.CORP_CD = M_GAE.CORP_CD \
   AND ETI.GU_CODE = M_GAE.GU_CODE \
   AND ETI.TAX_GUBUN = 2   \
 GROUP BY M_GAE.CORP_CD, M_GAE.GU_CODE \
) C, REF_OFFICECODE RO \
 \
 \
 WHERE A.CORP_CD = B.CORP_CD \
   AND A.GU_CODE = B.GU_CODE \
   AND A.CORP_CD = C.CORP_CD(+) \
   AND A.GU_CODE = C.GU_CODE(+) \
   AND A.CORP_CD = RO.OFFICE_CD || RO.JIJUM_CD \
   AND A.GU_CODE = RO.GU_CD \
   AND B.YEAR like ? \
   AND A.GU_CODE = ? \
   AND RO.OFFICE_NM LIKE ?
   
Querys.facility.junggi.searchListCount_OLD = \
SELECT COUNT(*) \
  FROM ( \  
  \
SELECT A.CORP_CD , A.GU_CODE, A.REQUEST_NO, B.YEAR, A.OFFICE_NM, A.JIJUM_NM, A.SISE_JUM, A.GUSE_JUM, A.SISE_M, A.SISE_GAE, A.GUSE_M, A.GUSE_GAE  \
       , DECODE(B.CAL_YN,NULL,'0','1') CAL_YN  \
  FROM (  \
  \
SELECT A.CORP_CD , A.GU_CODE, A.REQUEST_NO, SUM(A.SISE_JUM) SISE_JUM, SUM(A.GUSE_JUM) GUSE_JUM, RO.OFFICE_NM, RO.JIJUM_NM \
       , SUM(A.SISE_M) SISE_M, SUM(A.SISE_GAE) SISE_GAE \
       , SUM(A.GUSE_M) GUSE_M, SUM(A.GUSE_GAE) GUSE_GAE \
  FROM ( \
\
    SELECT A.CORP_CD, A.GU_CODE, A.REQUEST_NO \
           , DECODE(A.NAME, '\uc2dc\uc138', A.JUM_SUM, 0) SISE_JUM \
           , DECODE(A.NAME, '\uad6c\uc138', A.JUM_SUM, 0) GUSE_JUM \
           , DECODE(A.NAME, '\uc2dc\uc138', A.M_COUNT, 0) SISE_M \
           , DECODE(A.NAME, '\uad6c\uc138', A.M_COUNT, 0) GUSE_M \
           , DECODE(A.NAME, '\uc2dc\uc138', A.GAE_COUNT, 0) SISE_GAE \
           , DECODE(A.NAME, '\uad6c\uc138', A.GAE_COUNT, 0) GUSE_GAE \
    FROM ( \
\
SELECT B.CORP_CD, B.GU_CODE, B.REQUEST_NO, NVL(A.JUM_SUM, 0) JUM_SUM \
       , B.NAME \
       , B.M_COUNT, B.GAE_COUNT \
  FROM ( \
\
         SELECT ECS.CORP_CD, ECS.GU_CODE, ECS.REQUEST_NO, SUM(ECS.SUM) JUM_SUM, RC.NAME \
           FROM EQUIP_CAL_SUM_INFO ECS, REF_COMMONCODE RC \
          WHERE RC.CODE = ECS.TAX_SET \
            AND RC.TYPE = 'taxation_section' \
          GROUP BY ECS.CORP_CD, ECS.GU_CODE, RC.NAME,ECS.REQUEST_NO \
         HAVING SUM(ECS.SUM) >0 \
\
       ) A, ( \
\
         SELECT B.CORP_CD, B.GU_CODE, B.REQUEST_NO, SUM(M_COUNT) M_COUNT, SUM(GAE_COUNT) GAE_COUNT, RC.NAME \
           FROM ( SELECT B.CORP_CD, B.GU_CODE, B.REQUEST_NO, DECODE(B.DANWII, 'm', QUAN_SUM, 0) M_COUNT \
                         , DECODE(B.DANWII, '\uac1c', QUAN_SUM, 0) GAE_COUNT, B.DANWII, b.tax_set \
                    FROM ( SELECT A.CORP_CD, A.GU_CODE, A.REQUEST_NO, SUM(A.QUANTITY) QUAN_SUM, A.DANWII, A.TAX_SET \
                             FROM (SELECT EP.CORP_CD, EP.GU_CODE,EP.REQUEST_NO, EP.QUANTITY ,DECODE(RP.DANWII, '\u33a1', '\uac1c', RP.DANWII) DANWII \
                                          , EP.TAX_SET \
                                     FROM EQUIP_PLACE EP, REF_PURPOSECODE RP \
                                    WHERE EP.PURPOSE_CD = RP.CLASS_CD || RP.SORT_CD || KIND_CD \
                                  ) A  \
                            GROUP BY A.CORP_CD, A.GU_CODE, A.REQUEST_NO, A.DANWII, A.TAX_SET \
                         ) B \
                ) B, REF_COMMONCODE RC \
         WHERE RC.CODE = B.TAX_SET \
           AND RC.TYPE = 'taxation_section' \
         GROUP BY B.CORP_CD, B.GU_CODE, B.REQUEST_NO, RC.NAME \
\
       ) B \
 WHERE A.CORP_CD = B.CORP_CD \
   AND A.GU_CODE = B.GU_CODE \
   AND A.REQUEST_NO = B.REQUEST_NO \
   AND A.NAME = B.NAME \
\
         ) A \
         ) A, REF_OFFICECODE RO \
 WHERE A.CORP_CD = RO.OFFICE_CD || RO.JIJUM_CD \
   AND A.GU_CODE = RO.GU_CD \
 GROUP BY A.CORP_CD , A.GU_CODE, A.REQUEST_NO, RO.OFFICE_NM, RO.JIJUM_NM \
\
        ) A, ( \
\
SELECT EP.CORP_CD,EP.GU_CODE, MAX(EC.GU_CODE ) AS CAL_YN, EP.YEAR, EP.REQUEST_NO \
  FROM EQUIP_PLACE EP \
  LEFT JOIN EQUIP_CALCULATION EC \
    ON EP.GU_CODE = EC.GU_CODE \
   AND EP.CORP_CD = EC.CORP_CD \
   AND EP.REQUEST_NO = EC.REQUEST_NO \
   AND EP.OBJECT_NO = EC.OBJECT_NO    \
   AND EC.USE_SECTION = 1 \
 GROUP BY  EP.CORP_CD,EP.GU_CODE , EP.YEAR, EP.REQUEST_NO \
\
        )B \
 WHERE A.CORP_CD = B.CORP_CD \
   AND A.GU_CODE = B.GU_CODE \
   AND A.REQUEST_NO = B.REQUEST_NO \
   AND B.YEAR LIKE ? \
   AND A.GU_CODE = ?    \
   AND A.OFFICE_NM LIKE ? \
)
 


//cal_sumList
Querys.facility.junggi.cal_sumList_old = \
SELECT SEQ,GU_CODE,CORP_CD,REQUEST_NO,SEQ,YEAR,SUM_ADJUST,SUM,VAT,REDUCTION_RATE,REDUCTION_REASON \
,FORM_ADJUST,FROMDATE,TODATE,USE_SECTION FROM EQUIP_CAL_SUM_INFO \
WHERE GU_CODE = ? AND CORP_CD = ? AND REQUEST_NO = ?



//calculation_temp_insert
Querys.facility.junggi.junggiCalculationTempInsert = \
INSERT INTO EQUIP_CALCULATION \
(GU_CODE,CORP_CD,REQUEST_NO,OBJECT_NO,YEAR,SEQ,RATE,DEPTH_RATE,FROMDATE,TODATE,UP_DATE,PERIOD \
,USE_SECTION,FIRST_SEQ,CAL_SUM_SEQ,QUANTITY,TAX_SET) \
SELECT GU_CODE,CORP_CD,REQUEST_NO,OBJECT_NO,? AS YEAR,EQUIP_CALCULATION_SEQ.NEXTVAL,RATE,DETPH_RATE, \
?,?,?,'12',1,FIRST_SEQ,?,QUANTITY,TAX_SET \
FROM \
( SELECT  EC.SEQ AS FIRST_SEQ,EC.GU_CODE,EC.CORP_CD,EC.REQUEST_NO,EC.OBJECT_NO,EC.TAX_SET, \
	EC.SEQ,DECODE(RP.CHECK_YN,1,MOMEY,YOYUL)AS RATE,DEPTH_NUM ,EP.QUANTITY,MAX(DECODE(RD.RATE,NULL,0,RD.RATE))AS DETPH_RATE \
	FROM EQUIP_CALCULATION EC \
	JOIN 	( \
		SELECT A.QUANTITY,EP1.PURPOSE_CD,EP1.SECTION,EP1.GU_CODE,EP1.CORP_CD,EP1.REQUEST_NO,EP1.OBJECT_NO,EP1.DEPTH_NUM  FROM \
          ( \
          SELECT EP.ADMIN_NO,SUM(EP.QUANTITY) AS QUANTITY FROM EQUIP_PLACE EP  \
          JOIN EQUIP_CALCULATION EC ON EC.CORP_CD = EP.CORP_CD AND EC.GU_CODE = EP.GU_CODE AND EC.REQUEST_NO = EP.REQUEST_NO AND EC.OBJECT_NO = EP.OBJECT_NO \
          WHERE EC.SEQ = EC.FIRST_SEQ  AND EC.GU_CODE = ? AND EC.CORP_CD = ? AND EC.USE_SECTION = 2 AND EC.TAX_SET = ? \
          GROUP BY ADMIN_NO \
          )A JOIN EQUIP_PLACE EP1 ON EP1.ADMIN_NO = A.ADMIN_NO	AND EP1.QUANTITY>0 \
	)EP ON EC.GU_CODE = EP.GU_CODE AND EC.CORP_CD = EP.CORP_CD AND EP.REQUEST_NO = EC.REQUEST_NO AND \
	EP.OBJECT_NO = EC.OBJECT_NO \
	AND EC.SEQ = EC.FIRST_SEQ  AND EC.GU_CODE = ? AND EC.CORP_CD = ? AND EC.USE_SECTION = 2 AND EC.TAX_SET = ? \
	JOIN REF_PURPOSECODE RP ON RP.CODE = EP.PURPOSE_CD AND RP.SECTION = 4 \
	LEFT JOIN REF_DEPTH RD ON RD.DEPTH < EP.DEPTH_NUM \
	GROUP BY EC.SEQ,EC.GU_CODE,EC.CORP_CD,EC.REQUEST_NO,EC.OBJECT_NO,EC.TAX_SET,EC.SEQ,DECODE(RP.CHECK_YN,1,MOMEY,YOYUL),DEPTH_NUM,EP.QUANTITY \
	)A


//GET CALCULATION TAX_SET
Querys.facility.junggi.getCalculation_TaxSet = \
SELECT DISTINCT(TAX_SET) FROM EQUIP_CALCULATION WHERE GU_CODE = ? AND CORP_CD = ? AND USE_SECTION = 2

//junggi Equip_CAL_SUM_SEQ
Querys.facility.junggi.GetJunggi_Cal_Sum_Seq = \
SELECT MAX(SEQ) FROM( \
SELECT SEQ FROM EQUIP_CAL_SUM_INFO WHERE CORP_CD = ? AND GU_CODE = ? AND TAX_SET = ? AND YEAR = ? AND USE_SECTION = 1 \
UNION ALL SELECT 0 AS SEQ FROM DUAL )

//junggi get_last_sum
Querys.facility.junggi.GetEquip_LastSum_OLD = \
SELECT SUM_ADJUST , PERIOD , DECODE(PERIOD,12, SUM_ADJUST,SUM_ADJUST*12/PERIOD)AS SUM_LASTYEAR FROM EQUIP_CALCULATION EC \
JOIN ( SELECT TO_NUMBER(YEAR)-1 AS YEAR,FIRST_SEQ FROM EQUIP_CALCULATION WHERE SEQ = ? \
)A  ON EC.YEAR = A.YEAR AND EC.FIRST_SEQ = A.FIRST_SEQ

//junggi get_last_sum
Querys.facility.junggi.GetEquip_LastSum = \
SELECT SUM_ADJUST AS SUM_LASTYEAR, PERIOD , EC.QUANTITY AS QUANTITY FROM EQUIP_CALCULATION EC \
JOIN ( SELECT TO_NUMBER(YEAR)-1 AS YEAR,FIRST_SEQ FROM EQUIP_CALCULATION WHERE SEQ = ? \
)A  ON EC.YEAR = A.YEAR AND EC.FIRST_SEQ = A.FIRST_SEQ

//junggi CALCULATION_UPDATE
Querys.facility.junggi.calculation_update = \
UPDATE EQUIP_CALCULATION SET QUANTITY = ?,DEPTH_RATE = ?,RATE = ?,PRICE = ?,FROMDATE = ?,TODATE = ? \
,PERIOD = ?,SUM_LASTYEAR = ?,SUM_YEAR = ?,SUM_ADJUST = ?,ADJUSTMENT = ?,FORM = ?,FORM_ADJUST = ?WHERE SEQ = ?

//junggi getSum_SumAdjust
Querys.facility.junggi.getSum_SumAdjust = \
SELECT SUM(DECODE(SUM_ADJUST,NULL,0,SUM_ADJUST)) AS SUM_ADJUST FROM EQUIP_CALCULATION WHERE CAL_SUM_SEQ = ?


//junggi getSum_SumAdjust
Querys.facility.junggi.corpList = \
SELECT EA.GU_CODE,EA.CORP_CD,EA.NAME,EA.REGDATE  FROM EQUIP_APPEAL EA \
JOIN EQUIP_CAL_SUM_INFO ECSI ON EA.CORP_CD = ECSI.CORP_CD AND EA.GU_CODE = ECSI.GU_CODE \
WHERE EA.NAME LIKE ? AND SUBSTR(EA.REGDATE,0,4) LIKE ?
GROUP BY EA.GU_CODE,EA.CORP_CD,EA.NAME,EA.REGDATE

//junggi cal_sum_exist
Querys.facility.junggi.cal_sum_exist = \
SELECT COUNT(*) FROM EQUIP_CAL_SUM_INFO \
WHERE GU_CODE = ? AND CORP_CD = ? AND YEAR = ? AND TAX_SET = ? AND USE_SECTION = '1' AND SUM_ADJUST <> '0'

//SUM_ADJUST, AREA_AFTER \ud569\uacc4 SUM_SEQ\ubcc4
Querys.facility.junggi.getReduction = \
SELECT SEQ,REDUCTION_RATE, REDUCTION_REASON FROM EQUIP_CAL_SUM_INFO WHERE SEQ = ?

//CAL_SUM_INFO \uac10\uba74 \uc785\ub825(\uc218\uc815)
Querys.facility.junggi.cal_sum_reductionUpdate = \
UPDATE EQUIP_CAL_SUM_INFO SET REDUCTION_RATE = ? , REDUCTION_REASON = ? , SUM = TRUNC(SUM_ADJUST * (100-?)/10000,0)*100 \
, VAT = TRUNC(SUM_ADJUST * (100-?)/10000,0)*10 \
WHERE SEQ = ?


//cal_sumList
Querys.facility.junggi.cal_sumList = \
SELECT 	R_ID, SEQ, GU_CODE, CORP_CD, REQUEST_NO, YEAR, SUM_ADJUST, SUM, VAT, REDUCTION_RATE, REDUCTION_REASON \
		, FORM_ADJUST, FROMDATE, TODATE, USE_SECTION, TAX_SETNAME \
		, TAX_SET , USE_SECTION_NAME \
FROM ( \
	SELECT ROWNUM AS R_ID, SEQ, GU_CODE, CORP_CD, REQUEST_NO, YEAR, SUM_ADJUST, SUM, VAT, REDUCTION_RATE, REDUCTION_REASON \
			,FORM_ADJUST, FROMDATE, TODATE, USE_SECTION, TAX_SETNAME \
			, TAX_SET , USE_SECTION_NAME \
	FROM \
		( \
		SELECT  SEQ, GU_CODE, CORP_CD, REQUEST_NO, YEAR, SUM_ADJUST, SUM, VAT, REDUCTION_RATE, REDUCTION_REASON \
			,FORM_ADJUST, FROMDATE, TODATE, USE_SECTION, RC.NAME AS TAX_SETNAME \
			, TAX_SET , RC2.NAME AS USE_SECTION_NAME \
		FROM EQUIP_CAL_SUM_INFO EC \
		JOIN REF_COMMONCODE RC ON RC.CODE = EC.TAX_SET AND RC.TYPE = 'taxation_section' \
		JOIN REF_COMMONCODE RC2 ON RC2.CODE = EC.USE_SECTION AND RC2.TYPE = 'use_section' \
		WHERE GU_CODE = ? \
		AND CORP_CD = ? \
		AND TAX_SET = ? \
		AND SUM_ADJUST <> '0' \
		) \
) WHERE R_ID BETWEEN ? AND ? \
ORDER BY YEAR DESC


// cal_sum_info \ub9ac\uc2a4\ud2b8 \uce74\uc6b4\ud2b8 
Querys.facility.junggi.cal_sum_listCount = \
SELECT  COUNT(SEQ) \
FROM EQUIP_CAL_SUM_INFO EC \
JOIN REF_COMMONCODE RC ON RC.CODE = EC.TAX_SET AND RC.TYPE = 'taxation_section' \
JOIN REF_COMMONCODE RC2 ON RC2.CODE = EC.USE_SECTION AND RC2.TYPE = 'use_section' \
WHERE GU_CODE = ? \
AND CORP_CD = ? \
AND TAX_SET = ? \
AND SUM_ADJUST <> '0'

//calculation_list
Querys.facility.junggi.calculationList = \
SELECT 	EC.SEQ, EC.GU_CODE, EC.CORP_CD, EC.REQUEST_NO, EP.OBJECT_NO, EC.SUM_ADJUST, EP.PURPOSE_CD, EP.QUANTITY, EC.DEPTH_RATE, EP.DEPTH_NUM \
		, EC.RATE, EC.TAX_SET, EC.USE_SECTION ,RC.NAME AS USE_SECTION_NAME, RC2.NAME AS TAX_SET_NAME, RP.SORT_NM,RP.KIND_NM, EC.CAL_SUM_SEQ \
		, EC.SUM_YEAR  , EC2.SUM_ADJUST CAL_STATUS , EC.YEAR \
FROM EQUIP_CALCULATION EC \
JOIN (  \
		SELECT A.ADMIN_NO, A.QUANTITY, EP1.PURPOSE_CD, EP1.DEPTH_NUM, EP1.GU_CODE, EP1.CORP_CD,EP1.REQUEST_NO, EP1.OBJECT_NO, EP1.SECTION \
  		FROM  \
  			( \
	  		SELECT ADMIN_NO,SUM(QUANTITY) AS QUANTITY FROM EQUIP_PLACE GROUP BY ADMIN_NO \
  			) A  JOIN EQUIP_PLACE EP1 ON A.ADMIN_NO = EP1.ADMIN_NO)EP \
ON EC.GU_CODE = EP.GU_CODE AND EC.CORP_CD = EP.CORP_CD AND EC.REQUEST_NO = EP.REQUEST_NO AND EC.OBJECT_NO = EP.OBJECT_NO  \
JOIN REF_COMMONCODE RC ON RC.CODE = EC.USE_SECTION AND RC.TYPE = 'use_section'  \
JOIN REF_COMMONCODE RC2 ON RC2.CODE = EC.TAX_SET AND RC2.TYPE = 'taxation_section'  \
JOIN REF_PURPOSECODE RP ON RP.CODE = EP.PURPOSE_CD AND RP.SECTION = 4  \
LEFT OUTER JOIN EQUIP_CALCULATION EC2 ON EC.GU_CODE = EC2.GU_CODE AND EC.CORP_CD = EC2.CORP_CD AND EC.REQUEST_NO = EC2.REQUEST_NO AND EC.OBJECT_NO = EC2.OBJECT_NO AND EC2.YEAR=EC.YEAR+1 \
WHERE EC.CAL_SUM_SEQ = ? \
AND EC.YEAR = ? \
ORDER BY EC.REQUEST_NO DESC


//calculation_info
Querys.facility.junggi.calculationInfo = \
SELECT	A.YEAR, A.GU_CODE, A.CORP_CD, A.REQUEST_NO, A.OBJECT_NO, A.SEQ, A.RATE, A.DEPTH_RATE, A.SUM_ADJUST, A.FROMDATE, A.TODATE, A.FORM_ADJUST \
    	,A.FORM, A.UP_DATE, A.PERIOD, A.FIRST_SEQ, A.CAL_SUM_SEQ, A.QUANTITY, A.TAX_SET , A.FORM, A.SUM_LASTYEAR, A.SUM_YEAR \
    	, A.PRICE , A.USE_SECTION , EC.SUM , EC.SUM_ADJUST AS CAL_SUM_ADJUST , EC.REDUCTION_RATE \
    	, T.TAX_DATE, T.INDATE , T.OVERDATE , T.OVERTAX \
		, T.SIGU_CD , T.BJ_CD, T.TAX_NO, T.DEPT_CD, T.TAX_CD, T.TAX_GUBUN, T.OBJ_SET, T.TAXPAYER_ID \
 		, T.TAXPAYER_SET, T.OCR_SIGU_CD, T.OCR_BUSEO_CD, T.SEQ TSEQ , T.TAX_YN , T.LIVE \
FROM EQUIP_CALCULATION A, EQUIP_TAXATION_INFO T , EQUIP_CAL_SUM_INFO EC \
WHERE A.CAL_SUM_SEQ = T.SEQ(+) \
AND A.CAL_SUM_SEQ = EC.SEQ \
AND A.SEQ = ?


Querys.facility.junggi.getCountSameCalculation = \
SELECT COUNT(SEQ) FROM EQUIP_CALCULATION WHERE FIRST_SEQ = ? AND YEAR = ?


Querys.facility.junggi.getAreaSum = \
SELECT SUM(QUANTITY) FROM EQUIP_CALCULATION WHERE GU_CODE = ? AND CORP_CD = ? AND YEAR = ? AND TAX_SET = ?


//Equip_CALCULATION SUM_ADJUST \ud569\uacc4
Querys.facility.junggi.getEquip_Calculation_Sum_Adjust = \
SELECT SUM(SUM_ADJUST) AS SUM_ADJUST FROM EQUIP_CALCULATION WHERE GU_CODE=? AND CORP_CD = ? AND TAX_SET = ? AND YEAR = ?

// \uc0b0\ucd9c\uc815\ubcf4 \ub9ac\uc2a4\ud2b8 \uc218\uc815
Querys.facility.junggi.calculationList_purpose = \
SELECT	EC.GU_CODE, EC.CORP_CD, SUM(EC.QUANTITY) QUANTITY, EP.PURPOSE_CD , RP.SORT_NM, RP.KIND_NM \
		, EC.CAL_SUM_SEQ , EC.TAX_SET , RC.NAME AS TAX_SET_NAME \
FROM EQUIP_CALCULATION EC ,  EQUIP_PLACE EP , REF_PURPOSECODE RP , REF_COMMONCODE RC \
WHERE EC.GU_CODE = EP.GU_CODE \
AND EC.CORP_CD = EP.CORP_CD \
AND EC.REQUEST_NO = EP.REQUEST_NO \
AND EC.OBJECT_NO = EP.OBJECT_NO \
AND EC.CAL_SUM_SEQ = ? \
AND RP.CODE = EP.PURPOSE_CD \
AND RP.SECTION = 4 \
AND RC.CODE = EC.TAX_SET \
AND RC.TYPE = 'taxation_section' \
GROUP BY EC.GU_CODE, EC.CORP_CD, EP.PURPOSE_CD , RP.SORT_NM, RP.KIND_NM , EC.CAL_SUM_SEQ , EC.TAX_SET, RC.NAME \

// equip_taxation_info \uc785\ub825
Querys.facility.junggi.Equip_Taxation_InfoInsert = \
INSERT INTO EQUIP_TAXATION_INFO \
	(SIGU_CD, BJ_CD , TAX_NO , DEPT_CD , TAX_CD_GU , TAX_CD_MOK , TAX_CD_SE , TAX_GUBUN , TAX_YM , OBJ_SET \
	, TAXPAYER_ID , TAXPAYER_SET , LIVE , INDATE , OVERDATE , TAX_DATE , ADD_SET , ADD_YN , NOTES , LIMIT_SUM \
	, LIMIT_CNT , RATE , RATE_CAUSE , BONSE , GIGUM , GUKSE , SISE , GUSE , VAT , INTAX \
	, OVERTAX , FORM1 , FORM2 , GU_CODE , BUNNAP_NO , YEAR  , SUSI_NO , TAX_CD , SEQ , TAX_YN \
	, OCR_SIGU_CD , OCR_BUSEO_CD , SUBUSEO_CD , CORP_CD , REQUEST_NO , TYPE ) \
VALUES(?,?,?,?,?, ?,?,?,?,?,  ?,?,?,?,?, ?,?,?,?,?,  ?,?,?,?,?, ?,?,?,?,?,  ?,?,?,?,? ,?,?,?,?,?  ,?,?,?,?,? ,?)

// equip_taxation_info \uc218\uc815
Querys.facility.junggi.Equip_Taxation_InfoUpdate = \
UPDATE EQUIP_TAXATION_INFO SET \
	TAX_YM      = ? \
	, INDATE    = ? \
	, OVERDATE  = ? \
	, TAX_DATE  = ? \
	, VAT		= ? \
	, OVERTAX 	= ? \
	, FORM1     = ? \
	, FORM2     = ? \
	, BONSE 	= ? \
	, SISE		= ? \
	, GUSE		= ? \
	, INTAX		= ? \
	, RATE		= ? \
WHERE SEQ = ?

// equip_cal_sum_info \uc218\uc815
Querys.facility.junggi.equip_cal_sum_addUpdate = \
UPDATE EQUIP_CAL_SUM_INFO SET \
	SUM_ADJUST = ? \
	, VAT = ? \
	, SUM = ? \
	, FORM_ADJUST = ? \
	, UP_DATE = ? \
WHERE YEAR = ? AND CORP_CD = ? AND GU_CODE = ? AND SEQ = ?

Querys.facility.junggi.getCalculationCount = \
select count(*) from equip_calculation where gu_code=? and corp_cd=? and request_no = ? and year=? and object_no=?

Querys.facility.junggi.calculationLists = \
SELECT 	EC.SEQ, EC.GU_CODE, EC.CORP_CD, EC.REQUEST_NO, EP.OBJECT_NO, EC.SUM_ADJUST, EP.PURPOSE_CD, EP.QUANTITY, EC.DEPTH_RATE, EP.DEPTH_NUM \
		, EC.RATE, EC.TAX_SET, EC.USE_SECTION ,RC.NAME AS USE_SECTION_NAME, RC2.NAME AS TAX_SET_NAME, RP.SORT_NM,RP.KIND_NM, EC.CAL_SUM_SEQ \
		, EC.SUM_YEAR  , EC2.SUM_ADJUST CAL_STATUS , EC.YEAR \
FROM EQUIP_CALCULATION EC \
JOIN (  \
		SELECT A.ADMIN_NO, A.QUANTITY, EP1.PURPOSE_CD, EP1.DEPTH_NUM, EP1.GU_CODE, EP1.CORP_CD,EP1.REQUEST_NO, EP1.OBJECT_NO, EP1.SECTION \
  		FROM  \
  			( \
	  		SELECT ADMIN_NO,SUM(QUANTITY) AS QUANTITY FROM EQUIP_PLACE GROUP BY ADMIN_NO \
  			) A  JOIN EQUIP_PLACE EP1 ON A.ADMIN_NO = EP1.ADMIN_NO)EP \
ON EC.GU_CODE = EP.GU_CODE AND EC.CORP_CD = EP.CORP_CD AND EC.REQUEST_NO = EP.REQUEST_NO AND EC.OBJECT_NO = EP.OBJECT_NO  \
JOIN REF_COMMONCODE RC ON RC.CODE = EC.USE_SECTION AND RC.TYPE = 'use_section'  \
JOIN REF_COMMONCODE RC2 ON RC2.CODE = EC.TAX_SET AND RC2.TYPE = 'taxation_section'  \
JOIN REF_PURPOSECODE RP ON RP.CODE = EP.PURPOSE_CD AND RP.SECTION = 4  \
LEFT OUTER JOIN EQUIP_CALCULATION EC2 ON EC.GU_CODE = EC2.GU_CODE AND EC.CORP_CD = EC2.CORP_CD AND EC.REQUEST_NO = EC2.REQUEST_NO AND EC.OBJECT_NO = EC2.OBJECT_NO AND EC2.YEAR=EC.YEAR+1 \
WHERE EC.GU_CODE = ? AND EC.CORP_CD = ? AND EC.TAX_SET = ? \
AND EC.YEAR = ? \
ORDER BY EC.REQUEST_NO DESC
