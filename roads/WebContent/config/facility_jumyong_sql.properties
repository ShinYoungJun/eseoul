//\uc810\uc6a9\uc870\ud68c/////////////////////////////////////////////////////////////////////////////////////////    
//\uc810\uc6a9 \uc870\ud68c \ubc0f \uad00\ub9ac - \uc810\uc6a9 \uc870\ud68c

Querys.facility.occupancy.searchList_Old = \
SELECT R_ID,GU_CODE,CORP_CD,NAME,YEAR,OBJECT_COUNT,REGDATE,CHECK_YN_NAME,CHECK_YN,UP_DATE,REQUEST_NO  \
FROM(  \
	SELECT ROWNUM AS R_ID,GU_CODE,CORP_CD,YEAR,NAME,OBJECT_COUNT,REGDATE,CHECK_YN_NAME,CHECK_YN,UP_DATE,REQUEST_NO FROM    \
        (        \
			SELECT EAB.GU_CODE,EAB.CORP_CD,EAB.REQUEST_NO,EP.YEAR,RO.OFFICE_NM AS NAME,EP.OBJECT_COUNT,EAB.REGDATE, EAB.CHECK_YN, EAB.UP_DATE, R1.NAME AS CHECK_YN_NAME  \
				FROM    \
				(    \
				  SELECT CORP_CD,GU_CODE,REQUEST_NO,YEAR, COUNT(REQUEST_NO) AS OBJECT_COUNT    \
				  FROM EQUIP_PLACE    \
				  GROUP BY CORP_CD,GU_CODE,REQUEST_NO,YEAR  \
				)EP    \
                JOIN EQUIP_ADMIN_BASE EAB ON EAB.CORP_CD = EP.CORP_CD AND EAB.GU_CODE = EP.GU_CODE  AND EAB.REQUEST_NO = EP.REQUEST_NO  \
                JOIN REF_OFFICECODE RO  ON RO.OFFICE_CD||RO.JIJUM_CD = EAB.CORP_CD AND RO.GU_CD = EAB.GU_CODE  \
                JOIN REF_COMMONCODE R1 ON R1.CODE = EAB.CHECK_YN AND R1.TYPE = 'check_yn'    \
		WHERE EP.YEAR LIKE ?  \
		AND EAB.CHECK_YN LIKE ?  \
		AND RO.OFFICE_NM LIKE ?  \
		AND EAB.GU_CODE = ? \
		ORDER BY CHECK_YN ASC, UP_DATE DESC,REQUEST_NO DESC  \
		)    \
	)WHERE R_ID > (?-1)*? AND ROWNUM<= ?  \

Querys.facility.occupancy.searchList = \
	  select r_id, year, object_count, name, cal_no,  admin_no, gu_code, corp_cd, \
	decode(regdate,null,'',substr(regdate,0,4)||'/'||substr(regdate,5,2)||'/'||substr(regdate,7,2)) as regdate, \
	case when object_count = cal_no then ? \
	else  ?  end   \
	as cal_status   \
	from(  \
	select rownum r_id,year, \
	(select count(*) from equip_place2 where corp_cd = c.corp_cd and admin_no = c.admin_no) as object_count,   \
	d.name ||'/' || d.office as name, \
	(select count(*) from equip_calculation2 where gu_code= ?  and corp_cd = c.corp_cd and admin_no= c.admin_no) as cal_no , object_no, c.regdate, \
	c.corp_cd, c.gu_code, c.admin_no \
	from (  \
	select a.year, a.corp_cd, a.object_no, a.gu_code,  a.admin_no,   \
	(select regdate from equip_place2 where gu_code = ?  and corp_cd = b.corp_cd and object_no = b.max_object_no and admin_no = b.admin_no)  as regdate   \
	from equip_place2 a,(  \
	select corp_cd, admin_no, min(object_no) as min_object_no, max(object_no) as max_object_no from equip_place2                 \
	where gu_code = ? \
	group by corp_cd, admin_no) b  \
	where a.gu_code = ?  \
	and a.year like ?  \
	and a.object_no =  b.min_object_no  \
	and b.corp_cd = a.corp_cd  \
  	and b.admin_no = a.admin_no  \
  	order by regdate desc, admin_no desc \
  		) c, equip_appeal d   \
	where c.corp_cd = d.corp_cd    \
	and c.gu_code = d.gu_code   \
	and d.name||'/'||d.office like ?    \
	) WHERE R_ID > (?-1)*? AND ROWNUM<= ? \
	
  	

//\uc810\uc6a9 \uc870\ud68c \ubc0f \uad00\ub9ac - \uc810\uc6a9 \uc870\ud68c
Querys.facility.occupancy.searchListCount_old = \
select count(*) from( \
SELECT R_ID,GU_CODE,CORP_CD,NAME,YEAR,OBJECT_COUNT,REGDATE,CHECK_YN_NAME,CHECK_YN,UP_DATE,REQUEST_NO  \
FROM(  \
	SELECT ROWNUM AS R_ID,GU_CODE,CORP_CD,YEAR,NAME,OBJECT_COUNT,REGDATE,CHECK_YN_NAME,CHECK_YN,UP_DATE,REQUEST_NO FROM    \
        (        \
			SELECT EAB.GU_CODE,EAB.CORP_CD,EAB.REQUEST_NO,EP.YEAR,RO.OFFICE_NM AS NAME,EP.OBJECT_COUNT,EAB.REGDATE, EAB.CHECK_YN, EAB.UP_DATE, R1.NAME AS CHECK_YN_NAME  \
				FROM    \
				(    \
				  SELECT CORP_CD,GU_CODE,REQUEST_NO,YEAR, COUNT(REQUEST_NO) AS OBJECT_COUNT    \
				  FROM EQUIP_PLACE    \
				  GROUP BY CORP_CD,GU_CODE,REQUEST_NO,YEAR  \
				)EP    \
                JOIN EQUIP_ADMIN_BASE EAB ON EAB.CORP_CD = EP.CORP_CD AND EAB.GU_CODE = EP.GU_CODE  AND EAB.REQUEST_NO = EP.REQUEST_NO  \
                JOIN REF_OFFICECODE RO  ON RO.OFFICE_CD||RO.JIJUM_CD = EAB.CORP_CD AND RO.GU_CD = EAB.GU_CODE  \
                JOIN REF_COMMONCODE R1 ON R1.CODE = EAB.CHECK_YN AND R1.TYPE = 'check_yn'    \
		WHERE EP.YEAR LIKE ?  \
		AND EAB.CHECK_YN LIKE ?  \
		AND RO.OFFICE_NM LIKE ?  \
		AND EAB.GU_CODE = ? \
		)))    \
		
		
Querys.facility.occupancy.searchListCount = \
	select count(*) \
	from (   \
	select a.year, a.corp_cd, a.object_no, a.gu_code \
	from equip_place2 a,( \
	select corp_cd, admin_no, min(object_no) as min_object_no from equip_place2 \
	where gu_code = ? \
	group by corp_cd, admin_no ) b \
	where a.gu_code = ? \
	and a.year like ? \
	and a.object_no =  b.min_object_no \
	and b.corp_cd = a.corp_cd \
	and b.admin_no = a.admin_no \
	order by b.corp_cd desc \
	) c, equip_appeal d \
	where c.corp_cd = d.corp_cd \
	and c.gu_code = d.gu_code  \
	and d.name||'/'||d.office like ? \  
	 
	
	
Querys.facility.occupancy.searchListCounted = \
	SELECT COUNT(*) \
		FROM   \
		(   \
		  SELECT CORP_CD,GU_CODE,REQUEST_NO, COUNT(REQUEST_NO) AS OBJECT_COUNT   \
		  FROM EQUIP_PLACE   \
		  GROUP BY CORP_CD,GU_CODE,REQUEST_NO   \
		)EP   \
                JOIN EQUIP_ADMIN_BASE EAB ON EAB.CORP_CD = EP.CORP_CD AND EAB.GU_CODE = EP.GU_CODE   AND EAB.REQUEST_NO = EP.REQUEST_NO \
                JOIN REF_OFFICECODE RO  ON RO.OFFICE_CD||RO.JIJUM_CD = EAB.CORP_CD AND RO.GU_CD = EAB.GU_CODE \
                JOIN REF_COMMONCODE R1 ON R1.CODE = EAB.CHECK_YN AND R1.TYPE = 'check_yn'   \
		WHERE EAB.UP_DATE LIKE ?   \
		AND EAB.CHECK_YN LIKE ?   \
		AND RO.OFFICE_NM LIKE ?   \
		AND EAB.GU_CODE = ? 


//	\uc0b0\ucd9c - \ubb3c\uac74 \ub9ac\uc2a4\ud2b8
Querys.facility.occupancy.productPlaceList_oldd = \
SELECT R_ID,OBJECT_NO,PURPOSE_CD,SORT_NM,KIND_NM,QUANTITY,DEPTH_NUM,TAX_SET,NAME,RATE \
FROM \
( \
  SELECT  ROWNUM AS R_ID,OBJECT_NO,PURPOSE_CD,SORT_NM,KIND_NM,QUANTITY,DEPTH_NUM,TAX_SET,NAME,RATE \
  FROM \
  ( \
    SELECT EP.OBJECT_NO,EP.PURPOSE_CD,RP1.SORT_NM,RP1.KIND_NM,EP.QUANTITY, EP.DEPTH_NUM,EP.TAX_SET,RC.NAME  \
      ,MAX(DECODE(RD.RATE,NULL,0,RD.RATE)) AS RATE  \
      FROM EQUIP_PLACE EP  \
      JOIN REF_PURPOSECODE RP1 ON RP1.CODE = EP.PURPOSE_CD AND RP1.SECTION = 4 \
      JOIN REF_COMMONCODE RC ON RC.CODE = EP.TAX_SET AND RC.TYPE = 'taxation_section'  \
      LEFT JOIN REF_DEPTH RD ON RD.DEPTH < EP.DEPTH_NUM  \
    WHERE GU_CODE=? AND CORP_CD = ? AND REQUEST_NO = ? \
    GROUP BY OBJECT_NO,EP.PURPOSE_CD,RP1.SORT_NM,RP1.KIND_NM,EP.QUANTITY, EP.DEPTH_NUM,EP.TAX_SET,RC.NAME \
  ) \
)WHERE R_ID > (?-1)*? AND ROWNUM<= ? \
ORDER BY OBJECT_NO DESC


Querys.facility.occupancy.productPlaceList = \
  SELECT  ROWNUM AS R_ID,OBJECT_NO,PURPOSE_CD,SORT_NM,KIND_NM,QUANTITY,DEPTH_NUM,TAX_SET,B.NAME,RATE ,SEBU_NM,SUM_ADJUST, CAL_STATUS, RC2.NAME AS CAL_STATUS_NAME, B.YEAR \
  FROM \
  ( \
      SELECT  ROWNUM AS R_ID,A.OBJECT_NO,A.PURPOSE_CD,A.SORT_NM,A.KIND_NM,A.QUANTITY,A.DEPTH_NUM,A.TAX_SET,A.NAME,A.RATE ,SEBU_NM \
      , ECI.SUM_ADJUST, DECODE(ECI.SUM_ADJUST,NULL,1,2) AS CAL_STATUS, A.YEAR \
      FROM \
      (  \
    SELECT EP.GU_CODE,EP.CORP_CD,EP.REQUEST_NO,EP.OBJECT_NO,EP.YEAR,PURPOSE_CD,PURPOSESEBU_CD \
    ,QUANTITY,DEPTH_NUM,TAX_SET,RP1.SORT_NM,RP1.KIND_NM \
    ,(select SEBU_NM from REF_PURPOSESEBU where CODE=EP.PURPOSE_CD AND SEBU_CD = EP.PURPOSESEBU_CD) AS SEBU_NM	\
    ,RC.NAME \
      ,MAX(DECODE(RD.RATE,NULL,0,RD.RATE)) AS RATE  \
          FROM EQUIP_PLACE EP  \
          JOIN REF_PURPOSECODE RP1 ON RP1.CODE = EP.PURPOSE_CD AND RP1.SECTION = 4 \
          LEFT JOIN REF_PURPOSESEBU RPCD ON RPCD.CODE = EP.PURPOSESEBU_CD      \
          LEFT JOIN REF_DEPTH RD ON RD.DEPTH < EP.DEPTH_NUM  \
          JOIN REF_COMMONCODE RC ON RC.CODE = EP.TAX_SET AND RC.TYPE = 'taxation_section'  \
        WHERE EP.GU_CODE=? AND EP.CORP_CD = ? AND EP.REQUEST_NO = ? \
        GROUP BY EP.GU_CODE,EP.CORP_CD,EP.REQUEST_NO,EP.OBJECT_NO,EP.YEAR,PURPOSE_CD,PURPOSESEBU_CD \
    ,QUANTITY,DEPTH_NUM,TAX_SET,RP1.SORT_NM,RP1.KIND_NM, RPCD.SEBU_NM,RC.NAME \
    )A LEFT JOIN EQUIP_CALCULATION ECI ON ECI.GU_CODE = A.GU_CODE AND ECI.CORP_CD = A.CORP_CD AND ECI.REQUEST_NO = A.REQUEST_NO \
    AND ECI.OBJECT_NO = A.OBJECT_NO AND ECI.YEAR = A.YEAR AND ECI.USE_SECTION = 2 \
)B JOIN REF_COMMONCODE RC2 ON RC2.CODE = B.CAL_STATUS AND RC2.TYPE = 'cal_status' \
WHERE R_ID between ? and ?	\
ORDER BY OBJECT_NO DESC

Querys.facility.occupancy.productPlaceBoardList_OLD_20111121 = \
  SELECT  ROWNUM AS R_ID,OBJECT_NO,PURPOSE_CD,SORT_NM,KIND_NM,QUANTITY,DEPTH_NUM,TAX_SET,B.NAME,RATE ,SEBU_NM,SUM_ADJUST, CAL_STATUS, RC2.NAME AS CAL_STATUS_NAME, B.YEAR, \
  (SELECT DEPTH_RATE FROM EQUIP_CALCULATION WHERE GU_CODE = B.GU_CODE AND CORP_CD = B.CORP_CD AND REQUEST_NO = B.REQUEST_NO AND OBJECT_NO = B.OBJECT_NO AND YEAR = B.YEAR) DEPTH_RATE \
  FROM \
  ( \
      SELECT  ROWNUM AS R_ID, A.GU_CODE, A.CORP_CD, A.REQUEST_NO, A.OBJECT_NO,A.PURPOSE_CD,A.SORT_NM,A.KIND_NM,A.QUANTITY,A.DEPTH_NUM,A.TAX_SET,A.NAME,A.RATE ,SEBU_NM \
      , ECI.SUM_ADJUST, DECODE(ECI.SUM_ADJUST,NULL,1,2) AS CAL_STATUS, A.YEAR \
      FROM \
      (  \
    SELECT EP.GU_CODE,EP.CORP_CD,EP.REQUEST_NO,EP.OBJECT_NO,EP.YEAR,PURPOSE_CD,PURPOSESEBU_CD \
    ,QUANTITY,DEPTH_NUM,TAX_SET,RP1.SORT_NM,RP1.KIND_NM \
    ,(select SEBU_NM from REF_PURPOSESEBU where CODE=EP.PURPOSE_CD AND SEBU_CD = EP.PURPOSESEBU_CD) AS SEBU_NM	\
    ,RC.NAME \
      ,MAX(DECODE(RD.RATE,NULL,0,RD.RATE)) AS RATE  \
          FROM EQUIP_PLACE EP  \
          JOIN REF_PURPOSECODE RP1 ON RP1.CODE = EP.PURPOSE_CD AND RP1.SECTION = 4 \
          LEFT JOIN REF_PURPOSESEBU RPCD ON RPCD.CODE = EP.PURPOSESEBU_CD      \
          LEFT JOIN REF_DEPTH RD ON RD.DEPTH < EP.DEPTH_NUM  \
          JOIN REF_COMMONCODE RC ON RC.CODE = EP.TAX_SET AND RC.TYPE = 'taxation_section'  \
        WHERE EP.GU_CODE=? AND EP.CORP_CD = ? AND EP.REQUEST_NO = ? \
        GROUP BY EP.GU_CODE,EP.CORP_CD,EP.REQUEST_NO,EP.OBJECT_NO,EP.YEAR,PURPOSE_CD,PURPOSESEBU_CD \
    ,QUANTITY,DEPTH_NUM,TAX_SET,RP1.SORT_NM,RP1.KIND_NM, RPCD.SEBU_NM,RC.NAME \
    )A LEFT JOIN EQUIP_CALCULATION ECI ON ECI.GU_CODE = A.GU_CODE AND ECI.CORP_CD = A.CORP_CD AND ECI.REQUEST_NO = A.REQUEST_NO \
    AND ECI.OBJECT_NO = A.OBJECT_NO AND ECI.YEAR = A.YEAR AND ECI.USE_SECTION = 2 \
)B JOIN REF_COMMONCODE RC2 ON RC2.CODE = B.CAL_STATUS AND RC2.TYPE = 'cal_status' \
WHERE R_ID between ? and ?	\
ORDER BY OBJECT_NO DESC



Querys.facility.occupancy.productPlaceBoardList = \
	  SELECT  ROWNUM AS R_ID,OBJECT_NO,PURPOSE_CD,SORT_NM,KIND_NM,QUANTITY,DEPTH_NUM,TAX_SET,B.NAME,RATE ,SEBU_NM,SUM_ADJUST, CAL_STATUS, RC2.NAME AS CAL_STATUS_NAME, B.YEAR, \
	  (SELECT DEPTH_RATE FROM EQUIP_CALCULATION2 WHERE GU_CODE = B.GU_CODE AND CORP_CD = B.CORP_CD AND OBJECT_NO = B.OBJECT_NO AND YEAR = B.YEAR) DEPTH_RATE \
	  FROM \
	  ( \
	      SELECT  ROWNUM AS R_ID, A.GU_CODE, A.CORP_CD, A.OBJECT_NO,A.PURPOSE_CD,A.SORT_NM,A.KIND_NM,A.QUANTITY,A.DEPTH_NUM,A.TAX_SET,A.NAME,A.RATE ,SEBU_NM \
	      , ECI.SUM_ADJUST, DECODE(ECI.SUM_ADJUST,NULL,1,2) AS CAL_STATUS, A.YEAR  \
	      FROM  \
	      (   \
	    SELECT EP.GU_CODE,EP.CORP_CD,EP.OBJECT_NO,EP.YEAR,PURPOSE_CD,PURPOSESEBU_CD \
	     ,QUANTITY,DEPTH_NUM,TAX_SET,RP1.SORT_NM,RP1.KIND_NM \
	    ,(select SEBU_NM from REF_PURPOSESEBU where CODE=EP.PURPOSE_CD AND SEBU_CD = EP.PURPOSESEBU_CD) AS SEBU_NM \
	    ,RC.NAME \
	      ,MAX(DECODE(RD.RATE,NULL,0,RD.RATE)) AS RATE , EP.ADMIN_NO  \
	          FROM EQUIP_PLACE2 EP   \
	          JOIN REF_PURPOSECODE RP1 ON RP1.CODE = EP.PURPOSE_CD AND RP1.SECTION = 4 \
	          LEFT JOIN REF_PURPOSESEBU RPCD ON RPCD.CODE = EP.PURPOSESEBU_CD \
	          LEFT JOIN REF_DEPTH RD ON RD.DEPTH < EP.DEPTH_NUM \
	          JOIN REF_COMMONCODE RC ON RC.CODE = EP.TAX_SET AND RC.TYPE = 'taxation_section' \
	          WHERE EP.GU_CODE= ?  AND EP.CORP_CD = ?  AND EP.ADMIN_NO = ? \
	        GROUP BY EP.GU_CODE,EP.CORP_CD,EP.ADMIN_NO,EP.OBJECT_NO,EP.YEAR,PURPOSE_CD,PURPOSESEBU_CD \
	    ,QUANTITY,DEPTH_NUM,TAX_SET,RP1.SORT_NM,RP1.KIND_NM, RPCD.SEBU_NM,RC.NAME    \
	    )A LEFT JOIN EQUIP_CALCULATION2 ECI ON ECI.GU_CODE = A.GU_CODE AND ECI.CORP_CD = A.CORP_CD  AND ECI.ADMIN_NO = A.ADMIN_NO  \
	    AND ECI.OBJECT_NO = A.OBJECT_NO AND ECI.YEAR = A.YEAR AND ECI.USE_SECTION = 2 \
	)B JOIN REF_COMMONCODE RC2 ON RC2.CODE = B.CAL_STATUS AND RC2.TYPE = 'cal_status' \
	WHERE R_ID between ? and ?  \
	ORDER BY OBJECT_NO DESC




Querys.facility.occupancy.productPlaceBoardCalList = \
	  SELECT  ROWNUM AS R_ID,OBJECT_NO,PURPOSE_CD,SORT_NM,KIND_NM,QUANTITY,DEPTH_NUM,TAX_SET,B.NAME,RATE ,SEBU_NM,SUM_ADJUST, CAL_STATUS, RC2.NAME AS CAL_STATUS_NAME, B.YEAR, B.MOMEY, \
	  (SELECT DEPTH_RATE FROM EQUIP_CALCULATION2 WHERE GU_CODE = B.GU_CODE AND CORP_CD = B.CORP_CD AND OBJECT_NO = B.OBJECT_NO AND YEAR = B.YEAR) DEPTH_RATE \
	  FROM \
	  ( \
	      SELECT  ROWNUM AS R_ID, A.GU_CODE, A.CORP_CD, A.OBJECT_NO,A.PURPOSE_CD,A.SORT_NM,A.KIND_NM,A.QUANTITY,A.DEPTH_NUM,A.TAX_SET,A.NAME,A.RATE ,SEBU_NM \
	      , ECI.SUM_ADJUST, DECODE(ECI.SUM_ADJUST,NULL,1,2) AS CAL_STATUS, A.YEAR, A.MOMEY  \
	      FROM  \
	      (   \
	    SELECT EP.GU_CODE,EP.CORP_CD,EP.OBJECT_NO,EP.YEAR,PURPOSE_CD,PURPOSESEBU_CD \
	     ,QUANTITY,DEPTH_NUM,TAX_SET,RP1.SORT_NM,RP1.KIND_NM, RP1.MOMEY \
	    ,(select SEBU_NM from REF_PURPOSESEBU where CODE=EP.PURPOSE_CD AND SEBU_CD = EP.PURPOSESEBU_CD) AS SEBU_NM \
	    ,RC.NAME \
	      ,MAX(DECODE(RD.RATE,NULL,0,RD.RATE)) AS RATE , EP.ADMIN_NO  \
	          FROM EQUIP_PLACE2 EP   \
	          JOIN REF_PURPOSECODE RP1 ON RP1.CODE = EP.PURPOSE_CD AND RP1.SECTION = 4 \
	          LEFT JOIN REF_PURPOSESEBU RPCD ON RPCD.CODE = EP.PURPOSESEBU_CD \
	          LEFT JOIN REF_DEPTH RD ON RD.DEPTH < EP.DEPTH_NUM \
	          JOIN REF_COMMONCODE RC ON RC.CODE = EP.TAX_SET AND RC.TYPE = 'taxation_section' \
	          WHERE EP.GU_CODE= ?  AND EP.CORP_CD = ?  AND EP.ADMIN_NO = ? \
	        GROUP BY EP.GU_CODE,EP.CORP_CD,EP.ADMIN_NO,EP.OBJECT_NO,EP.YEAR,PURPOSE_CD,PURPOSESEBU_CD, RP1.MOMEY \
	    ,QUANTITY,DEPTH_NUM,TAX_SET,RP1.SORT_NM,RP1.KIND_NM, RPCD.SEBU_NM,RC.NAME    \
	    )A LEFT JOIN EQUIP_CALCULATION2 ECI ON ECI.GU_CODE = A.GU_CODE AND ECI.CORP_CD = A.CORP_CD  AND ECI.ADMIN_NO = A.ADMIN_NO  \
	    AND ECI.OBJECT_NO = A.OBJECT_NO AND ECI.YEAR = A.YEAR AND ECI.USE_SECTION = 2 \
	)B JOIN REF_COMMONCODE RC2 ON RC2.CODE = B.CAL_STATUS AND RC2.TYPE = 'cal_status' \
    where cal_status = '1' \
	ORDER BY OBJECT_NO DESC	
		
Querys.facility.occupancy.productPlaceBoardCalList_bak120315 = \
	  SELECT  ROWNUM AS R_ID,OBJECT_NO,PURPOSE_CD,SORT_NM,KIND_NM,QUANTITY,DEPTH_NUM,TAX_SET,B.NAME,RATE ,SEBU_NM,SUM_ADJUST, CAL_STATUS, RC2.NAME AS CAL_STATUS_NAME, B.YEAR, B.MOMEY, \
	  (SELECT DEPTH_RATE FROM EQUIP_CALCULATION2 WHERE GU_CODE = B.GU_CODE AND CORP_CD = B.CORP_CD AND OBJECT_NO = B.OBJECT_NO AND YEAR = B.YEAR) DEPTH_RATE \
	  FROM \
	  ( \
	      SELECT  ROWNUM AS R_ID, A.GU_CODE, A.CORP_CD, A.OBJECT_NO,A.PURPOSE_CD,A.SORT_NM,A.KIND_NM,A.QUANTITY,A.DEPTH_NUM,A.TAX_SET,A.NAME,A.RATE ,SEBU_NM \
	      , ECI.SUM_ADJUST, DECODE(ECI.SUM_ADJUST,NULL,1,2) AS CAL_STATUS, A.YEAR, A.MOMEY  \
	      FROM  \
	      (   \
	    SELECT EP.GU_CODE,EP.CORP_CD,EP.OBJECT_NO,EP.YEAR,PURPOSE_CD,PURPOSESEBU_CD \
	     ,QUANTITY,DEPTH_NUM,TAX_SET,RP1.SORT_NM,RP1.KIND_NM, RP1.MOMEY \
	    ,(select SEBU_NM from REF_PURPOSESEBU where CODE=EP.PURPOSE_CD AND SEBU_CD = EP.PURPOSESEBU_CD) AS SEBU_NM \
	    ,RC.NAME \
	      ,MAX(DECODE(RD.RATE,NULL,0,RD.RATE)) AS RATE , EP.ADMIN_NO  \
	          FROM EQUIP_PLACE2 EP   \
	          JOIN REF_PURPOSECODE RP1 ON RP1.CODE = EP.PURPOSE_CD AND RP1.SECTION = 4 \
	          LEFT JOIN REF_PURPOSESEBU RPCD ON RPCD.CODE = EP.PURPOSESEBU_CD \
	          LEFT JOIN REF_DEPTH RD ON RD.DEPTH < EP.DEPTH_NUM \
	          JOIN REF_COMMONCODE RC ON RC.CODE = EP.TAX_SET AND RC.TYPE = 'taxation_section' \
	          WHERE EP.GU_CODE= ?  AND EP.CORP_CD = ?  AND EP.ADMIN_NO = ? \
	        GROUP BY EP.GU_CODE,EP.CORP_CD,EP.ADMIN_NO,EP.OBJECT_NO,EP.YEAR,PURPOSE_CD,PURPOSESEBU_CD, RP1.MOMEY \
	    ,QUANTITY,DEPTH_NUM,TAX_SET,RP1.SORT_NM,RP1.KIND_NM, RPCD.SEBU_NM,RC.NAME    \
	    )A LEFT JOIN EQUIP_CALCULATION2 ECI ON ECI.GU_CODE = A.GU_CODE AND ECI.CORP_CD = A.CORP_CD  AND ECI.ADMIN_NO = A.ADMIN_NO  \
	    AND ECI.OBJECT_NO = A.OBJECT_NO AND ECI.YEAR = A.YEAR AND ECI.USE_SECTION = 2 \
	)B JOIN REF_COMMONCODE RC2 ON RC2.CODE = B.CAL_STATUS AND RC2.TYPE = 'cal_status' \
	ORDER BY OBJECT_NO DESC	
	
Querys.facility.occupancy.productPlaceBoardListHan = \
SELECT  ROWNUM AS R_ID,OBJECT_NO,PURPOSE_CD,SORT_NM,KIND_NM,QUANTITY,DEPTH_NUM,TAX_SET,B.NAME,RATE ,SEBU_NM,SUM_ADJUST, CAL_STATUS, RC2.NAME AS CAL_STATUS_NAME, B.YEAR, \
  (SELECT DEPTH_RATE FROM EQUIP_CALCULATION2 WHERE GU_CODE = B.GU_CODE AND CORP_CD = B.CORP_CD AND OBJECT_NO = B.OBJECT_NO AND YEAR = B.YEAR) DEPTH_RATE  \
    FROM  \
  (  \
      SELECT  ROWNUM AS R_ID, A.GU_CODE, A.CORP_CD, A.OBJECT_NO,A.PURPOSE_CD,A.SORT_NM,A.KIND_NM,A.QUANTITY,A.DEPTH_NUM,A.TAX_SET,A.NAME,A.RATE ,SEBU_NM, \
       ECI.SUM_ADJUST, DECODE(ECI.SUM_ADJUST,NULL,1,2) AS CAL_STATUS, A.YEAR   \
        FROM \
         (   \
    SELECT EP.GU_CODE,EP.CORP_CD , EP.OBJECT_NO,EP.YEAR,PURPOSE_CD,PURPOSESEBU_CD \
    ,QUANTITY,DEPTH_NUM,TAX_SET,RP1.SORT_NM,RP1.KIND_NM  \
    ,(select SEBU_NM from REF_PURPOSESEBU where CODE=EP.PURPOSE_CD AND SEBU_CD = EP.PURPOSESEBU_CD) AS SEBU_NM  \
    ,RC.NAME  \
      ,MAX(DECODE(RD.RATE,NULL,0,RD.RATE)) AS RATE  \
          FROM EQUIP_PLACE2 EP  \
          JOIN REF_PURPOSECODE RP1 ON RP1.CODE = EP.PURPOSE_CD AND RP1.SECTION = 4  \
          LEFT JOIN REF_PURPOSESEBU RPCD ON RPCD.CODE = EP.PURPOSESEBU_CD \
          LEFT JOIN REF_DEPTH RD ON RD.DEPTH < EP.DEPTH_NUM  \
          JOIN REF_COMMONCODE RC ON RC.CODE = EP.TAX_SET AND RC.TYPE = 'taxation_section'  \
        WHERE EP.GU_CODE = ? AND EP.CORP_CD = ? AND EP.ADMIN_NO = ?  AND EP.TAX_SET = ?  \
        GROUP BY EP.GU_CODE,EP.CORP_CD,EP.ADMIN_NO,EP.OBJECT_NO,EP.YEAR,PURPOSE_CD,PURPOSESEBU_CD  \
    ,QUANTITY,DEPTH_NUM,TAX_SET,RP1.SORT_NM,RP1.KIND_NM, RPCD.SEBU_NM,RC.NAME  \
    )A LEFT JOIN EQUIP_CALCULATION2 ECI ON ECI.GU_CODE = A.GU_CODE AND ECI.CORP_CD = A.CORP_CD \
    AND ECI.OBJECT_NO = A.OBJECT_NO AND ECI.YEAR = A.YEAR AND ECI.USE_SECTION = 2  \
)B JOIN REF_COMMONCODE RC2 ON RC2.CODE = B.CAL_STATUS AND RC2.TYPE = 'cal_status' \
  WHERE R_ID between ? and ?  \
 ORDER BY OBJECT_NO DESC  \
 


Querys.facility.occupancy.productPlaceListCount = \
SELECT  COUNT(*)  \
  FROM \
  ( \
    SELECT  ROWNUM AS R_ID,A.OBJECT_NO,A.PURPOSE_CD,A.SORT_NM,A.KIND_NM,A.QUANTITY,A.DEPTH_NUM,A.TAX_SET,A.NAME,A.RATE ,SEBU_NM, \
       ECI.SUM_ADJUST, DECODE(ECI.SUM_ADJUST,NULL,1,2) AS CAL_STATUS, A.YEAR    \
      FROM  \
        (   \
    SELECT EP.GU_CODE,EP.CORP_CD,EP.OBJECT_NO,EP.YEAR,PURPOSE_CD,PURPOSESEBU_CD ,ADMIN_NO \
    ,QUANTITY,DEPTH_NUM,TAX_SET,RP1.SORT_NM,RP1.KIND_NM \
      ,(select SEBU_NM from REF_PURPOSESEBU where CODE=EP.PURPOSE_CD AND SEBU_CD = EP.PURPOSESEBU_CD) AS SEBU_NM \
        ,RC.NAME \
        ,MAX(DECODE(RD.RATE,NULL,0,RD.RATE)) AS RATE \
              FROM EQUIP_PLACE2 EP   \
          JOIN REF_PURPOSECODE RP1 ON RP1.CODE = EP.PURPOSE_CD AND RP1.SECTION = 4 \
            LEFT JOIN REF_PURPOSESEBU RPCD ON RPCD.CODE = EP.PURPOSESEBU_CD      \
                      LEFT JOIN REF_DEPTH RD ON RD.DEPTH < EP.DEPTH_NUM   \
          JOIN REF_COMMONCODE RC ON RC.CODE = EP.TAX_SET AND RC.TYPE = 'taxation_section' \
                  WHERE EP.GU_CODE=? AND EP.CORP_CD = ? and ep.admin_no = ?  \
        GROUP BY EP.GU_CODE,EP.CORP_CD,EP.ADMIN_NO,EP.OBJECT_NO,EP.YEAR,PURPOSE_CD,PURPOSESEBU_CD \
            ,QUANTITY,DEPTH_NUM,TAX_SET,RP1.SORT_NM,RP1.KIND_NM, RPCD.SEBU_NM,RC.NAME  \
    )A LEFT JOIN EQUIP_CALCULATION ECI ON ECI.GU_CODE = A.GU_CODE AND ECI.CORP_CD = A.CORP_CD \
        AND ECI.OBJECT_NO = A.OBJECT_NO AND ECI.YEAR = A.YEAR AND ECI.USE_SECTION = 2  \
)B JOIN REF_COMMONCODE RC2 ON RC2.CODE = B.CAL_STATUS AND RC2.TYPE = 'cal_status' \
    
    
     
  
    

Querys.facility.occupancy.productPlaceListTaxCount = \
SELECT  COUNT(*)  \
  FROM  \
  (  \
      SELECT  ROWNUM AS R_ID,A.OBJECT_NO,A.PURPOSE_CD,A.SORT_NM,A.KIND_NM,A.QUANTITY,A.DEPTH_NUM,A.TAX_SET,A.NAME,A.RATE ,SEBU_NM \
      ,ECI.SUM_ADJUST, DECODE(ECI.SUM_ADJUST,NULL,1,2) AS CAL_STATUS, A.YEAR \
      FROM  \
         (   \
    SELECT EP.GU_CODE,EP.CORP_CD, EP.OBJECT_NO,EP.YEAR,PURPOSE_CD,PURPOSESEBU_CD \
      ,QUANTITY,DEPTH_NUM,TAX_SET,RP1.SORT_NM,RP1.KIND_NM  \
    ,(select SEBU_NM from REF_PURPOSESEBU where CODE=EP.PURPOSE_CD AND SEBU_CD = EP.PURPOSESEBU_CD) AS SEBU_NM \
       ,RC.NAME  \
      ,MAX(DECODE(RD.RATE,NULL,0,RD.RATE)) AS RATE \
          FROM EQUIP_PLACE2 EP   \
          JOIN REF_PURPOSECODE RP1 ON RP1.CODE = EP.PURPOSE_CD AND RP1.SECTION = 4 \
          LEFT JOIN REF_PURPOSESEBU RPCD ON RPCD.CODE = EP.PURPOSESEBU_CD      \
          LEFT JOIN REF_DEPTH RD ON RD.DEPTH < EP.DEPTH_NUM   \
          JOIN REF_COMMONCODE RC ON RC.CODE = EP.TAX_SET AND RC.TYPE = 'taxation_section' \
            WHERE EP.GU_CODE = ? AND EP.CORP_CD = ? AND ADMIN_NO = ? AND EP.TAX_SET = ?  \
              GROUP BY EP.GU_CODE,EP.CORP_CD, EP.OBJECT_NO,EP.YEAR,PURPOSE_CD,PURPOSESEBU_CD  \
    ,QUANTITY,DEPTH_NUM,TAX_SET,RP1.SORT_NM,RP1.KIND_NM, RPCD.SEBU_NM,RC.NAME  \
    )A LEFT JOIN EQUIP_CALCULATION2 ECI ON ECI.GU_CODE = A.GU_CODE AND ECI.CORP_CD = A.CORP_CD \
    AND ECI.OBJECT_NO = A.OBJECT_NO AND ECI.YEAR = A.YEAR AND ECI.USE_SECTION = 2  \
	)B JOIN REF_COMMONCODE RC2 ON RC2.CODE = B.CAL_STATUS AND RC2.TYPE = 'cal_status'
       
      
   

//	\uc0b0\ucd9c - EQUIP_PLACE \uc815\ubcf4
Querys.facility.occupancy.productPlaceInfo = \
SELECT P.GU_CODE,P.CORP_CD,P.OBJECT_NO,P.QUANTITY,P.PURPOSE_CD,P.SECTION,P.DEPTH_RATE,DECODE(CHECK_YN,1,MOMEY,YOYUL) AS RATE,P.TAX_SET \
FROM  \
(  \
SELECT EP.GU_CODE, EP.CORP_CD, EP.OBJECT_NO, EP.QUANTITY, EP.PURPOSE_CD, EP.SECTION, EP.TAX_SET, \
       MAX(DECODE(RD.RATE,NULL,0,RD.RATE)) AS DEPTH_RATE  \
FROM EQUIP_PLACE2 EP  \
 LEFT JOIN REF_DEPTH RD ON RD.DEPTH < EP.DEPTH_NUM   \
 JOIN REF_PURPOSECODE RP ON RP.CODE = EP.PURPOSE_CD  AND RP.SECTION = 4 \
WHERE EP.GU_CODE=? AND EP.CORP_CD = ? AND EP.ADMIN_NO = ? AND EP.OBJECT_NO = ? \
GROUP BY EP.GU_CODE, EP.CORP_CD, EP.OBJECT_NO, EP.QUANTITY, EP.PURPOSE_CD, EP.SECTION, EP.TAX_SET \
)P  \
LEFT JOIN REF_PURPOSECODE RP ON RP.CODE = P.PURPOSE_CD  AND P.SECTION = RP.THEME

// \uc0b0\ucd9c  -EQUIP_CALCULATION \uc785\ub825
Querys.facility.occupancy.equip_calculationInsert = \
INSERT INTO EQUIP_CALCULATION2 ( GU_CODE,CORP_CD, OBJECT_NO,YEAR,SEQ,RATE,DEPTH_RATE,SUM_ADJUST,FROMDATE,TODATE ,FORM_ADJUST,FORM,UP_DATE \
,PERIOD,USE_SECTION,FIRST_SEQ,CAL_SUM_SEQ,QUANTITY,TAX_SET,SUM_YEAR, ADMIN_NO) \
  VALUES(?,?,?,?,EQUIP_CALCULATION_SEQ.NEXTVAL,?,?,?,?,?,?,?,?,?,?, EQUIP_CALCULATION_SEQ.CURRVAL ,?,?,?,?,?)  
  
// \uc0b0\ucd9c  -EQUIP_CAL_SUM_INFO \uc785\ub825
Querys.facility.occupancy.equip_cal_sumInsert = \
INSERT INTO EQUIP_CAL_SUM_INFO2 ( \
GU_CODE,CORP_CD,SEQ,YEAR,SUM_ADJUST,SUM,VAT,REDUCTION_RATE,REDUCTION_REASON,FORM_ADJUST\
,FROMDATE,TODATE,USE_SECTION,TAX_REG,TAX_SET,UP_DATE,TAX_YN,ADMIN_NO) \
VALUES (?,?,? ,?,?,?,?,?,?,?,?,?,?,?,?,?,'0',?)

//Equip_CAL_SUM_INFO \uc2dc\ud000\uc2a4 \uc99d\uac00\uac12
Querys.facility.occupancy.GetEquip_Cal_Sum_Seq = \
SELECT EQUIP_CAL_SUM_SEQ.NEXTVAL FROM DUAL  

//Equip_CALCULATIONINFO
Querys.facility.occupancy.GetEquip_CalculationInfo = \
SELECT YEAR,SEQ,RATE,DEPTH_RATE,SUM_ADJUST,FROMDATE,TODATE,FORM_ADJUST,UP_DATE,PERIOD,QUANTITY,CAL_SUM_SEQ ,TAX_SET FROM EQUIP_CALCULATION2  \
WHERE CORP_CD = ? AND GU_CODE = ? AND OBJECT_NO = ? AND YEAR = ?

//Equip_CAL_SUM_SEQ
Querys.facility.occupancy.GetCal_Sum_Seq = \
SELECT MAX(SEQ) FROM( \
SELECT SEQ FROM EQUIP_CAL_SUM_INFO2 WHERE GU_CODE = ? AND CORP_CD = ? AND TAX_SET = ? AND YEAR = ? AND ADMIN_NO = ? \
UNION ALL SELECT 0 AS SEQ FROM DUAL )

Querys.facility.occupancy.GetCal_Sum_Seq_Han = \
SELECT MAX(SEQ) FROM( \
SELECT SEQ FROM EQUIP_CAL_SUM_INFO2 WHERE GU_CODE = ? AND CORP_CD = ? AND TAX_SET = ? AND YEAR = ? \
UNION ALL SELECT 0 AS SEQ FROM DUAL )

//Equip_CAL_SUM_INFO \ucd94\uac00 \uc5c5\ub370\uc774\ud2b8
Querys.facility.occupancy.equip_cal_sum_addUpdate = \
UPDATE EQUIP_CAL_SUM_INFO2 SET \
SUM_ADJUST = ? \
, VAT = ? \
, SUM = ? *(100-REDUCTION_RATE)/100 \
, FORM_ADJUST = ? \
, UP_DATE = ? \
, FROMDATE = ? \
, TODATE = ? \
WHERE SEQ = ?

//Equip_CALCULATION SUM_ADJUST \ud569\uacc4
Querys.facility.occupancy.getEquip_Calculation_Sum_Adjust = \
SELECT SUM(SUM_ADJUST) AS SUM_ADJUST FROM EQUIP_CALCULATION2 WHERE GU_CODE=? AND CORP_CD = ? AND YEAR = ? AND TAX_SET = ? AND ADMIN_NO = ? 

Querys.facility.occupancy.getEquip_Calculation_Sum_AdjustHan = \
SELECT SUM(SUM_ADJUST) AS SUM_ADJUST FROM EQUIP_CALCULATION2 WHERE GU_CODE=? AND CORP_CD = ?  AND TAX_SET = ? \
AND YEAR = ? AND ADMIN_NO = ?


//Equip_CAL_SUM LIST
Querys.facility.occupancy.Equip_Cal_SumList = \
SELECT ECSI.YEAR, RC.NAME AS TAX_SET_NAME ,ECSI.SUM_ADJUST,ECSI.SUM ,ECSI.REDUCTION_RATE, ECSI.TAX_SET \
FROM EQUIP_CAL_SUM_INFO2 ECSI \
JOIN REF_COMMONCODE RC ON RC.CODE = ECSI.TAX_SET AND TYPE = 'taxation_section' \
WHERE GU_CODE = ? AND CORP_CD = ? AND YEAR = ? AND ADMIN_NO = ? AND USE_SECTION = 2



Querys.facility.occupancy.Equip_Cal_SumSeq = \
select cal_sum_seq from equip_calculation2 a, \
  (select max(object_no) as object_no From equip_place2 where gu_code = ? and corp_cd = ? and admin_no = ? ) b \
  where  a.gu_code= ?   \
  and a.corp_cd = ? \
  and a.year = ? \
  and a.object_no = b.object_no

//Equip_CAL_SUM LIST
Querys.facility.occupancy.GetCalculationSeq = \
SELECT MAX(SEQ) \
FROM \
( \
SELECT SEQ FROM EQUIP_CALCULATION \
WHERE GU_CODE=? AND CORP_CD = ? AND REQUEST_NO = ? AND OBJECT_NO = ? \
UNION ALL \
SELECT 0 AS SEQ FROM DUAL \
)

//EQUIP_CALCULATION \ucd94\uac00 \uc5c5\ub370\uc774\ud2b8
Querys.facility.occupancy.Equip_CalculationUpdate = \
UPDATE EQUIP_CALCULATION \
SET \
QUANTITY = ?, \
DEPTH_RATE = ?, \
RATE = ? , \
FROMDATE = ? , \
TODATE = ? , \
PERIOD = ? , \
FORM_ADJUST= ? , \
SUM_ADJUST = ? , \
SUM_YEAR = ? , \
UP_DATE = ? , \
FORM = ?, \
year = ? \
WHERE GU_CODE=? AND CORP_CD = ? AND REQUEST_NO = ? AND OBJECT_NO = ?

Querys.facility.occupancy.Equip_CalculationUpdateHan =\
UPDATE EQUIP_CALCULATION2 \
SET \
QUANTITY = ?, \
DEPTH_RATE = ?, \
RATE = ? , \
FROMDATE = ? , \
TODATE = ? , \
PERIOD = ? , \
FORM_ADJUST= ? , \
SUM_ADJUST = ? , \
SUM_YEAR = ? , \
UP_DATE = ? , \
FORM = ? \
WHERE YEAR = ?  AND GU_CODE=? AND CORP_CD = ? AND OBJECT_NO = ?



// Equip_PlaceUpdate
Querys.facility.occupancy.Equip_PlaceUpdate = \
UPDATE EQUIP_PLACE2 \
SET \
year = ? \
WHERE GU_CODE=? AND CORP_CD = ? AND ADMIN_NO = ? AND OBJECT_NO = ?


//\ubd80\uacfc \uc5ec\ubd80 \uc5f0\ub3c4\ubcc4
Querys.facility.occupancy.getProductTax_ynByYear = \
SELECT MAX(TAX_YN) FROM( \
SELECT EC.TAX_YN FROM EQUIP_PLACE2 EP \
JOIN EQUIP_CAL_SUM_INFO2 EC ON  EP.GU_CODE = EC.GU_CODE AND EP.CORP_CD = EC.CORP_CD AND EC.TAX_SET = EP.TAX_SET \
AND EP.GU_CODE = ? AND EP.CORP_CD = ? \
AND EP.ADMIN_NO= ? AND EP.OBJECT_NO = ? AND EC.YEAR = ? \
UNION ALL SELECT '-1' FROM DUAL) \

//\ubd80\uacfc \uc5ec\ubd80 \uc5f0\ub3c4\ubcc4
Querys.facility.occupancy.getSubtractedProduct = \
SELECT EC.SEQ AS SEQ,EC.PERIOD AS PERIOD,EC.SUM_ADJUST AS SUM_ADJUST,EP2.QUANTITY AS QUANTITY FROM EQUIP_PLACE EP1 \
JOIN EQUIP_PLACE EP2 ON EP1.ADMIN_NO = EP2.ADMIN_NO  AND EP1.REQUEST_NO != EP2.REQUEST_NO \
JOIN EQUIP_CALCULATION EC ON EP2.GU_CODE = EC.GU_CODE AND EP2.CORP_CD = EC.CORP_CD \
AND EP2.REQUEST_NO = EC.REQUEST_NO AND EP2.OBJECT_NO = EC.OBJECT_NO \
WHERE EP1.GU_CODE = ? AND EP1.CORP_CD = ? AND EP1.REQUEST_NO = ? AND EP1.OBJECT_NO = ? AND EC.YEAR = ?

//QUANTITY \uac1c\uc218
Querys.facility.occupancy.getQuantity = \
SELECT QUANTITY FROM EQUIP_PLACE2 WHERE  GU_CODE = ? AND CORP_CD = ? AND ADMIN_NO = ? AND OBJECT_NO = ?


Querys.facility.occupancy.getSanchulYn =\
	SELECT SUM(DECODE(SUM_ADJUST,NULL,1,0)) AS CAL_STATUS  FROM EQUIP_CALCULATION2 \
	WHERE GU_CODE = ? \
	  AND CORP_CD = ? \
	  AND YEAR = ? 	  
	  
	  
Querys.facility.occupancy.getCheckYn =\
	UPDATE EQUIP_ADMIN_BASE SET CHECK_YN = '1' , UP_DATE = to_char(SYSDATE,'YYYYMMDD') \
	 WHERE GU_CODE = ? \
	   AND CORP_CD = ? \
	   AND SUBSTR(REGDATE, 0,4) = ?	   
	   
	   
Querys.facility.occupancy.Euip_CalculationCount = \
SELECT COUNT(*) FROM EQUIP_CALCULATION2 \
WHERE GU_CODE= ? AND CORP_CD= ?   \
AND YEAR= ?   AND ADMIN_NO = ?

Querys.facility.occupancy.getCalMinMaxDateQuery = \
SELECT MIN(FROMDATE) AS FROMDATE, MAX(TODATE) AS TODATE from equip_calculation2 WHERE GU_CODE = ?  AND CORP_CD= ?  AND YEAR= ? AND ADMIN_NO = ?
